{"ast":null,"code":"var _jsxFileName = \"D:\\\\AI\\\\_Programs\\\\CBSE\\\\aqnamic\\\\frontend\\\\src\\\\components\\\\ChapterQuestions.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport './ChapterQuestions.css';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst ChapterQuestions = () => {\n  _s();\n  const [papers, setPapers] = useState([]);\n  const [textbooks, setTextbooks] = useState([]);\n  const [selectedPaper, setSelectedPaper] = useState(null);\n  const [selectedTextbook, setSelectedTextbook] = useState(null);\n  const [chapters, setChapters] = useState([]);\n  const [chapterStats, setChapterStats] = useState([]);\n  const [selectedChapter, setSelectedChapter] = useState(null);\n  const [questions, setQuestions] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [message, setMessage] = useState({\n    type: '',\n    text: ''\n  });\n  const [showTextbookModal, setShowTextbookModal] = useState(false);\n  const [textbookPageToShow, setTextbookPageToShow] = useState(null);\n  const [currentPage, setCurrentPage] = useState(1);\n  const [pdfLoading, setPdfLoading] = useState(false);\n  const [semanticSearchResults, setSemanticSearchResults] = useState(null);\n  const [isSearching, setIsSearching] = useState(false);\n  const [selectedReasoning, setSelectedReasoning] = useState(null);\n  const [selectedSolution, setSelectedSolution] = useState(null);\n  const [solvingQuestion, setSolvingQuestion] = useState(false);\n  const [selectedDiagram, setSelectedDiagram] = useState(null);\n\n  // Predefined textbooks with chapters and page numbers\n  const defaultTextbooks = {\n    'Physics': [{\n      name: 'NCERT Physics Class 10',\n      pdfUrl: 'https://ncert.nic.in/textbook/pdf/keph101.pdf',\n      externalUrl: 'https://ncert.nic.in/textbook.php?keph1=0-8',\n      imageBasePath: '/textbooks/physics-class10/pages/',\n      chapters: [{\n        name: 'Electricity',\n        pages: '1-20'\n      }, {\n        name: 'Magnetic Effects of Current',\n        pages: '21-40'\n      }, {\n        name: 'Light - Reflection and Refraction',\n        pages: '41-65'\n      }, {\n        name: 'Human Eye and Colourful World',\n        pages: '66-85'\n      }, {\n        name: 'Sources of Energy',\n        pages: '86-105'\n      }]\n    }],\n    'Chemistry': [{\n      name: 'NCERT Chemistry Class 10',\n      pdfUrl: 'https://ncert.nic.in/textbook/pdf/kesc101.pdf',\n      externalUrl: 'https://ncert.nic.in/textbook.php?kesc1=0-8',\n      imageBasePath: '/textbooks/chemistry-class10/pages/',\n      chapters: [{\n        name: 'Chemical Reactions and Equations',\n        pages: '1-18'\n      }, {\n        name: 'Acids, Bases and Salts',\n        pages: '19-35'\n      }, {\n        name: 'Metals and Non-metals',\n        pages: '36-55'\n      }, {\n        name: 'Carbon and its Compounds',\n        pages: '56-80'\n      }, {\n        name: 'Periodic Classification of Elements',\n        pages: '81-95'\n      }]\n    }],\n    'Biology': [{\n      name: 'NCERT Biology Class 10',\n      pdfUrl: 'https://ncert.nic.in/textbook/pdf/kebo101.pdf',\n      externalUrl: 'https://ncert.nic.in/textbook.php?kebo1=0-8',\n      imageBasePath: '/textbooks/biology-class10/pages/',\n      chapters: [{\n        name: 'Life Processes',\n        pages: '1-25'\n      }, {\n        name: 'Control and Coordination',\n        pages: '26-45'\n      }, {\n        name: 'How do Organisms Reproduce',\n        pages: '46-70'\n      }, {\n        name: 'Heredity and Evolution',\n        pages: '71-90'\n      }, {\n        name: 'Our Environment',\n        pages: '91-110'\n      }]\n    }],\n    'Mathematics': [{\n      name: 'NCERT Mathematics Class 10',\n      pdfUrl: 'https://ncert.nic.in/textbook/pdf/kemh101.pdf',\n      externalUrl: 'https://ncert.nic.in/textbook.php?kemh1=0-16',\n      imageBasePath: '/textbooks/mathematics-class10/pages/',\n      chapters: [{\n        name: 'Real Numbers',\n        pages: '1-15'\n      }, {\n        name: 'Polynomials',\n        pages: '16-30'\n      }, {\n        name: 'Pair of Linear Equations in Two Variables',\n        pages: '31-50'\n      }, {\n        name: 'Quadratic Equations',\n        pages: '51-70'\n      }, {\n        name: 'Arithmetic Progressions',\n        pages: '71-85'\n      }, {\n        name: 'Triangles',\n        pages: '86-110'\n      }, {\n        name: 'Coordinate Geometry',\n        pages: '111-130'\n      }, {\n        name: 'Introduction to Trigonometry',\n        pages: '131-150'\n      }, {\n        name: 'Some Applications of Trigonometry',\n        pages: '151-165'\n      }, {\n        name: 'Circles',\n        pages: '166-185'\n      }, {\n        name: 'Areas Related to Circles',\n        pages: '186-200'\n      }, {\n        name: 'Surface Areas and Volumes',\n        pages: '201-225'\n      }, {\n        name: 'Statistics',\n        pages: '226-245'\n      }, {\n        name: 'Probability',\n        pages: '246-260'\n      }]\n    }]\n  };\n  useEffect(() => {\n    fetchPapers();\n    fetchAllTextbooks();\n  }, []);\n  useEffect(() => {\n    if (selectedPaper && selectedTextbook) {\n      calculateChapterStats();\n    }\n  }, [selectedPaper, selectedTextbook]);\n  const fetchPapers = async () => {\n    try {\n      const response = await axios.get('http://localhost:5000/api/uploaded-papers');\n      setPapers(response.data);\n    } catch (err) {\n      console.error('Error fetching papers:', err);\n      setMessage({\n        type: 'error',\n        text: 'Failed to load papers'\n      });\n    }\n  };\n  const fetchAllTextbooks = async () => {\n    try {\n      // Fetch all uploaded textbooks\n      const response = await axios.get('http://localhost:5000/api/textbooks');\n      const uploadedTextbooks = response.data || [];\n\n      // Use uploaded textbooks directly, with default chapter structure as fallback\n      const textbooksToDisplay = uploadedTextbooks.map(uploaded => {\n        var _defaultTextbooks$upl;\n        // Get default chapters for this subject if available\n        const defaultForSubject = (_defaultTextbooks$upl = defaultTextbooks[uploaded.subject]) === null || _defaultTextbooks$upl === void 0 ? void 0 : _defaultTextbooks$upl[0];\n        return {\n          name: uploaded.title,\n          // Use actual uploaded title\n          subject: uploaded.subject,\n          uploadedFile: uploaded.file_path,\n          uploadedId: uploaded.id,\n          uploadedTitle: uploaded.title,\n          chapters: (defaultForSubject === null || defaultForSubject === void 0 ? void 0 : defaultForSubject.chapters) || [],\n          // Use default chapters as template\n          pdfUrl: '',\n          externalUrl: '',\n          imageBasePath: ''\n        };\n      });\n      setTextbooks(textbooksToDisplay);\n\n      // If no textbooks uploaded, show message\n      if (textbooksToDisplay.length === 0) {\n        setMessage({\n          type: 'info',\n          text: 'No textbooks uploaded yet. Please upload a textbook first.'\n        });\n      }\n    } catch (err) {\n      console.error('Error fetching textbooks:', err);\n      setMessage({\n        type: 'error',\n        text: 'Failed to load textbooks. Please try again.'\n      });\n      setTextbooks([]);\n    }\n  };\n  const handlePaperSelect = paper => {\n    setSelectedPaper(paper);\n    setSelectedTextbook(null);\n    setSelectedChapter(null);\n    setQuestions([]);\n    setChapters([]);\n    setChapterStats([]);\n    setSemanticSearchResults(null); // Clear previous search results\n\n    // Don't reload textbooks - they're already loaded with correct names\n    // Just clear the selection and let user select from existing list\n  };\n  const handleTextbookSelect = textbook => {\n    setSelectedTextbook(textbook);\n    setSelectedChapter(null);\n    setQuestions([]);\n    setChapters(textbook.chapters);\n    setSemanticSearchResults(null); // Clear previous search results when textbook changes\n\n    // Log textbook info for debugging\n    console.log('Selected textbook:', textbook.name);\n    console.log('Has uploaded file:', !!textbook.uploadedId);\n\n    // Don't show selection message - table selection is clear enough\n  };\n  const calculateChapterStats = async () => {\n    if (!selectedPaper || !selectedTextbook) return;\n    try {\n      // Fetch all questions from the selected paper\n      const response = await axios.get(`http://localhost:5000/api/parsed-questions?paper_id=${selectedPaper.id}`);\n      const allQuestions = response.data;\n\n      // Calculate question count for each chapter\n      const stats = selectedTextbook.chapters.map(chapter => {\n        const chapterQuestions = filterQuestionsByChapter(allQuestions, chapter.name);\n        return {\n          ...chapter,\n          questionCount: chapterQuestions.length\n        };\n      });\n      setChapterStats(stats);\n    } catch (err) {\n      console.error('Error calculating chapter stats:', err);\n    }\n  };\n  const handleClearResults = () => {\n    setSemanticSearchResults(null);\n    setQuestions([]);\n    setSelectedChapter(null);\n    setChapterStats([]); // Clear the chapter stats table\n    setMessage({\n      type: 'info',\n      text: 'Search results cleared. Ready for new search.'\n    });\n  };\n  const handleIndexAndMatch = async () => {\n    // Unified workflow: Index textbook (if needed) + Run AI Search\n    if (!selectedPaper || !selectedTextbook) {\n      setMessage({\n        type: 'warning',\n        text: 'Please select both a question paper and textbook first'\n      });\n      return;\n    }\n    if (!selectedTextbook.uploadedId) {\n      setMessage({\n        type: 'warning',\n        text: 'Please upload the textbook first'\n      });\n      return;\n    }\n    setIsSearching(true);\n    try {\n      // Step 1: Check if textbook is already indexed by trying to run search\n      console.log('ðŸš€ Starting Index & Match workflow...');\n      setMessage({\n        type: 'info',\n        text: 'ðŸ” Checking if textbook is indexed...'\n      });\n      let needsIndexing = false;\n\n      // Try to get chapters to see if indexed\n      try {\n        await axios.get(`http://localhost:5000/api/textbook-chapters/${selectedTextbook.uploadedId}`);\n        console.log('âœ“ Textbook already indexed');\n        setMessage({\n          type: 'info',\n          text: 'âœ“ Textbook already indexed. Running AI search...'\n        });\n      } catch (err) {\n        var _err$response, _err$response2, _err$response2$data, _err$response2$data$e;\n        if (((_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.status) === 404 || (_err$response2 = err.response) !== null && _err$response2 !== void 0 && (_err$response2$data = _err$response2.data) !== null && _err$response2$data !== void 0 && (_err$response2$data$e = _err$response2$data.error) !== null && _err$response2$data$e !== void 0 && _err$response2$data$e.includes('No vector index')) {\n          needsIndexing = true;\n          console.log('âš  Textbook not indexed, will index now');\n        } else {\n          throw err;\n        }\n      }\n\n      // Step 2: Index if needed\n      if (needsIndexing) {\n        setMessage({\n          type: 'info',\n          text: 'ðŸ“š Indexing textbook... This may take a few minutes.'\n        });\n        const indexResponse = await axios.post(`http://localhost:5000/api/index-textbook/${selectedTextbook.uploadedId}`);\n        if (!indexResponse.data.success) {\n          throw new Error(indexResponse.data.error || 'Indexing failed');\n        }\n        console.log(`âœ“ Indexed ${indexResponse.data.chapters_count} chapters`);\n        setMessage({\n          type: 'info',\n          text: `âœ… Indexed ${indexResponse.data.chapters_count} chapters. Now matching questions...`\n        });\n      }\n\n      // Step 3: Run AI Search\n      setMessage({\n        type: 'info',\n        text: 'ðŸ¤– Running AI Search with LLM analysis...'\n      });\n\n      // Fetch all questions from the selected paper\n      const questionsResponse = await axios.get(`http://localhost:5000/api/parsed-questions?paper_id=${selectedPaper.id}`);\n      const allQuestions = questionsResponse.data;\n\n      // Use semantic search to map questions to chapters\n      const mappingResponse = await axios.post('http://localhost:5000/api/map-questions-to-chapters', {\n        questions: allQuestions,\n        textbook_id: selectedTextbook.uploadedId\n      });\n      if (mappingResponse.data.success) {\n        const mappedQuestions = mappingResponse.data.mapped_questions;\n\n        // Group questions by chapter\n        const chapterGroups = {};\n        const unmatchedQuestions = [];\n        mappedQuestions.forEach(q => {\n          if (q.chapters && q.chapters.length > 0) {\n            const topChapter = q.chapters[0];\n            const chapterKey = topChapter.chapter_title;\n            if (!chapterGroups[chapterKey]) {\n              chapterGroups[chapterKey] = {\n                chapter: topChapter,\n                questions: []\n              };\n            }\n            chapterGroups[chapterKey].questions.push(q);\n          } else {\n            unmatchedQuestions.push(q);\n          }\n        });\n\n        // Add unmatched questions if any\n        if (unmatchedQuestions.length > 0) {\n          chapterGroups['Unmatched Questions'] = {\n            chapter: {\n              chapter_number: 0,\n              chapter_title: 'Unmatched Questions',\n              page_start: 'N/A',\n              page_end: 'N/A',\n              similarity_score: 0\n            },\n            questions: unmatchedQuestions\n          };\n        }\n        const totalQuestions = Object.values(chapterGroups).reduce((sum, data) => sum + data.questions.length, 0);\n\n        // Clear old chapter stats\n        setChapterStats([]);\n        setSemanticSearchResults(chapterGroups);\n        setMessage({\n          type: 'success',\n          text: `ðŸŽ‰ Complete! Found ${Object.keys(chapterGroups).length} chapters with ${totalQuestions} questions (${unmatchedQuestions.length} unmatched). Click a chapter below.`\n        });\n\n        // Save results to database\n        await saveSearchResults(chapterGroups);\n      } else {\n        throw new Error('AI search failed');\n      }\n    } catch (err) {\n      var _err$response3, _err$response3$data;\n      console.error('Error in Index & Match workflow:', err);\n      const errorMsg = ((_err$response3 = err.response) === null || _err$response3 === void 0 ? void 0 : (_err$response3$data = _err$response3.data) === null || _err$response3$data === void 0 ? void 0 : _err$response3$data.error) || err.message;\n      setMessage({\n        type: 'error',\n        text: `Failed: ${errorMsg}`\n      });\n    } finally {\n      setIsSearching(false);\n    }\n  };\n  const handleIndexTextbook = async () => {\n    // Legacy function - kept for backward compatibility\n    if (!selectedTextbook || !selectedTextbook.uploadedId) {\n      setMessage({\n        type: 'warning',\n        text: 'Please select a textbook first'\n      });\n      return;\n    }\n    setIsSearching(true);\n    setMessage({\n      type: 'info',\n      text: 'ðŸ“š Indexing textbook... This may take a few minutes.'\n    });\n    try {\n      const response = await axios.post(`http://localhost:5000/api/index-textbook/${selectedTextbook.uploadedId}`);\n      if (response.data.success) {\n        setMessage({\n          type: 'success',\n          text: `âœ… Textbook indexed successfully! ${response.data.chapters_count} chapters indexed. You can now run AI semantic search.`\n        });\n      } else {\n        throw new Error(response.data.error || 'Indexing failed');\n      }\n    } catch (err) {\n      var _err$response4, _err$response4$data;\n      console.error('Error indexing textbook:', err);\n      setMessage({\n        type: 'error',\n        text: `Failed to index textbook: ${((_err$response4 = err.response) === null || _err$response4 === void 0 ? void 0 : (_err$response4$data = _err$response4.data) === null || _err$response4$data === void 0 ? void 0 : _err$response4$data.error) || err.message}`\n      });\n    } finally {\n      setIsSearching(false);\n    }\n  };\n  const handleRunSemanticSearch = async () => {\n    if (!selectedPaper || !selectedTextbook) {\n      setMessage({\n        type: 'warning',\n        text: 'Please select both a question paper and textbook first'\n      });\n      return;\n    }\n    if (!selectedTextbook.uploadedId) {\n      setMessage({\n        type: 'warning',\n        text: 'Please upload the textbook to use AI semantic search'\n      });\n      return;\n    }\n    setIsSearching(true);\n    setMessage({\n      type: 'info',\n      text: 'ðŸ¤– Running AI Search with LLM analysis...'\n    });\n    try {\n      // Fetch all questions from the selected paper\n      const response = await axios.get(`http://localhost:5000/api/parsed-questions?paper_id=${selectedPaper.id}`);\n      const allQuestions = response.data;\n\n      // Use semantic search to map questions to chapters\n      const mappingResponse = await axios.post('http://localhost:5000/api/map-questions-to-chapters', {\n        questions: allQuestions,\n        textbook_id: selectedTextbook.uploadedId\n      });\n      if (mappingResponse.data.success) {\n        const mappedQuestions = mappingResponse.data.mapped_questions;\n\n        // Group questions by chapter\n        const chapterGroups = {};\n        const unmatchedQuestions = [];\n        mappedQuestions.forEach(q => {\n          if (q.chapters && q.chapters.length > 0) {\n            const topChapter = q.chapters[0]; // Use best match\n            const chapterKey = topChapter.chapter_title;\n            if (!chapterGroups[chapterKey]) {\n              chapterGroups[chapterKey] = {\n                chapter: topChapter,\n                questions: []\n              };\n            }\n            chapterGroups[chapterKey].questions.push(q);\n          } else {\n            // No chapter match found\n            unmatchedQuestions.push(q);\n          }\n        });\n\n        // Add unmatched questions as a separate group if any exist\n        if (unmatchedQuestions.length > 0) {\n          chapterGroups['Unmatched Questions'] = {\n            chapter: {\n              chapter_number: 0,\n              chapter_title: 'Unmatched Questions',\n              page_start: 'N/A',\n              page_end: 'N/A',\n              similarity_score: 0\n            },\n            questions: unmatchedQuestions\n          };\n        }\n        const totalQuestions = Object.values(chapterGroups).reduce((sum, data) => sum + data.questions.length, 0);\n        console.log('Chapter groups created:', Object.keys(chapterGroups));\n        console.log('Full chapter groups:', chapterGroups);\n\n        // Clear old chapter stats to show only AI results\n        setChapterStats([]);\n        setSemanticSearchResults(chapterGroups);\n        setMessage({\n          type: 'success',\n          text: `ðŸ¤– AI Search Complete! Found ${Object.keys(chapterGroups).length} chapters with ${totalQuestions} questions (${unmatchedQuestions.length} unmatched). Click on a chapter below to view questions.`\n        });\n\n        // Save results to database\n        await saveSearchResults(chapterGroups);\n      } else {\n        throw new Error('Semantic search failed');\n      }\n    } catch (err) {\n      var _err$response5, _err$response5$data;\n      console.error('Error in semantic search:', err);\n      const errorMsg = ((_err$response5 = err.response) === null || _err$response5 === void 0 ? void 0 : (_err$response5$data = _err$response5.data) === null || _err$response5$data === void 0 ? void 0 : _err$response5$data.error) || err.message;\n\n      // Check if it's an indexing issue\n      if (errorMsg.includes('No vector index found') || errorMsg.includes('index')) {\n        setMessage({\n          type: 'error',\n          text: 'âš ï¸ Textbook not indexed. Please click \"Index Textbook\" button first.'\n        });\n      } else {\n        setMessage({\n          type: 'error',\n          text: `AI semantic search failed: ${errorMsg}`\n        });\n      }\n    } finally {\n      setIsSearching(false);\n    }\n  };\n  const saveSearchResults = async chapterGroups => {\n    try {\n      console.log('ðŸ’¾ Saving search results to database...');\n      console.log('  Paper ID:', selectedPaper.id);\n      console.log('  Textbook ID:', selectedTextbook.uploadedId);\n      console.log('  Chapters:', Object.keys(chapterGroups).length);\n      const response = await axios.post('http://localhost:5000/api/save-ai-search-results', {\n        paper_id: selectedPaper.id,\n        textbook_id: selectedTextbook.uploadedId,\n        search_results: chapterGroups\n      });\n      console.log('âœ“ Search results saved to database:', response.data);\n    } catch (error) {\n      var _error$response;\n      console.error('âŒ Failed to save search results:', error);\n      console.error('  Error details:', (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.data);\n      // Don't show error to user - this is a background operation\n    }\n  };\n  const handleLoadLastMatch = async () => {\n    if (!selectedPaper || !selectedTextbook || !selectedTextbook.uploadedId) {\n      setMessage({\n        type: 'warning',\n        text: 'Please select both a question paper and textbook first'\n      });\n      return;\n    }\n    setIsSearching(true);\n    setMessage({\n      type: 'info',\n      text: 'ðŸ“‹ Loading last AI search results...'\n    });\n    console.log('ðŸ“‹ Loading last match...');\n    console.log('  Paper ID:', selectedPaper.id);\n    console.log('  Textbook ID:', selectedTextbook.uploadedId);\n    try {\n      const response = await axios.get(`http://localhost:5000/api/get-last-ai-search?paper_id=${selectedPaper.id}&textbook_id=${selectedTextbook.uploadedId}`);\n      console.log('  Response:', response.data);\n      if (response.data.success) {\n        const {\n          search_results,\n          total_chapters,\n          total_questions,\n          unmatched_count,\n          created_at\n        } = response.data;\n\n        // Clear old chapter stats\n        setChapterStats([]);\n        setSemanticSearchResults(search_results);\n\n        // Format the date\n        const date = new Date(created_at);\n        const timeAgo = getTimeAgo(date);\n        setMessage({\n          type: 'success',\n          text: `ðŸ“‹ Loaded previous results (${timeAgo}): ${total_chapters} chapters with ${total_questions} questions (${unmatched_count} unmatched)`\n        });\n      }\n    } catch (err) {\n      var _err$response6;\n      console.error('Error loading last match:', err);\n      if (((_err$response6 = err.response) === null || _err$response6 === void 0 ? void 0 : _err$response6.status) === 404) {\n        // Clear any existing results since no match found for this combination\n        setSemanticSearchResults(null);\n        setChapterStats([]);\n        setMessage({\n          type: 'info',\n          text: `No previous results found for \"${selectedPaper.title}\" with \"${selectedTextbook.name}\". Please run \"Index & Match Questions\" first.`\n        });\n      } else {\n        var _err$response7, _err$response7$data;\n        setMessage({\n          type: 'error',\n          text: `Failed to load previous results: ${((_err$response7 = err.response) === null || _err$response7 === void 0 ? void 0 : (_err$response7$data = _err$response7.data) === null || _err$response7$data === void 0 ? void 0 : _err$response7$data.error) || err.message}`\n        });\n      }\n    } finally {\n      setIsSearching(false);\n    }\n  };\n  const getTimeAgo = date => {\n    const seconds = Math.floor((new Date() - date) / 1000);\n    if (seconds < 60) return 'just now';\n    if (seconds < 3600) return `${Math.floor(seconds / 60)} minutes ago`;\n    if (seconds < 86400) return `${Math.floor(seconds / 3600)} hours ago`;\n    if (seconds < 604800) return `${Math.floor(seconds / 86400)} days ago`;\n    return date.toLocaleDateString();\n  };\n  const handleChapterSelect = chapterData => {\n    console.log('Selected chapter:', chapterData);\n    console.log('Available chapters in semanticSearchResults:', semanticSearchResults ? Object.keys(semanticSearchResults) : 'None');\n    setSelectedChapter(chapterData);\n    if (semanticSearchResults && semanticSearchResults[chapterData.name]) {\n      // Use semantic search results\n      const chapterQuestions = semanticSearchResults[chapterData.name].questions;\n      const chapterInfo = semanticSearchResults[chapterData.name].chapter;\n      console.log('Found chapter questions:', chapterQuestions.length);\n      console.log('Chapter info:', chapterInfo);\n      setQuestions(chapterQuestions);\n      setMessage({\n        type: 'success',\n        text: `Showing ${chapterQuestions.length} questions for: ${chapterData.name} (AI matched)`\n      });\n    } else {\n      console.warn('Chapter not found in semantic search results:', chapterData.name);\n      setMessage({\n        type: 'info',\n        text: 'Run AI Search to find questions for this chapter'\n      });\n      setQuestions([]);\n    }\n  };\n  const handleSolveQuestion = async question => {\n    setSolvingQuestion(true);\n    try {\n      const chapterContext = question.chapters && question.chapters.length > 0 ? question.chapters[0].chapter_title : selectedChapter === null || selectedChapter === void 0 ? void 0 : selectedChapter.name;\n      const response = await axios.post('http://localhost:5000/api/solve-question', {\n        question_text: question.question_text,\n        question_type: question.question_type,\n        subject: selectedPaper === null || selectedPaper === void 0 ? void 0 : selectedPaper.subject,\n        chapter_context: chapterContext\n      });\n      if (response.data.success) {\n        setSelectedSolution({\n          questionNumber: question.question_number,\n          questionText: question.question_text,\n          questionType: question.question_type,\n          solution: response.data.solution,\n          parsedSolution: response.data.parsed_solution\n        });\n\n        // Save to Question Bank\n        try {\n          await axios.post('http://localhost:5000/api/save-solved-question', {\n            question_text: question.question_text,\n            solution: response.data.solution,\n            source: 'answer_chapterwise',\n            paper_id: selectedPaper === null || selectedPaper === void 0 ? void 0 : selectedPaper.id,\n            textbook_id: (selectedTextbook === null || selectedTextbook === void 0 ? void 0 : selectedTextbook.uploadedId) || (selectedTextbook === null || selectedTextbook === void 0 ? void 0 : selectedTextbook.id),\n            chapter_name: chapterContext,\n            timestamp: new Date().toISOString()\n          });\n          console.log('âœ… Question saved to Question Bank');\n        } catch (saveErr) {\n          console.error('Failed to save to Question Bank:', saveErr);\n          // Don't show error to user, just log it\n        }\n      } else {\n        alert('Failed to solve question: ' + (response.data.error || 'Unknown error'));\n      }\n    } catch (error) {\n      var _error$response2, _error$response2$data;\n      console.error('Error solving question:', error);\n      alert('Error solving question: ' + (((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.error) || error.message));\n    } finally {\n      setSolvingQuestion(false);\n    }\n  };\n  const estimateQuestionPageNumber = (questionText, chapterData) => {\n    // Estimate specific page range within chapter based on question content\n    if (!chapterData || !chapterData.pages) {\n      return 'N/A'; // Return default if no page data\n    }\n    const {\n      pages\n    } = chapterData;\n    const [startPage, endPage] = pages.split('-').map(p => parseInt(p.trim()));\n    const totalPages = endPage - startPage + 1;\n\n    // Define sub-topics with their relative position in chapter (0-1)\n    const subTopicPositions = {\n      // Electricity sub-topics\n      'electric current': 0.1,\n      'potential difference': 0.2,\n      'ohm law': 0.3,\n      'resistance': 0.3,\n      'series circuit': 0.5,\n      'parallel circuit': 0.6,\n      'heating effect': 0.7,\n      'electric power': 0.8,\n      'joule law': 0.9,\n      // Magnetic Effects\n      'magnetic field': 0.1,\n      'right hand rule': 0.2,\n      'electromagnet': 0.3,\n      'solenoid': 0.4,\n      'force on conductor': 0.5,\n      'electric motor': 0.6,\n      'electromagnetic induction': 0.7,\n      'generator': 0.8,\n      'fleming': 0.8,\n      // Light - Reflection and Refraction\n      'law of reflection': 0.1,\n      'plane mirror': 0.15,\n      'spherical mirror': 0.2,\n      'concave mirror': 0.3,\n      'convex mirror': 0.4,\n      'mirror formula': 0.45,\n      'refraction': 0.5,\n      'refractive index': 0.55,\n      'snell law': 0.6,\n      'lens': 0.65,\n      'concave lens': 0.7,\n      'convex lens': 0.75,\n      'lens formula': 0.8,\n      'power of lens': 0.9,\n      // Quadratic Equations\n      'standard form': 0.1,\n      'factorization': 0.2,\n      'completing square': 0.4,\n      'quadratic formula': 0.6,\n      'discriminant': 0.7,\n      'nature of roots': 0.8,\n      'word problem': 0.9,\n      // Triangles\n      'similar triangle': 0.2,\n      'basic proportionality': 0.3,\n      'criteria for similarity': 0.4,\n      'area of similar': 0.5,\n      'pythagoras theorem': 0.6,\n      'converse of pythagoras': 0.7,\n      'triangle inequality': 0.8,\n      // Coordinate Geometry\n      'distance formula': 0.2,\n      'section formula': 0.4,\n      'midpoint': 0.5,\n      'area of triangle': 0.6,\n      'collinear': 0.7,\n      'slope': 0.8,\n      // Trigonometry\n      'trigonometric ratio': 0.1,\n      'sine': 0.2,\n      'cosine': 0.3,\n      'tangent': 0.4,\n      'complementary angle': 0.5,\n      'trigonometric identity': 0.6,\n      'angle of elevation': 0.7,\n      'angle of depression': 0.8,\n      'height and distance': 0.9,\n      // Statistics\n      'mean': 0.2,\n      'median': 0.4,\n      'mode': 0.6,\n      'cumulative frequency': 0.7,\n      'ogive': 0.8,\n      // Probability\n      'theoretical probability': 0.3,\n      'experimental probability': 0.5,\n      'sample space': 0.6,\n      'mutually exclusive': 0.8,\n      // Chemistry - Acids, Bases and Salts\n      'acid': 0.1,\n      'base': 0.2,\n      'indicator': 0.3,\n      'ph scale': 0.4,\n      'neutralization': 0.5,\n      'salt': 0.6,\n      'water of crystallization': 0.8,\n      // Biology - Life Processes\n      'nutrition': 0.1,\n      'autotrophic': 0.15,\n      'heterotrophic': 0.2,\n      'photosynthesis': 0.25,\n      'digestion': 0.3,\n      'respiration': 0.5,\n      'aerobic': 0.55,\n      'anaerobic': 0.6,\n      'transportation': 0.7,\n      'excretion': 0.85\n    };\n    const lowerText = questionText.toLowerCase();\n    let estimatedPosition = 0.5; // Default to middle\n    let matchFound = false;\n\n    // Find the most specific sub-topic match\n    for (const [subTopic, position] of Object.entries(subTopicPositions)) {\n      if (lowerText.includes(subTopic)) {\n        estimatedPosition = position;\n        matchFound = true;\n        break; // Use first match (most specific)\n      }\n    }\n\n    // Calculate estimated page range (Â±2 pages from estimated position)\n    const estimatedPage = Math.round(startPage + totalPages * estimatedPosition);\n    const rangeStart = Math.max(startPage, estimatedPage - 2);\n    const rangeEnd = Math.min(endPage, estimatedPage + 2);\n    return matchFound ? `${rangeStart}-${rangeEnd}` : pages;\n  };\n  const handlePageClick = pageRange => {\n    const [startPage, endPage] = pageRange.split('-').map(p => parseInt(p.trim()));\n    setCurrentPage(startPage);\n    setTextbookPageToShow({\n      textbook: selectedTextbook,\n      chapter: selectedChapter.name,\n      pageRange: pageRange,\n      startPage: startPage,\n      endPage: endPage || startPage\n    });\n    setShowTextbookModal(true);\n  };\n  const handleNextPage = () => {\n    if (currentPage < textbookPageToShow.endPage) {\n      const nextPage = currentPage + 1;\n      console.log('Next page:', nextPage);\n      setPdfLoading(true);\n      setCurrentPage(nextPage);\n      setTimeout(() => setPdfLoading(false), 1000);\n    }\n  };\n  const handlePrevPage = () => {\n    if (currentPage > textbookPageToShow.startPage) {\n      const prevPage = currentPage - 1;\n      console.log('Previous page:', prevPage);\n      setPdfLoading(true);\n      setCurrentPage(prevPage);\n      setTimeout(() => setPdfLoading(false), 1000);\n    }\n  };\n  const handleCloseModal = () => {\n    setShowTextbookModal(false);\n    setTextbookPageToShow(null);\n    setCurrentPage(1);\n  };\n  const filterQuestionsByChapter = (questions, chapter) => {\n    // Enhanced keyword matching with scoring system for more focused results\n    const chapterKeywords = {\n      'Electricity': {\n        primary: ['current', 'voltage', 'resistance', 'ohm', 'circuit', 'electric power', 'electrical energy'],\n        secondary: ['joule', 'watt', 'ampere', 'volt', 'resistor', 'conductor', 'insulator']\n      },\n      'Magnetic Effects of Current': {\n        primary: ['magnetic field', 'electromagnet', 'solenoid', 'motor', 'generator', 'fleming'],\n        secondary: ['magnet', 'electromagnetic induction', 'armature', 'commutator']\n      },\n      'Light - Reflection and Refraction': {\n        primary: ['reflection', 'refraction', 'mirror', 'lens', 'focal length', 'image formation'],\n        secondary: ['concave', 'convex', 'ray diagram', 'optical', 'refractive index']\n      },\n      'Human Eye and Colourful World': {\n        primary: ['eye', 'retina', 'cornea', 'spectrum', 'dispersion', 'rainbow', 'prism'],\n        secondary: ['vision', 'myopia', 'hypermetropia', 'presbyopia', 'cataract']\n      },\n      'Sources of Energy': {\n        primary: ['renewable energy', 'solar energy', 'wind energy', 'fossil fuel', 'nuclear energy'],\n        secondary: ['biogas', 'hydroelectric', 'geothermal', 'tidal energy']\n      },\n      'Chemical Reactions and Equations': {\n        primary: ['chemical reaction', 'chemical equation', 'reactant', 'product', 'balanced equation'],\n        secondary: ['oxidation', 'reduction', 'decomposition', 'combination', 'displacement']\n      },\n      'Acids, Bases and Salts': {\n        primary: ['acid', 'base', 'salt', 'ph scale', 'neutralization'],\n        secondary: ['alkali', 'indicator', 'litmus', 'acidic', 'basic']\n      },\n      'Metals and Non-metals': {\n        primary: ['metal', 'non-metal', 'metalloid', 'reactivity series', 'corrosion'],\n        secondary: ['alloy', 'ore', 'extraction', 'metallic', 'ionic bond']\n      },\n      'Carbon and its Compounds': {\n        primary: ['carbon compound', 'organic compound', 'hydrocarbon', 'functional group'],\n        secondary: ['alkane', 'alkene', 'alkyne', 'alcohol', 'carboxylic acid', 'ester']\n      },\n      'Life Processes': {\n        primary: ['nutrition', 'respiration', 'transportation', 'excretion', 'photosynthesis'],\n        secondary: ['digestion', 'cellular respiration', 'transpiration', 'kidney']\n      },\n      'Control and Coordination': {\n        primary: ['nervous system', 'hormone', 'endocrine', 'reflex action', 'neuron'],\n        secondary: ['brain', 'spinal cord', 'synapse', 'receptor', 'effector']\n      },\n      'How do Organisms Reproduce': {\n        primary: ['reproduction', 'sexual reproduction', 'asexual reproduction', 'fertilization'],\n        secondary: ['gamete', 'zygote', 'fission', 'budding', 'vegetative propagation']\n      },\n      'Heredity and Evolution': {\n        primary: ['heredity', 'inheritance', 'gene', 'chromosome', 'evolution', 'natural selection'],\n        secondary: ['dna', 'darwin', 'variation', 'speciation', 'fossil']\n      },\n      'Our Environment': {\n        primary: ['ecosystem', 'food chain', 'food web', 'biodegradable', 'ozone layer'],\n        secondary: ['environment', 'pollution', 'greenhouse effect', 'decomposer']\n      },\n      'Real Numbers': {\n        primary: ['real number', 'rational number', 'irrational number', 'euclid', 'hcf', 'lcm'],\n        secondary: ['prime', 'composite', 'fundamental theorem']\n      },\n      'Polynomials': {\n        primary: ['polynomial', 'degree of polynomial', 'zero of polynomial', 'coefficient'],\n        secondary: ['quadratic polynomial', 'cubic polynomial', 'factorization']\n      },\n      'Pair of Linear Equations in Two Variables': {\n        primary: ['linear equation', 'simultaneous equation', 'substitution method', 'elimination method'],\n        secondary: ['cross multiplication', 'graphical method', 'consistent', 'inconsistent']\n      },\n      'Quadratic Equations': {\n        primary: ['quadratic equation', 'discriminant', 'roots of equation', 'quadratic formula'],\n        secondary: ['xÂ²', 'x^2', 'factorization', 'completing square']\n      },\n      'Arithmetic Progressions': {\n        primary: ['arithmetic progression', 'common difference', 'nth term', 'sum of ap'],\n        secondary: ['ap', 'arithmetic sequence', 'series']\n      },\n      'Triangles': {\n        primary: ['similar triangle', 'congruent triangle', 'pythagoras theorem', 'triangle theorem'],\n        secondary: ['area of triangle', 'perimeter', 'altitude', 'median']\n      },\n      'Coordinate Geometry': {\n        primary: ['coordinate', 'distance formula', 'section formula', 'midpoint formula'],\n        secondary: ['slope', 'x-axis', 'y-axis', 'cartesian plane']\n      },\n      'Introduction to Trigonometry': {\n        primary: ['trigonometry', 'trigonometric ratio', 'sine', 'cosine', 'tangent'],\n        secondary: ['sin', 'cos', 'tan', 'angle', 'Î¸', 'theta']\n      },\n      'Some Applications of Trigonometry': {\n        primary: ['height and distance', 'angle of elevation', 'angle of depression', 'line of sight'],\n        secondary: ['trigonometric application', 'tower', 'building height']\n      },\n      'Circles': {\n        primary: ['circle', 'tangent to circle', 'chord', 'secant', 'circle theorem'],\n        secondary: ['radius', 'diameter', 'arc', 'segment']\n      },\n      'Areas Related to Circles': {\n        primary: ['area of circle', 'sector', 'segment of circle', 'circumference'],\n        secondary: ['Ï€', 'pi', 'circular region', 'annulus']\n      },\n      'Surface Areas and Volumes': {\n        primary: ['surface area', 'volume', 'total surface area', 'curved surface area'],\n        secondary: ['cube', 'cuboid', 'cylinder', 'cone', 'sphere', 'hemisphere']\n      },\n      'Statistics': {\n        primary: ['mean', 'median', 'mode', 'frequency distribution', 'cumulative frequency'],\n        secondary: ['data', 'class interval', 'grouped data', 'ogive']\n      },\n      'Probability': {\n        primary: ['probability', 'theoretical probability', 'experimental probability', 'random experiment'],\n        secondary: ['event', 'outcome', 'sample space', 'certain', 'impossible']\n      }\n    };\n    const chapterData = chapterKeywords[chapter];\n    if (!chapterData) {\n      // Fallback to simple keyword matching\n      const keywords = chapter.toLowerCase().split(' ');\n      return questions.filter(q => {\n        const questionText = q.question_text.toLowerCase();\n        return keywords.some(keyword => questionText.includes(keyword));\n      });\n    }\n\n    // Score-based filtering for more focused results\n    return questions.filter(q => {\n      const questionText = q.question_text.toLowerCase();\n      let score = 0;\n\n      // Primary keywords are worth 3 points\n      chapterData.primary.forEach(keyword => {\n        if (questionText.includes(keyword.toLowerCase())) {\n          score += 3;\n        }\n      });\n\n      // Secondary keywords are worth 1 point\n      chapterData.secondary.forEach(keyword => {\n        if (questionText.includes(keyword.toLowerCase())) {\n          score += 1;\n        }\n      });\n\n      // Require minimum score of 2 for more focused results\n      return score >= 2;\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chapter-questions\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chapter-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"\\uD83D\\uDCD6 Answer Chapterwise\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1014,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Select a question paper, textbook, and chapter to view related questions\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1015,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1013,\n      columnNumber: 7\n    }, this), message.text && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `message ${message.type}`,\n      children: message.text\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1019,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chapter-content\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"selection-grid\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"selection-section textbook-selection-table\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"\\uD83D\\uDCDA Step 1: Select Textbook\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1029,\n            columnNumber: 13\n          }, this), textbooks.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"no-data\",\n            children: \"No textbooks available. Please upload a textbook first.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1031,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"selection-table-container\",\n            children: /*#__PURE__*/_jsxDEV(\"table\", {\n              className: \"selection-table\",\n              children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n                children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                    style: {\n                      width: '50px'\n                    },\n                    children: \"Select\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1037,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    children: \"Textbook Name\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1038,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    children: \"Subject\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1039,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1036,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1035,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n                children: textbooks.map((textbook, index) => /*#__PURE__*/_jsxDEV(\"tr\", {\n                  className: `selection-row ${(selectedTextbook === null || selectedTextbook === void 0 ? void 0 : selectedTextbook.name) === textbook.name ? 'selected' : ''} ${!textbook.uploadedId ? 'disabled' : ''}`,\n                  onClick: () => textbook.uploadedId && handleTextbookSelect(textbook),\n                  children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"checkbox-cell\",\n                    children: /*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"checkbox\",\n                      checked: (selectedTextbook === null || selectedTextbook === void 0 ? void 0 : selectedTextbook.name) === textbook.name,\n                      onChange: () => textbook.uploadedId && handleTextbookSelect(textbook),\n                      disabled: !textbook.uploadedId,\n                      onClick: e => e.stopPropagation()\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1050,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1049,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"name-cell\",\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"cell-content\",\n                      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"icon\",\n                        children: textbook.uploadedId ? 'ðŸ“•' : 'ðŸ“˜'\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1060,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"text\",\n                        children: textbook.name\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1061,\n                        columnNumber: 29\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1059,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1058,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"subject-cell\",\n                    children: /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"subject-badge\",\n                      children: textbook.subject\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1065,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1064,\n                    columnNumber: 25\n                  }, this)]\n                }, index, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1044,\n                  columnNumber: 23\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1042,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1034,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1033,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1028,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"selection-section paper-selection-table\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"\\uD83D\\uDCC4 Step 2: Select Question Paper\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1077,\n            columnNumber: 13\n          }, this), papers.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"no-data\",\n            children: \"No question papers uploaded yet\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1079,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"selection-table-container\",\n            children: /*#__PURE__*/_jsxDEV(\"table\", {\n              className: \"selection-table\",\n              children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n                children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                    style: {\n                      width: '50px'\n                    },\n                    children: \"Select\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1085,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    children: \"Paper Title\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1086,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    children: \"Subject\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1087,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1084,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1083,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n                children: papers.map(paper => /*#__PURE__*/_jsxDEV(\"tr\", {\n                  className: `selection-row ${(selectedPaper === null || selectedPaper === void 0 ? void 0 : selectedPaper.id) === paper.id ? 'selected' : ''}`,\n                  onClick: () => handlePaperSelect(paper),\n                  children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"checkbox-cell\",\n                    children: /*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"checkbox\",\n                      checked: (selectedPaper === null || selectedPaper === void 0 ? void 0 : selectedPaper.id) === paper.id,\n                      onChange: () => handlePaperSelect(paper),\n                      onClick: e => e.stopPropagation()\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1098,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1097,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"name-cell\",\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"cell-content\",\n                      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"icon\",\n                        children: \"\\uD83D\\uDCDD\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1107,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"text\",\n                        children: paper.title\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1108,\n                        columnNumber: 29\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1106,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1105,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"subject-cell\",\n                    children: /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"subject-badge\",\n                      children: paper.subject\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1112,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1111,\n                    columnNumber: 25\n                  }, this)]\n                }, paper.id, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1092,\n                  columnNumber: 23\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1090,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1082,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1081,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1076,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1026,\n        columnNumber: 9\n      }, this), selectedPaper && selectedTextbook && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"semantic-search-section\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"search-buttons\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"load-last-btn\",\n            onClick: handleLoadLastMatch,\n            disabled: isSearching || !selectedTextbook.uploadedId,\n            title: \"Load previously saved AI search results (instant)\",\n            children: isSearching ? /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"spinner-small\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1135,\n                columnNumber: 21\n              }, this), \"Loading...\"]\n            }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: \"\\uD83D\\uDCCB Show Last Match\"\n            }, void 0, false)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1127,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"index-and-match-btn\",\n            onClick: handleIndexAndMatch,\n            disabled: isSearching || !selectedTextbook.uploadedId || !selectedPaper,\n            title: \"Index textbook (if needed) and match questions with AI\",\n            children: isSearching ? /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"spinner-small\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1152,\n                columnNumber: 21\n              }, this), \"Processing...\"]\n            }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: \"\\uD83D\\uDE80 Index & Match Questions\"\n            }, void 0, false)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1144,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1126,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1125,\n        columnNumber: 11\n      }, this), semanticSearchResults && Object.keys(semanticSearchResults).length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chapter-table-section ai-results\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"\\uD83E\\uDD16 AI Search Results - Chapters with Questions\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1168,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"chapter-table-container\",\n          children: /*#__PURE__*/_jsxDEV(\"table\", {\n            className: \"chapter-table\",\n            children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n              children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"#\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1173,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"Chapter Name\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1174,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"Pages\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1175,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"Questions\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1176,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"Action\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1177,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1172,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1171,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n              children: Object.entries(semanticSearchResults).map(([chapterName, data], index) => {\n                const avgConfidence = data.questions.reduce((sum, q) => {\n                  return sum + (q.chapters && q.chapters[0] ? q.chapters[0].similarity_score : 0);\n                }, 0) / data.questions.length;\n                const isUnmatched = chapterName === 'Unmatched Questions';\n                return /*#__PURE__*/_jsxDEV(\"tr\", {\n                  className: `${(selectedChapter === null || selectedChapter === void 0 ? void 0 : selectedChapter.name) === chapterName ? 'selected-row' : ''} ${isUnmatched ? 'unmatched-row' : ''}`,\n                  children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"chapter-num\",\n                    children: isUnmatched ? 'âš ï¸' : data.chapter.chapter_number || index + 1\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1193,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"chapter-name-cell\",\n                    children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                      children: chapterName\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1197,\n                      columnNumber: 25\n                    }, this), avgConfidence > 0 && !isUnmatched && /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"confidence-badge\",\n                      title: `Average AI confidence: ${avgConfidence.toFixed(1)}%`,\n                      children: [\"\\uD83C\\uDFAF \", avgConfidence.toFixed(0), \"%\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1199,\n                      columnNumber: 27\n                    }, this), isUnmatched && /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"unmatched-badge\",\n                      title: \"Questions that could not be matched to any chapter\",\n                      children: \"\\u26A0\\uFE0F Needs Review\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1204,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1196,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"pages-cell\",\n                    children: isUnmatched ? 'N/A' : `${data.chapter.page_start}-${data.chapter.page_end}`\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1209,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"count-cell\",\n                    children: /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: `question-count ${isUnmatched ? 'unmatched-count' : 'has-questions'}`,\n                      children: data.questions.length\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1213,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1212,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"action-cell\",\n                    children: /*#__PURE__*/_jsxDEV(\"button\", {\n                      className: `view-btn ${isUnmatched ? 'unmatched-btn' : ''}`,\n                      onClick: () => handleChapterSelect({\n                        name: chapterName\n                      }),\n                      children: \"View Questions\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1218,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1217,\n                    columnNumber: 23\n                  }, this)]\n                }, index, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1189,\n                  columnNumber: 21\n                }, this);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1180,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1170,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1169,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"table-summary\",\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Total Chapters:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1233,\n              columnNumber: 17\n            }, this), \" \", Object.keys(semanticSearchResults).length, \" |\", /*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \" Total Questions:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1234,\n              columnNumber: 17\n            }, this), \" \", Object.values(semanticSearchResults).reduce((sum, data) => sum + data.questions.length, 0)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1232,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1231,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1167,\n        columnNumber: 11\n      }, this), selectedChapter && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"questions-display\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"questions-header-info\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: [\"\\u2753 Questions from: \", selectedChapter.name]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1244,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"chapter-meta\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"meta-item\",\n              children: [\"\\uD83D\\uDCD6 \", /*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Textbook:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1246,\n                columnNumber: 48\n              }, this), \" \", selectedTextbook.name]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1246,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"meta-item\",\n              children: [\"\\uD83D\\uDCC4 \", /*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Pages:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1247,\n                columnNumber: 48\n              }, this), \" \", selectedChapter.pages]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1247,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"meta-item\",\n              children: [\"\\uD83D\\uDCDD \", /*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Paper:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1248,\n                columnNumber: 48\n              }, this), \" \", selectedPaper.title]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1248,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1245,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1243,\n          columnNumber: 13\n        }, this), loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"loading\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"spinner\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1254,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Loading questions...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1255,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1253,\n          columnNumber: 15\n        }, this) : questions.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"no-questions\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"No questions found for this chapter\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1259,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"hint\",\n            children: \"Try selecting a different chapter\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1260,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1258,\n          columnNumber: 15\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"questions-list\",\n          children: questions.map((q, index) => {\n            // Use AI chapter data if available, otherwise use selected chapter\n            let pageInfo = 'N/A';\n            if (q.chapters && q.chapters.length > 0) {\n              // AI search result - use first matched chapter\n              const aiChapter = q.chapters[0];\n              pageInfo = `${aiChapter.page_start}-${aiChapter.page_end}`;\n            } else if (selectedChapter && selectedChapter.pages) {\n              // Regular chapter selection - estimate pages\n              pageInfo = estimateQuestionPageNumber(q.question_text, selectedChapter);\n            }\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"question-item\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"question-header\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"question-number\",\n                  children: [\"Q\", q.question_number]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1279,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"chapter-page-badge clickable\",\n                  onClick: () => handlePageClick(pageInfo),\n                  title: \"Click to view textbook pages\",\n                  children: [\"\\uD83D\\uDCD6 Pages: \", pageInfo]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1280,\n                  columnNumber: 23\n                }, this), q.question_type && /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: `question-type ${q.question_type}`,\n                  children: q.question_type.toUpperCase()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1288,\n                  columnNumber: 25\n                }, this), q.marks && /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"question-marks\",\n                  children: [q.marks, \" marks\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1293,\n                  columnNumber: 25\n                }, this), q.has_math && /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"math-badge\",\n                  children: \"\\uD83D\\uDCD0 Math\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1296,\n                  columnNumber: 25\n                }, this), (() => {\n                  // Always show debug info for has_diagram\n                  if (q.has_diagram) {\n                    console.log('Question has diagram:', {\n                      questionNumber: q.question_number,\n                      has_diagram: q.has_diagram,\n                      diagram_files: q.diagram_files,\n                      diagram_files_type: typeof q.diagram_files\n                    });\n                  }\n                  if (!q.has_diagram) return null;\n\n                  // Parse diagram_files if it's a string\n                  let diagramFiles = q.diagram_files;\n                  if (typeof diagramFiles === 'string') {\n                    try {\n                      diagramFiles = JSON.parse(diagramFiles);\n                    } catch (e) {\n                      console.error('Failed to parse diagram_files:', e);\n                      diagramFiles = [];\n                    }\n                  }\n\n                  // Ensure it's an array\n                  if (!Array.isArray(diagramFiles)) {\n                    diagramFiles = diagramFiles ? [diagramFiles] : [];\n                  }\n                  console.log('Processed diagram files:', diagramFiles);\n                  if (diagramFiles && diagramFiles.length > 0) {\n                    console.log('Rendering CLICKABLE diagram badge');\n                    return /*#__PURE__*/_jsxDEV(\"button\", {\n                      type: \"button\",\n                      className: \"diagram-badge clickable\",\n                      onClick: e => {\n                        e.preventDefault();\n                        e.stopPropagation();\n                        console.log('ðŸŽ¯ DIAGRAM BUTTON CLICKED!', diagramFiles);\n                        setSelectedDiagram({\n                          questionNumber: q.question_number,\n                          diagrams: diagramFiles\n                        });\n                      },\n                      title: \"Click to view diagram\",\n                      style: {\n                        cursor: 'pointer',\n                        pointerEvents: 'auto'\n                      },\n                      children: \"\\uD83D\\uDCCA Diagram\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1332,\n                      columnNumber: 29\n                    }, this);\n                  } else {\n                    console.log('Rendering STATIC diagram badge (no files)');\n                    return /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"diagram-badge\",\n                      children: \"\\uD83D\\uDCCA Diagram\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1355,\n                      columnNumber: 34\n                    }, this);\n                  }\n                })(), (() => {\n                  // Check if question has chapter match reasoning\n                  const hasChapterReasoning = q.chapters && q.chapters.length > 0 && q.chapters[0].llm_reasoning;\n                  if (hasChapterReasoning) {\n                    return /*#__PURE__*/_jsxDEV(\"button\", {\n                      className: \"reasoning-btn\",\n                      onClick: () => setSelectedReasoning({\n                        questionNumber: q.question_number,\n                        reasoning: q.chapters[0].llm_reasoning,\n                        chapterTitle: q.chapters[0].chapter_title,\n                        confidence: q.chapters[0].similarity_score,\n                        pageRange: `${q.chapters[0].page_start}-${q.chapters[0].page_end}`\n                      }),\n                      title: \"View AI chapter matching reasoning\",\n                      children: \"\\uD83E\\uDDE0 Why This Chapter?\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1364,\n                      columnNumber: 29\n                    }, this);\n                  }\n\n                  // Fallback: show parsed data if available\n                  let parsedData = q.parsed_data;\n                  if (typeof parsedData === 'string') {\n                    try {\n                      parsedData = JSON.parse(parsedData);\n                    } catch (e) {\n                      parsedData = {};\n                    }\n                  }\n                  return parsedData && Object.keys(parsedData).length > 0 && /*#__PURE__*/_jsxDEV(\"button\", {\n                    className: \"reasoning-btn\",\n                    onClick: () => setSelectedReasoning({\n                      questionNumber: q.question_number,\n                      reasoning: 'No chapter matching reasoning available',\n                      llmResponse: JSON.stringify(parsedData, null, 2)\n                    }),\n                    title: \"View AI parsed data\",\n                    children: \"\\uD83E\\uDDE0 AI Data\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1390,\n                    columnNumber: 27\n                  }, this);\n                })(), /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"solve-btn\",\n                  onClick: () => handleSolveQuestion(q),\n                  disabled: solvingQuestion,\n                  title: \"Get detailed step-by-step solution\",\n                  children: solvingQuestion ? 'â³ Solving...' : 'âœ¨ Solve Question'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1403,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1278,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"question-text\",\n                children: q.question_text\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1412,\n                columnNumber: 21\n              }, this), (() => {\n                // Parse sub_parts if it's a string\n                let subParts = q.sub_parts;\n                if (typeof subParts === 'string') {\n                  try {\n                    subParts = JSON.parse(subParts);\n                  } catch (e) {\n                    subParts = [];\n                  }\n                }\n                return subParts && Array.isArray(subParts) && subParts.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"sub-parts\",\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Sub-parts:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1427,\n                    columnNumber: 27\n                  }, this), \" \", subParts.join(', ')]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1426,\n                  columnNumber: 25\n                }, this);\n              })()]\n            }, q.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1277,\n              columnNumber: 19\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1263,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1242,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1024,\n      columnNumber: 7\n    }, this), showTextbookModal && textbookPageToShow && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"textbook-modal-overlay\",\n      onClick: handleCloseModal,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"textbook-modal-content\",\n        onClick: e => e.stopPropagation(),\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"textbook-modal-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"modal-title-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              children: [\"\\uD83D\\uDCD6 \", textbookPageToShow.textbook.name]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1446,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"modal-subtitle\",\n              children: [\"Chapter: \", textbookPageToShow.chapter, \" | Pages: \", textbookPageToShow.pageRange]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1447,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1445,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"modal-close-btn\",\n            onClick: handleCloseModal,\n            children: \"\\u2715\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1451,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1444,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"textbook-modal-body\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"textbook-viewer\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"page-info\",\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"current-page-indicator\",\n                children: [\"\\uD83D\\uDCC4 Page \", currentPage, \" of \", textbookPageToShow.pageRange]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1462,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1461,\n              columnNumber: 17\n            }, this), textbookPageToShow.textbook.uploadedFile ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"pdf-embed-container\",\n              children: [pdfLoading && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"pdf-loading-overlay\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"spinner\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1472,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: [\"Loading page \", currentPage, \"...\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1473,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1471,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"iframe\", {\n                src: `http://localhost:5000/api/textbook-pdf/${textbookPageToShow.textbook.uploadedId}#page=${currentPage}&zoom=page-fit`,\n                title: `Textbook Page ${currentPage}`,\n                className: \"textbook-pdf-iframe\",\n                frameBorder: \"0\",\n                allow: \"fullscreen\",\n                onLoad: () => setPdfLoading(false)\n              }, `pdf-${currentPage}`, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1476,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1469,\n              columnNumber: 19\n            }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"no-textbook-message\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"external-icon\",\n                children: \"\\uD83D\\uDCDA\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1488,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n                children: \"No Textbook Uploaded\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1489,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"viewer-description\",\n                children: [\"Please upload a textbook file for \", textbookPageToShow.textbook.name, \" to view pages.\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1490,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"link-info\",\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Textbook:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1494,\n                    columnNumber: 26\n                  }, this), \" \", textbookPageToShow.textbook.name]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1494,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Chapter:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1495,\n                    columnNumber: 26\n                  }, this), \" \", textbookPageToShow.chapter]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1495,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Pages:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1496,\n                    columnNumber: 26\n                  }, this), \" \", textbookPageToShow.pageRange]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1496,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"upload-hint\",\n                  children: \"Go to \\\"Upload Papers\\\" menu to upload textbook PDFs\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1497,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1493,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1487,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"page-navigation\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"nav-btn\",\n                onClick: handlePrevPage,\n                disabled: currentPage <= textbookPageToShow.startPage,\n                children: \"\\u2190 Previous\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1504,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"page-display\",\n                children: [\"Page \", currentPage]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1511,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"nav-btn\",\n                onClick: handleNextPage,\n                disabled: currentPage >= textbookPageToShow.endPage,\n                children: \"Next \\u2192\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1514,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1503,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1460,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1459,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"textbook-modal-footer\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"footer-info\",\n            children: /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"page-count\",\n              children: [textbookPageToShow.endPage - textbookPageToShow.startPage + 1, \" pages in range\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1527,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1526,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"close-modal-btn\",\n            onClick: handleCloseModal,\n            children: \"Close\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1531,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1525,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1443,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1442,\n      columnNumber: 9\n    }, this), selectedReasoning && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"reasoning-modal\",\n      onClick: () => setSelectedReasoning(null),\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"reasoning-modal-content\",\n        onClick: e => e.stopPropagation(),\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"reasoning-modal-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: [\"\\uD83E\\uDDE0 Chapter Matching Analysis - Q\", selectedReasoning.questionNumber]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1547,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"close-reasoning-btn\",\n            onClick: () => setSelectedReasoning(null),\n            children: \"\\u2715\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1548,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1546,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"reasoning-modal-body\",\n          children: [selectedReasoning.chapterTitle && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"chapter-match-info\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"match-detail\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"match-label\",\n                children: \"\\uD83D\\uDCDA Matched Chapter:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1555,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"match-value\",\n                children: selectedReasoning.chapterTitle\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1556,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1554,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"match-detail\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"match-label\",\n                children: \"\\uD83D\\uDCC4 Pages:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1559,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"match-value\",\n                children: selectedReasoning.pageRange\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1560,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1558,\n              columnNumber: 19\n            }, this), selectedReasoning.confidence && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"match-detail\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"match-label\",\n                children: \"\\uD83C\\uDFAF Confidence:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1564,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"match-value\",\n                children: [selectedReasoning.confidence, \"%\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1565,\n                columnNumber: 23\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1563,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1553,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"reasoning-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              children: \"\\uD83D\\uDCAD AI Reasoning:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1572,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"reasoning-content\",\n              children: selectedReasoning.reasoning\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1573,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1571,\n            columnNumber: 15\n          }, this), selectedReasoning.llmResponse && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"llm-response-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              children: \"\\uD83E\\uDD16 Technical Details (JSON):\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1580,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"llm-response-content\",\n              children: /*#__PURE__*/_jsxDEV(\"pre\", {\n                children: selectedReasoning.llmResponse\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1582,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1581,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1579,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1551,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1545,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1544,\n      columnNumber: 9\n    }, this), selectedSolution && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"solution-modal\",\n      onClick: () => setSelectedSolution(null),\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"solution-modal-content\",\n        onClick: e => e.stopPropagation(),\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"solution-modal-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              children: [\"\\u2728 Step-by-Step Solution - Q\", selectedSolution.questionNumber]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1597,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"solution-type-badge\",\n              children: selectedSolution.questionType\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1598,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1596,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"close-solution-btn\",\n            onClick: () => setSelectedSolution(null),\n            children: \"\\u2715\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1600,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1595,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"solution-modal-body\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"solution-question-box\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              children: \"\\uD83D\\uDCDD Question:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1606,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: selectedSolution.questionText\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1607,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1605,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"solution-content\",\n            children: (() => {\n              const lines = selectedSolution.solution.split('\\n');\n              let inDiagram = false;\n              let diagramLines = [];\n              let lastWasEmpty = false;\n              let lastWasSection = false;\n              let currentSection = null;\n              const elements = [];\n              lines.forEach((line, idx) => {\n                // Detect ASCII art diagram patterns (box drawing characters)\n                const isAsciiArt = line.match(/^[\\s]*[\\+\\-\\|\\/\\\\<>]+[\\s\\+\\-\\|\\/\\\\<>]*$/) || line.match(/^[\\s]*[\\+\\-\\|]{3,}/) || line.match(/[\\+\\-]{5,}/) || line.includes('|') && line.includes('+');\n\n                // Detect diagram start/end\n                if (line.match(/^\\*\\*Diagram/i) || line.includes('```') || !inDiagram && isAsciiArt) {\n                  if (!inDiagram) {\n                    // Starting a diagram\n                    inDiagram = true;\n                    if (isAsciiArt) {\n                      diagramLines.push(line);\n                    }\n                  } else {\n                    // Ending a diagram\n                    if (line.includes('```') || line.match(/^\\*\\*Diagram/i)) {\n                      inDiagram = false;\n                    } else if (isAsciiArt) {\n                      diagramLines.push(line);\n                    } else {\n                      // End of ASCII art\n                      inDiagram = false;\n                    }\n                    if (!inDiagram && diagramLines.length > 0) {\n                      const diagram = diagramLines.join('\\n');\n                      diagramLines = [];\n                      elements.push(/*#__PURE__*/_jsxDEV(\"pre\", {\n                        className: \"solution-diagram\",\n                        children: diagram\n                      }, idx, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1650,\n                        columnNumber: 41\n                      }, this));\n                      lastWasEmpty = false;\n                      lastWasSection = true;\n                    }\n                  }\n                  return;\n                }\n\n                // Collect diagram lines\n                if (inDiagram) {\n                  diagramLines.push(line);\n                  return;\n                }\n\n                // Highlight section headers (bold text with **)\n                if (line.match(/^\\*\\*.*\\*\\*:?$/)) {\n                  const sectionName = line.replace(/\\*\\*/g, '').replace(/:/g, '').trim().toLowerCase();\n                  currentSection = sectionName;\n                  elements.push(/*#__PURE__*/_jsxDEV(\"h4\", {\n                    className: \"solution-section-header\",\n                    children: line.replace(/\\*\\*/g, '').replace(/:/g, '')\n                  }, idx, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1668,\n                    columnNumber: 37\n                  }, this));\n                  lastWasEmpty = false;\n                  lastWasSection = true;\n                  return;\n                }\n\n                // Highlight final answer\n                if (line.match(/FINAL ANSWER:/i)) {\n                  elements.push(/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"final-answer-box\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"final-answer-icon\",\n                      children: \"\\uD83C\\uDFAF\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1678,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"final-answer-text\",\n                      dangerouslySetInnerHTML: {\n                        __html: line.replace(/FINAL ANSWER:/i, '').trim()\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1679,\n                      columnNumber: 27\n                    }, this)]\n                  }, idx, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1677,\n                    columnNumber: 25\n                  }, this));\n                  lastWasEmpty = false;\n                  lastWasSection = true;\n                  return;\n                }\n\n                // Highlight step numbers\n                if (line.match(/^(Step \\d+:|^\\d+\\.)/)) {\n                  elements.push(/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"solution-step\",\n                    dangerouslySetInnerHTML: {\n                      __html: line\n                    }\n                  }, idx, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1692,\n                    columnNumber: 25\n                  }, this));\n                  lastWasEmpty = false;\n                  lastWasSection = false;\n                  return;\n                }\n\n                // Handle empty lines - only add one between sections\n                if (!line.trim()) {\n                  // Don't add spacers within compact sections (given, find, formula)\n                  const compactSections = ['given', 'find', 'formula', 'concept', 'formula/concept'];\n                  const isCompactSection = compactSections.some(s => currentSection && currentSection.includes(s));\n                  if (!lastWasEmpty && lastWasSection && !isCompactSection) {\n                    elements.push(/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"section-spacer\"\n                    }, idx, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1708,\n                      columnNumber: 39\n                    }, this));\n                    lastWasEmpty = true;\n                  }\n                  return;\n                }\n\n                // Format mathematical/scientific expressions\n                const formatExpression = text => {\n                  return text\n                  // Preserve existing HTML entities\n                  .replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;')\n                  // Keep special characters as-is (they're already Unicode)\n                  .replace(/\\*\\*(.+?)\\*\\*/g, '<strong>$1</strong>') // Bold\n                  .replace(/\\*(.+?)\\*/g, '<em>$1</em>'); // Italic\n                };\n\n                // Regular text with formatting\n                const compactSections = ['given', 'find', 'formula', 'concept', 'formula/concept'];\n                const isCompactSection = compactSections.some(s => currentSection && currentSection.includes(s));\n                const textClass = isCompactSection ? 'solution-text compact' : 'solution-text';\n                elements.push(/*#__PURE__*/_jsxDEV(\"p\", {\n                  className: textClass,\n                  dangerouslySetInnerHTML: {\n                    __html: formatExpression(line)\n                  }\n                }, idx, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1732,\n                  columnNumber: 23\n                }, this));\n                lastWasEmpty = false;\n                lastWasSection = false;\n              });\n              return elements;\n            })()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1611,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1603,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1594,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1593,\n      columnNumber: 9\n    }, this), selectedDiagram && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"diagram-modal-overlay\",\n      onClick: () => setSelectedDiagram(null),\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"diagram-modal-content\",\n        onClick: e => e.stopPropagation(),\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"diagram-modal-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: [\"\\uD83D\\uDCCA Diagram - Q\", selectedDiagram.questionNumber]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1753,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"close-diagram-btn\",\n            onClick: () => setSelectedDiagram(null),\n            children: \"\\u2715\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1754,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1752,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"diagram-modal-body\",\n          children: selectedDiagram.diagrams.map((diagram, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"diagram-container\",\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              src: `http://localhost:5000${diagram}`,\n              alt: `Diagram ${idx + 1}`,\n              className: \"diagram-image\",\n              onError: e => {\n                e.target.style.display = 'none';\n                e.target.nextSibling.style.display = 'block';\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1759,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"diagram-error\",\n              style: {\n                display: 'none'\n              },\n              children: \"\\u26A0\\uFE0F Failed to load diagram\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1768,\n              columnNumber: 19\n            }, this)]\n          }, idx, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1758,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1756,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1751,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1750,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 1012,\n    columnNumber: 5\n  }, this);\n};\n_s(ChapterQuestions, \"pKapQJryYCf8MC+hCoIHVFvagyI=\");\n_c = ChapterQuestions;\nexport default ChapterQuestions;\nvar _c;\n$RefreshReg$(_c, \"ChapterQuestions\");","map":{"version":3,"names":["React","useState","useEffect","axios","jsxDEV","_jsxDEV","Fragment","_Fragment","ChapterQuestions","_s","papers","setPapers","textbooks","setTextbooks","selectedPaper","setSelectedPaper","selectedTextbook","setSelectedTextbook","chapters","setChapters","chapterStats","setChapterStats","selectedChapter","setSelectedChapter","questions","setQuestions","loading","setLoading","message","setMessage","type","text","showTextbookModal","setShowTextbookModal","textbookPageToShow","setTextbookPageToShow","currentPage","setCurrentPage","pdfLoading","setPdfLoading","semanticSearchResults","setSemanticSearchResults","isSearching","setIsSearching","selectedReasoning","setSelectedReasoning","selectedSolution","setSelectedSolution","solvingQuestion","setSolvingQuestion","selectedDiagram","setSelectedDiagram","defaultTextbooks","name","pdfUrl","externalUrl","imageBasePath","pages","fetchPapers","fetchAllTextbooks","calculateChapterStats","response","get","data","err","console","error","uploadedTextbooks","textbooksToDisplay","map","uploaded","_defaultTextbooks$upl","defaultForSubject","subject","title","uploadedFile","file_path","uploadedId","id","uploadedTitle","length","handlePaperSelect","paper","handleTextbookSelect","textbook","log","allQuestions","stats","chapter","chapterQuestions","filterQuestionsByChapter","questionCount","handleClearResults","handleIndexAndMatch","needsIndexing","_err$response","_err$response2","_err$response2$data","_err$response2$data$e","status","includes","indexResponse","post","success","Error","chapters_count","questionsResponse","mappingResponse","textbook_id","mappedQuestions","mapped_questions","chapterGroups","unmatchedQuestions","forEach","q","topChapter","chapterKey","chapter_title","push","chapter_number","page_start","page_end","similarity_score","totalQuestions","Object","values","reduce","sum","keys","saveSearchResults","_err$response3","_err$response3$data","errorMsg","handleIndexTextbook","_err$response4","_err$response4$data","handleRunSemanticSearch","_err$response5","_err$response5$data","paper_id","search_results","_error$response","handleLoadLastMatch","total_chapters","total_questions","unmatched_count","created_at","date","Date","timeAgo","getTimeAgo","_err$response6","_err$response7","_err$response7$data","seconds","Math","floor","toLocaleDateString","handleChapterSelect","chapterData","chapterInfo","warn","handleSolveQuestion","question","chapterContext","question_text","question_type","chapter_context","questionNumber","question_number","questionText","questionType","solution","parsedSolution","parsed_solution","source","chapter_name","timestamp","toISOString","saveErr","alert","_error$response2","_error$response2$data","estimateQuestionPageNumber","startPage","endPage","split","p","parseInt","trim","totalPages","subTopicPositions","lowerText","toLowerCase","estimatedPosition","matchFound","subTopic","position","entries","estimatedPage","round","rangeStart","max","rangeEnd","min","handlePageClick","pageRange","handleNextPage","nextPage","setTimeout","handlePrevPage","prevPage","handleCloseModal","chapterKeywords","primary","secondary","keywords","filter","some","keyword","score","className","children","fileName","_jsxFileName","lineNumber","columnNumber","style","width","index","onClick","checked","onChange","disabled","e","stopPropagation","chapterName","avgConfidence","isUnmatched","toFixed","pageInfo","aiChapter","toUpperCase","marks","has_math","has_diagram","diagram_files","diagram_files_type","diagramFiles","JSON","parse","Array","isArray","preventDefault","diagrams","cursor","pointerEvents","hasChapterReasoning","llm_reasoning","reasoning","chapterTitle","confidence","parsedData","parsed_data","llmResponse","stringify","subParts","sub_parts","join","src","frameBorder","allow","onLoad","lines","inDiagram","diagramLines","lastWasEmpty","lastWasSection","currentSection","elements","line","idx","isAsciiArt","match","diagram","sectionName","replace","dangerouslySetInnerHTML","__html","compactSections","isCompactSection","s","formatExpression","textClass","alt","onError","target","display","nextSibling","_c","$RefreshReg$"],"sources":["D:/AI/_Programs/CBSE/aqnamic/frontend/src/components/ChapterQuestions.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport './ChapterQuestions.css';\n\nconst ChapterQuestions = () => {\n  const [papers, setPapers] = useState([]);\n  const [textbooks, setTextbooks] = useState([]);\n  const [selectedPaper, setSelectedPaper] = useState(null);\n  const [selectedTextbook, setSelectedTextbook] = useState(null);\n  const [chapters, setChapters] = useState([]);\n  const [chapterStats, setChapterStats] = useState([]);\n  const [selectedChapter, setSelectedChapter] = useState(null);\n  const [questions, setQuestions] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [message, setMessage] = useState({ type: '', text: '' });\n  const [showTextbookModal, setShowTextbookModal] = useState(false);\n  const [textbookPageToShow, setTextbookPageToShow] = useState(null);\n  const [currentPage, setCurrentPage] = useState(1);\n  const [pdfLoading, setPdfLoading] = useState(false);\n  const [semanticSearchResults, setSemanticSearchResults] = useState(null);\n  const [isSearching, setIsSearching] = useState(false);\n  const [selectedReasoning, setSelectedReasoning] = useState(null);\n  const [selectedSolution, setSelectedSolution] = useState(null);\n  const [solvingQuestion, setSolvingQuestion] = useState(false);\n  const [selectedDiagram, setSelectedDiagram] = useState(null);\n\n  // Predefined textbooks with chapters and page numbers\n  const defaultTextbooks = {\n    'Physics': [\n      {\n        name: 'NCERT Physics Class 10',\n        pdfUrl: 'https://ncert.nic.in/textbook/pdf/keph101.pdf',\n        externalUrl: 'https://ncert.nic.in/textbook.php?keph1=0-8',\n        imageBasePath: '/textbooks/physics-class10/pages/',\n        chapters: [\n          { name: 'Electricity', pages: '1-20' },\n          { name: 'Magnetic Effects of Current', pages: '21-40' },\n          { name: 'Light - Reflection and Refraction', pages: '41-65' },\n          { name: 'Human Eye and Colourful World', pages: '66-85' },\n          { name: 'Sources of Energy', pages: '86-105' }\n        ]\n      }\n    ],\n    'Chemistry': [\n      {\n        name: 'NCERT Chemistry Class 10',\n        pdfUrl: 'https://ncert.nic.in/textbook/pdf/kesc101.pdf',\n        externalUrl: 'https://ncert.nic.in/textbook.php?kesc1=0-8',\n        imageBasePath: '/textbooks/chemistry-class10/pages/',\n        chapters: [\n          { name: 'Chemical Reactions and Equations', pages: '1-18' },\n          { name: 'Acids, Bases and Salts', pages: '19-35' },\n          { name: 'Metals and Non-metals', pages: '36-55' },\n          { name: 'Carbon and its Compounds', pages: '56-80' },\n          { name: 'Periodic Classification of Elements', pages: '81-95' }\n        ]\n      }\n    ],\n    'Biology': [\n      {\n        name: 'NCERT Biology Class 10',\n        pdfUrl: 'https://ncert.nic.in/textbook/pdf/kebo101.pdf',\n        externalUrl: 'https://ncert.nic.in/textbook.php?kebo1=0-8',\n        imageBasePath: '/textbooks/biology-class10/pages/',\n        chapters: [\n          { name: 'Life Processes', pages: '1-25' },\n          { name: 'Control and Coordination', pages: '26-45' },\n          { name: 'How do Organisms Reproduce', pages: '46-70' },\n          { name: 'Heredity and Evolution', pages: '71-90' },\n          { name: 'Our Environment', pages: '91-110' }\n        ]\n      }\n    ],\n    'Mathematics': [\n      {\n        name: 'NCERT Mathematics Class 10',\n        pdfUrl: 'https://ncert.nic.in/textbook/pdf/kemh101.pdf',\n        externalUrl: 'https://ncert.nic.in/textbook.php?kemh1=0-16',\n        imageBasePath: '/textbooks/mathematics-class10/pages/',\n        chapters: [\n          { name: 'Real Numbers', pages: '1-15' },\n          { name: 'Polynomials', pages: '16-30' },\n          { name: 'Pair of Linear Equations in Two Variables', pages: '31-50' },\n          { name: 'Quadratic Equations', pages: '51-70' },\n          { name: 'Arithmetic Progressions', pages: '71-85' },\n          { name: 'Triangles', pages: '86-110' },\n          { name: 'Coordinate Geometry', pages: '111-130' },\n          { name: 'Introduction to Trigonometry', pages: '131-150' },\n          { name: 'Some Applications of Trigonometry', pages: '151-165' },\n          { name: 'Circles', pages: '166-185' },\n          { name: 'Areas Related to Circles', pages: '186-200' },\n          { name: 'Surface Areas and Volumes', pages: '201-225' },\n          { name: 'Statistics', pages: '226-245' },\n          { name: 'Probability', pages: '246-260' }\n        ]\n      }\n    ]\n  };\n\n  useEffect(() => {\n    fetchPapers();\n    fetchAllTextbooks();\n  }, []);\n\n  useEffect(() => {\n    if (selectedPaper && selectedTextbook) {\n      calculateChapterStats();\n    }\n  }, [selectedPaper, selectedTextbook]);\n\n  const fetchPapers = async () => {\n    try {\n      const response = await axios.get('http://localhost:5000/api/uploaded-papers');\n      setPapers(response.data);\n    } catch (err) {\n      console.error('Error fetching papers:', err);\n      setMessage({ type: 'error', text: 'Failed to load papers' });\n    }\n  };\n\n  const fetchAllTextbooks = async () => {\n    try {\n      // Fetch all uploaded textbooks\n      const response = await axios.get('http://localhost:5000/api/textbooks');\n      const uploadedTextbooks = response.data || [];\n      \n      // Use uploaded textbooks directly, with default chapter structure as fallback\n      const textbooksToDisplay = uploadedTextbooks.map(uploaded => {\n        // Get default chapters for this subject if available\n        const defaultForSubject = defaultTextbooks[uploaded.subject]?.[0];\n        \n        return {\n          name: uploaded.title,  // Use actual uploaded title\n          subject: uploaded.subject,\n          uploadedFile: uploaded.file_path,\n          uploadedId: uploaded.id,\n          uploadedTitle: uploaded.title,\n          chapters: defaultForSubject?.chapters || [],  // Use default chapters as template\n          pdfUrl: '',\n          externalUrl: '',\n          imageBasePath: ''\n        };\n      });\n      \n      setTextbooks(textbooksToDisplay);\n      \n      // If no textbooks uploaded, show message\n      if (textbooksToDisplay.length === 0) {\n        setMessage({ \n          type: 'info', \n          text: 'No textbooks uploaded yet. Please upload a textbook first.' \n        });\n      }\n    } catch (err) {\n      console.error('Error fetching textbooks:', err);\n      setMessage({ \n        type: 'error', \n        text: 'Failed to load textbooks. Please try again.' \n      });\n      setTextbooks([]);\n    }\n  };\n\n  const handlePaperSelect = (paper) => {\n    setSelectedPaper(paper);\n    setSelectedTextbook(null);\n    setSelectedChapter(null);\n    setQuestions([]);\n    setChapters([]);\n    setChapterStats([]);\n    setSemanticSearchResults(null);  // Clear previous search results\n    \n    // Don't reload textbooks - they're already loaded with correct names\n    // Just clear the selection and let user select from existing list\n  };\n\n  const handleTextbookSelect = (textbook) => {\n    setSelectedTextbook(textbook);\n    setSelectedChapter(null);\n    setQuestions([]);\n    setChapters(textbook.chapters);\n    setSemanticSearchResults(null);  // Clear previous search results when textbook changes\n    \n    // Log textbook info for debugging\n    console.log('Selected textbook:', textbook.name);\n    console.log('Has uploaded file:', !!textbook.uploadedId);\n    \n    // Don't show selection message - table selection is clear enough\n  };\n\n  const calculateChapterStats = async () => {\n    if (!selectedPaper || !selectedTextbook) return;\n\n    try {\n      // Fetch all questions from the selected paper\n      const response = await axios.get(\n        `http://localhost:5000/api/parsed-questions?paper_id=${selectedPaper.id}`\n      );\n      \n      const allQuestions = response.data;\n      \n      // Calculate question count for each chapter\n      const stats = selectedTextbook.chapters.map(chapter => {\n        const chapterQuestions = filterQuestionsByChapter(allQuestions, chapter.name);\n        return {\n          ...chapter,\n          questionCount: chapterQuestions.length\n        };\n      });\n      \n      setChapterStats(stats);\n    } catch (err) {\n      console.error('Error calculating chapter stats:', err);\n    }\n  };\n\n  const handleClearResults = () => {\n    setSemanticSearchResults(null);\n    setQuestions([]);\n    setSelectedChapter(null);\n    setChapterStats([]); // Clear the chapter stats table\n    setMessage({ type: 'info', text: 'Search results cleared. Ready for new search.' });\n  };\n\n  const handleIndexAndMatch = async () => {\n    // Unified workflow: Index textbook (if needed) + Run AI Search\n    if (!selectedPaper || !selectedTextbook) {\n      setMessage({ type: 'warning', text: 'Please select both a question paper and textbook first' });\n      return;\n    }\n\n    if (!selectedTextbook.uploadedId) {\n      setMessage({ type: 'warning', text: 'Please upload the textbook first' });\n      return;\n    }\n\n    setIsSearching(true);\n\n    try {\n      // Step 1: Check if textbook is already indexed by trying to run search\n      console.log('ðŸš€ Starting Index & Match workflow...');\n      setMessage({ type: 'info', text: 'ðŸ” Checking if textbook is indexed...' });\n\n      let needsIndexing = false;\n\n      // Try to get chapters to see if indexed\n      try {\n        await axios.get(`http://localhost:5000/api/textbook-chapters/${selectedTextbook.uploadedId}`);\n        console.log('âœ“ Textbook already indexed');\n        setMessage({ type: 'info', text: 'âœ“ Textbook already indexed. Running AI search...' });\n      } catch (err) {\n        if (err.response?.status === 404 || err.response?.data?.error?.includes('No vector index')) {\n          needsIndexing = true;\n          console.log('âš  Textbook not indexed, will index now');\n        } else {\n          throw err;\n        }\n      }\n\n      // Step 2: Index if needed\n      if (needsIndexing) {\n        setMessage({ type: 'info', text: 'ðŸ“š Indexing textbook... This may take a few minutes.' });\n        \n        const indexResponse = await axios.post(\n          `http://localhost:5000/api/index-textbook/${selectedTextbook.uploadedId}`\n        );\n\n        if (!indexResponse.data.success) {\n          throw new Error(indexResponse.data.error || 'Indexing failed');\n        }\n\n        console.log(`âœ“ Indexed ${indexResponse.data.chapters_count} chapters`);\n        setMessage({ \n          type: 'info', \n          text: `âœ… Indexed ${indexResponse.data.chapters_count} chapters. Now matching questions...` \n        });\n      }\n\n      // Step 3: Run AI Search\n      setMessage({ type: 'info', text: 'ðŸ¤– Running AI Search with LLM analysis...' });\n\n      // Fetch all questions from the selected paper\n      const questionsResponse = await axios.get(\n        `http://localhost:5000/api/parsed-questions?paper_id=${selectedPaper.id}`\n      );\n      \n      const allQuestions = questionsResponse.data;\n\n      // Use semantic search to map questions to chapters\n      const mappingResponse = await axios.post(\n        'http://localhost:5000/api/map-questions-to-chapters',\n        {\n          questions: allQuestions,\n          textbook_id: selectedTextbook.uploadedId\n        }\n      );\n      \n      if (mappingResponse.data.success) {\n        const mappedQuestions = mappingResponse.data.mapped_questions;\n        \n        // Group questions by chapter\n        const chapterGroups = {};\n        const unmatchedQuestions = [];\n        \n        mappedQuestions.forEach(q => {\n          if (q.chapters && q.chapters.length > 0) {\n            const topChapter = q.chapters[0];\n            const chapterKey = topChapter.chapter_title;\n            \n            if (!chapterGroups[chapterKey]) {\n              chapterGroups[chapterKey] = {\n                chapter: topChapter,\n                questions: []\n              };\n            }\n            chapterGroups[chapterKey].questions.push(q);\n          } else {\n            unmatchedQuestions.push(q);\n          }\n        });\n        \n        // Add unmatched questions if any\n        if (unmatchedQuestions.length > 0) {\n          chapterGroups['Unmatched Questions'] = {\n            chapter: {\n              chapter_number: 0,\n              chapter_title: 'Unmatched Questions',\n              page_start: 'N/A',\n              page_end: 'N/A',\n              similarity_score: 0\n            },\n            questions: unmatchedQuestions\n          };\n        }\n        \n        const totalQuestions = Object.values(chapterGroups).reduce((sum, data) => sum + data.questions.length, 0);\n        \n        // Clear old chapter stats\n        setChapterStats([]);\n        \n        setSemanticSearchResults(chapterGroups);\n        setMessage({\n          type: 'success',\n          text: `ðŸŽ‰ Complete! Found ${Object.keys(chapterGroups).length} chapters with ${totalQuestions} questions (${unmatchedQuestions.length} unmatched). Click a chapter below.`\n        });\n        \n        // Save results to database\n        await saveSearchResults(chapterGroups);\n      } else {\n        throw new Error('AI search failed');\n      }\n    } catch (err) {\n      console.error('Error in Index & Match workflow:', err);\n      const errorMsg = err.response?.data?.error || err.message;\n      \n      setMessage({ \n        type: 'error', \n        text: `Failed: ${errorMsg}` \n      });\n    } finally {\n      setIsSearching(false);\n    }\n  };\n\n  const handleIndexTextbook = async () => {\n    // Legacy function - kept for backward compatibility\n    if (!selectedTextbook || !selectedTextbook.uploadedId) {\n      setMessage({ type: 'warning', text: 'Please select a textbook first' });\n      return;\n    }\n\n    setIsSearching(true);\n    setMessage({ type: 'info', text: 'ðŸ“š Indexing textbook... This may take a few minutes.' });\n\n    try {\n      const response = await axios.post(\n        `http://localhost:5000/api/index-textbook/${selectedTextbook.uploadedId}`\n      );\n\n      if (response.data.success) {\n        setMessage({\n          type: 'success',\n          text: `âœ… Textbook indexed successfully! ${response.data.chapters_count} chapters indexed. You can now run AI semantic search.`\n        });\n      } else {\n        throw new Error(response.data.error || 'Indexing failed');\n      }\n    } catch (err) {\n      console.error('Error indexing textbook:', err);\n      setMessage({\n        type: 'error',\n        text: `Failed to index textbook: ${err.response?.data?.error || err.message}`\n      });\n    } finally {\n      setIsSearching(false);\n    }\n  };\n\n  const handleRunSemanticSearch = async () => {\n    if (!selectedPaper || !selectedTextbook) {\n      setMessage({ type: 'warning', text: 'Please select both a question paper and textbook first' });\n      return;\n    }\n\n    if (!selectedTextbook.uploadedId) {\n      setMessage({ type: 'warning', text: 'Please upload the textbook to use AI semantic search' });\n      return;\n    }\n\n    setIsSearching(true);\n    setMessage({ type: 'info', text: 'ðŸ¤– Running AI Search with LLM analysis...' });\n\n    try {\n      // Fetch all questions from the selected paper\n      const response = await axios.get(\n        `http://localhost:5000/api/parsed-questions?paper_id=${selectedPaper.id}`\n      );\n      \n      const allQuestions = response.data;\n\n      // Use semantic search to map questions to chapters\n      const mappingResponse = await axios.post(\n        'http://localhost:5000/api/map-questions-to-chapters',\n        {\n          questions: allQuestions,\n          textbook_id: selectedTextbook.uploadedId\n        }\n      );\n      \n      if (mappingResponse.data.success) {\n        const mappedQuestions = mappingResponse.data.mapped_questions;\n        \n        // Group questions by chapter\n        const chapterGroups = {};\n        const unmatchedQuestions = [];\n        \n        mappedQuestions.forEach(q => {\n          if (q.chapters && q.chapters.length > 0) {\n            const topChapter = q.chapters[0]; // Use best match\n            const chapterKey = topChapter.chapter_title;\n            \n            if (!chapterGroups[chapterKey]) {\n              chapterGroups[chapterKey] = {\n                chapter: topChapter,\n                questions: []\n              };\n            }\n            chapterGroups[chapterKey].questions.push(q);\n          } else {\n            // No chapter match found\n            unmatchedQuestions.push(q);\n          }\n        });\n        \n        // Add unmatched questions as a separate group if any exist\n        if (unmatchedQuestions.length > 0) {\n          chapterGroups['Unmatched Questions'] = {\n            chapter: {\n              chapter_number: 0,\n              chapter_title: 'Unmatched Questions',\n              page_start: 'N/A',\n              page_end: 'N/A',\n              similarity_score: 0\n            },\n            questions: unmatchedQuestions\n          };\n        }\n        \n        const totalQuestions = Object.values(chapterGroups).reduce((sum, data) => sum + data.questions.length, 0);\n        \n        console.log('Chapter groups created:', Object.keys(chapterGroups));\n        console.log('Full chapter groups:', chapterGroups);\n        \n        // Clear old chapter stats to show only AI results\n        setChapterStats([]);\n        \n        setSemanticSearchResults(chapterGroups);\n        setMessage({\n          type: 'success',\n          text: `ðŸ¤– AI Search Complete! Found ${Object.keys(chapterGroups).length} chapters with ${totalQuestions} questions (${unmatchedQuestions.length} unmatched). Click on a chapter below to view questions.`\n        });\n        \n        // Save results to database\n        await saveSearchResults(chapterGroups);\n      } else {\n        throw new Error('Semantic search failed');\n      }\n    } catch (err) {\n      console.error('Error in semantic search:', err);\n      const errorMsg = err.response?.data?.error || err.message;\n      \n      // Check if it's an indexing issue\n      if (errorMsg.includes('No vector index found') || errorMsg.includes('index')) {\n        setMessage({ \n          type: 'error', \n          text: 'âš ï¸ Textbook not indexed. Please click \"Index Textbook\" button first.' \n        });\n      } else {\n        setMessage({ \n          type: 'error', \n          text: `AI semantic search failed: ${errorMsg}` \n        });\n      }\n    } finally {\n      setIsSearching(false);\n    }\n  };\n\n  const saveSearchResults = async (chapterGroups) => {\n    try {\n      console.log('ðŸ’¾ Saving search results to database...');\n      console.log('  Paper ID:', selectedPaper.id);\n      console.log('  Textbook ID:', selectedTextbook.uploadedId);\n      console.log('  Chapters:', Object.keys(chapterGroups).length);\n      \n      const response = await axios.post('http://localhost:5000/api/save-ai-search-results', {\n        paper_id: selectedPaper.id,\n        textbook_id: selectedTextbook.uploadedId,\n        search_results: chapterGroups\n      });\n      \n      console.log('âœ“ Search results saved to database:', response.data);\n    } catch (error) {\n      console.error('âŒ Failed to save search results:', error);\n      console.error('  Error details:', error.response?.data);\n      // Don't show error to user - this is a background operation\n    }\n  };\n\n  const handleLoadLastMatch = async () => {\n    if (!selectedPaper || !selectedTextbook || !selectedTextbook.uploadedId) {\n      setMessage({ type: 'warning', text: 'Please select both a question paper and textbook first' });\n      return;\n    }\n\n    setIsSearching(true);\n    setMessage({ type: 'info', text: 'ðŸ“‹ Loading last AI search results...' });\n\n    console.log('ðŸ“‹ Loading last match...');\n    console.log('  Paper ID:', selectedPaper.id);\n    console.log('  Textbook ID:', selectedTextbook.uploadedId);\n\n    try {\n      const response = await axios.get(\n        `http://localhost:5000/api/get-last-ai-search?paper_id=${selectedPaper.id}&textbook_id=${selectedTextbook.uploadedId}`\n      );\n      \n      console.log('  Response:', response.data);\n\n      if (response.data.success) {\n        const { search_results, total_chapters, total_questions, unmatched_count, created_at } = response.data;\n        \n        // Clear old chapter stats\n        setChapterStats([]);\n        \n        setSemanticSearchResults(search_results);\n        \n        // Format the date\n        const date = new Date(created_at);\n        const timeAgo = getTimeAgo(date);\n        \n        setMessage({\n          type: 'success',\n          text: `ðŸ“‹ Loaded previous results (${timeAgo}): ${total_chapters} chapters with ${total_questions} questions (${unmatched_count} unmatched)`\n        });\n      }\n    } catch (err) {\n      console.error('Error loading last match:', err);\n      if (err.response?.status === 404) {\n        // Clear any existing results since no match found for this combination\n        setSemanticSearchResults(null);\n        setChapterStats([]);\n        \n        setMessage({ \n          type: 'info', \n          text: `No previous results found for \"${selectedPaper.title}\" with \"${selectedTextbook.name}\". Please run \"Index & Match Questions\" first.` \n        });\n      } else {\n        setMessage({ \n          type: 'error', \n          text: `Failed to load previous results: ${err.response?.data?.error || err.message}` \n        });\n      }\n    } finally {\n      setIsSearching(false);\n    }\n  };\n\n  const getTimeAgo = (date) => {\n    const seconds = Math.floor((new Date() - date) / 1000);\n    \n    if (seconds < 60) return 'just now';\n    if (seconds < 3600) return `${Math.floor(seconds / 60)} minutes ago`;\n    if (seconds < 86400) return `${Math.floor(seconds / 3600)} hours ago`;\n    if (seconds < 604800) return `${Math.floor(seconds / 86400)} days ago`;\n    return date.toLocaleDateString();\n  };\n\n  const handleChapterSelect = (chapterData) => {\n    console.log('Selected chapter:', chapterData);\n    console.log('Available chapters in semanticSearchResults:', semanticSearchResults ? Object.keys(semanticSearchResults) : 'None');\n    \n    setSelectedChapter(chapterData);\n    \n    if (semanticSearchResults && semanticSearchResults[chapterData.name]) {\n      // Use semantic search results\n      const chapterQuestions = semanticSearchResults[chapterData.name].questions;\n      const chapterInfo = semanticSearchResults[chapterData.name].chapter;\n      \n      console.log('Found chapter questions:', chapterQuestions.length);\n      console.log('Chapter info:', chapterInfo);\n      \n      setQuestions(chapterQuestions);\n      setMessage({\n        type: 'success',\n        text: `Showing ${chapterQuestions.length} questions for: ${chapterData.name} (AI matched)`\n      });\n    } else {\n      console.warn('Chapter not found in semantic search results:', chapterData.name);\n      setMessage({\n        type: 'info',\n        text: 'Run AI Search to find questions for this chapter'\n      });\n      setQuestions([]);\n    }\n  };\n\n  const handleSolveQuestion = async (question) => {\n    setSolvingQuestion(true);\n    try {\n      const chapterContext = question.chapters && question.chapters.length > 0 \n        ? question.chapters[0].chapter_title \n        : selectedChapter?.name;\n      \n      const response = await axios.post('http://localhost:5000/api/solve-question', {\n        question_text: question.question_text,\n        question_type: question.question_type,\n        subject: selectedPaper?.subject,\n        chapter_context: chapterContext\n      });\n      \n      if (response.data.success) {\n        setSelectedSolution({\n          questionNumber: question.question_number,\n          questionText: question.question_text,\n          questionType: question.question_type,\n          solution: response.data.solution,\n          parsedSolution: response.data.parsed_solution\n        });\n        \n        // Save to Question Bank\n        try {\n          await axios.post('http://localhost:5000/api/save-solved-question', {\n            question_text: question.question_text,\n            solution: response.data.solution,\n            source: 'answer_chapterwise',\n            paper_id: selectedPaper?.id,\n            textbook_id: selectedTextbook?.uploadedId || selectedTextbook?.id,\n            chapter_name: chapterContext,\n            timestamp: new Date().toISOString()\n          });\n          console.log('âœ… Question saved to Question Bank');\n        } catch (saveErr) {\n          console.error('Failed to save to Question Bank:', saveErr);\n          // Don't show error to user, just log it\n        }\n      } else {\n        alert('Failed to solve question: ' + (response.data.error || 'Unknown error'));\n      }\n    } catch (error) {\n      console.error('Error solving question:', error);\n      alert('Error solving question: ' + (error.response?.data?.error || error.message));\n    } finally {\n      setSolvingQuestion(false);\n    }\n  };\n\n  const estimateQuestionPageNumber = (questionText, chapterData) => {\n    // Estimate specific page range within chapter based on question content\n    if (!chapterData || !chapterData.pages) {\n      return 'N/A'; // Return default if no page data\n    }\n    \n    const { pages } = chapterData;\n    const [startPage, endPage] = pages.split('-').map(p => parseInt(p.trim()));\n    const totalPages = endPage - startPage + 1;\n    \n    // Define sub-topics with their relative position in chapter (0-1)\n    const subTopicPositions = {\n      // Electricity sub-topics\n      'electric current': 0.1,\n      'potential difference': 0.2,\n      'ohm law': 0.3,\n      'resistance': 0.3,\n      'series circuit': 0.5,\n      'parallel circuit': 0.6,\n      'heating effect': 0.7,\n      'electric power': 0.8,\n      'joule law': 0.9,\n      \n      // Magnetic Effects\n      'magnetic field': 0.1,\n      'right hand rule': 0.2,\n      'electromagnet': 0.3,\n      'solenoid': 0.4,\n      'force on conductor': 0.5,\n      'electric motor': 0.6,\n      'electromagnetic induction': 0.7,\n      'generator': 0.8,\n      'fleming': 0.8,\n      \n      // Light - Reflection and Refraction\n      'law of reflection': 0.1,\n      'plane mirror': 0.15,\n      'spherical mirror': 0.2,\n      'concave mirror': 0.3,\n      'convex mirror': 0.4,\n      'mirror formula': 0.45,\n      'refraction': 0.5,\n      'refractive index': 0.55,\n      'snell law': 0.6,\n      'lens': 0.65,\n      'concave lens': 0.7,\n      'convex lens': 0.75,\n      'lens formula': 0.8,\n      'power of lens': 0.9,\n      \n      // Quadratic Equations\n      'standard form': 0.1,\n      'factorization': 0.2,\n      'completing square': 0.4,\n      'quadratic formula': 0.6,\n      'discriminant': 0.7,\n      'nature of roots': 0.8,\n      'word problem': 0.9,\n      \n      // Triangles\n      'similar triangle': 0.2,\n      'basic proportionality': 0.3,\n      'criteria for similarity': 0.4,\n      'area of similar': 0.5,\n      'pythagoras theorem': 0.6,\n      'converse of pythagoras': 0.7,\n      'triangle inequality': 0.8,\n      \n      // Coordinate Geometry\n      'distance formula': 0.2,\n      'section formula': 0.4,\n      'midpoint': 0.5,\n      'area of triangle': 0.6,\n      'collinear': 0.7,\n      'slope': 0.8,\n      \n      // Trigonometry\n      'trigonometric ratio': 0.1,\n      'sine': 0.2,\n      'cosine': 0.3,\n      'tangent': 0.4,\n      'complementary angle': 0.5,\n      'trigonometric identity': 0.6,\n      'angle of elevation': 0.7,\n      'angle of depression': 0.8,\n      'height and distance': 0.9,\n      \n      // Statistics\n      'mean': 0.2,\n      'median': 0.4,\n      'mode': 0.6,\n      'cumulative frequency': 0.7,\n      'ogive': 0.8,\n      \n      // Probability\n      'theoretical probability': 0.3,\n      'experimental probability': 0.5,\n      'sample space': 0.6,\n      'mutually exclusive': 0.8,\n      \n      // Chemistry - Acids, Bases and Salts\n      'acid': 0.1,\n      'base': 0.2,\n      'indicator': 0.3,\n      'ph scale': 0.4,\n      'neutralization': 0.5,\n      'salt': 0.6,\n      'water of crystallization': 0.8,\n      \n      // Biology - Life Processes\n      'nutrition': 0.1,\n      'autotrophic': 0.15,\n      'heterotrophic': 0.2,\n      'photosynthesis': 0.25,\n      'digestion': 0.3,\n      'respiration': 0.5,\n      'aerobic': 0.55,\n      'anaerobic': 0.6,\n      'transportation': 0.7,\n      'excretion': 0.85\n    };\n    \n    const lowerText = questionText.toLowerCase();\n    let estimatedPosition = 0.5; // Default to middle\n    let matchFound = false;\n    \n    // Find the most specific sub-topic match\n    for (const [subTopic, position] of Object.entries(subTopicPositions)) {\n      if (lowerText.includes(subTopic)) {\n        estimatedPosition = position;\n        matchFound = true;\n        break; // Use first match (most specific)\n      }\n    }\n    \n    // Calculate estimated page range (Â±2 pages from estimated position)\n    const estimatedPage = Math.round(startPage + (totalPages * estimatedPosition));\n    const rangeStart = Math.max(startPage, estimatedPage - 2);\n    const rangeEnd = Math.min(endPage, estimatedPage + 2);\n    \n    return matchFound ? `${rangeStart}-${rangeEnd}` : pages;\n  };\n\n  const handlePageClick = (pageRange) => {\n    const [startPage, endPage] = pageRange.split('-').map(p => parseInt(p.trim()));\n    setCurrentPage(startPage);\n    setTextbookPageToShow({\n      textbook: selectedTextbook,\n      chapter: selectedChapter.name,\n      pageRange: pageRange,\n      startPage: startPage,\n      endPage: endPage || startPage\n    });\n    setShowTextbookModal(true);\n  };\n\n  const handleNextPage = () => {\n    if (currentPage < textbookPageToShow.endPage) {\n      const nextPage = currentPage + 1;\n      console.log('Next page:', nextPage);\n      setPdfLoading(true);\n      setCurrentPage(nextPage);\n      setTimeout(() => setPdfLoading(false), 1000);\n    }\n  };\n\n  const handlePrevPage = () => {\n    if (currentPage > textbookPageToShow.startPage) {\n      const prevPage = currentPage - 1;\n      console.log('Previous page:', prevPage);\n      setPdfLoading(true);\n      setCurrentPage(prevPage);\n      setTimeout(() => setPdfLoading(false), 1000);\n    }\n  };\n\n  const handleCloseModal = () => {\n    setShowTextbookModal(false);\n    setTextbookPageToShow(null);\n    setCurrentPage(1);\n  };\n\n  const filterQuestionsByChapter = (questions, chapter) => {\n    // Enhanced keyword matching with scoring system for more focused results\n    const chapterKeywords = {\n      'Electricity': {\n        primary: ['current', 'voltage', 'resistance', 'ohm', 'circuit', 'electric power', 'electrical energy'],\n        secondary: ['joule', 'watt', 'ampere', 'volt', 'resistor', 'conductor', 'insulator']\n      },\n      'Magnetic Effects of Current': {\n        primary: ['magnetic field', 'electromagnet', 'solenoid', 'motor', 'generator', 'fleming'],\n        secondary: ['magnet', 'electromagnetic induction', 'armature', 'commutator']\n      },\n      'Light - Reflection and Refraction': {\n        primary: ['reflection', 'refraction', 'mirror', 'lens', 'focal length', 'image formation'],\n        secondary: ['concave', 'convex', 'ray diagram', 'optical', 'refractive index']\n      },\n      'Human Eye and Colourful World': {\n        primary: ['eye', 'retina', 'cornea', 'spectrum', 'dispersion', 'rainbow', 'prism'],\n        secondary: ['vision', 'myopia', 'hypermetropia', 'presbyopia', 'cataract']\n      },\n      'Sources of Energy': {\n        primary: ['renewable energy', 'solar energy', 'wind energy', 'fossil fuel', 'nuclear energy'],\n        secondary: ['biogas', 'hydroelectric', 'geothermal', 'tidal energy']\n      },\n      'Chemical Reactions and Equations': {\n        primary: ['chemical reaction', 'chemical equation', 'reactant', 'product', 'balanced equation'],\n        secondary: ['oxidation', 'reduction', 'decomposition', 'combination', 'displacement']\n      },\n      'Acids, Bases and Salts': {\n        primary: ['acid', 'base', 'salt', 'ph scale', 'neutralization'],\n        secondary: ['alkali', 'indicator', 'litmus', 'acidic', 'basic']\n      },\n      'Metals and Non-metals': {\n        primary: ['metal', 'non-metal', 'metalloid', 'reactivity series', 'corrosion'],\n        secondary: ['alloy', 'ore', 'extraction', 'metallic', 'ionic bond']\n      },\n      'Carbon and its Compounds': {\n        primary: ['carbon compound', 'organic compound', 'hydrocarbon', 'functional group'],\n        secondary: ['alkane', 'alkene', 'alkyne', 'alcohol', 'carboxylic acid', 'ester']\n      },\n      'Life Processes': {\n        primary: ['nutrition', 'respiration', 'transportation', 'excretion', 'photosynthesis'],\n        secondary: ['digestion', 'cellular respiration', 'transpiration', 'kidney']\n      },\n      'Control and Coordination': {\n        primary: ['nervous system', 'hormone', 'endocrine', 'reflex action', 'neuron'],\n        secondary: ['brain', 'spinal cord', 'synapse', 'receptor', 'effector']\n      },\n      'How do Organisms Reproduce': {\n        primary: ['reproduction', 'sexual reproduction', 'asexual reproduction', 'fertilization'],\n        secondary: ['gamete', 'zygote', 'fission', 'budding', 'vegetative propagation']\n      },\n      'Heredity and Evolution': {\n        primary: ['heredity', 'inheritance', 'gene', 'chromosome', 'evolution', 'natural selection'],\n        secondary: ['dna', 'darwin', 'variation', 'speciation', 'fossil']\n      },\n      'Our Environment': {\n        primary: ['ecosystem', 'food chain', 'food web', 'biodegradable', 'ozone layer'],\n        secondary: ['environment', 'pollution', 'greenhouse effect', 'decomposer']\n      },\n      'Real Numbers': {\n        primary: ['real number', 'rational number', 'irrational number', 'euclid', 'hcf', 'lcm'],\n        secondary: ['prime', 'composite', 'fundamental theorem']\n      },\n      'Polynomials': {\n        primary: ['polynomial', 'degree of polynomial', 'zero of polynomial', 'coefficient'],\n        secondary: ['quadratic polynomial', 'cubic polynomial', 'factorization']\n      },\n      'Pair of Linear Equations in Two Variables': {\n        primary: ['linear equation', 'simultaneous equation', 'substitution method', 'elimination method'],\n        secondary: ['cross multiplication', 'graphical method', 'consistent', 'inconsistent']\n      },\n      'Quadratic Equations': {\n        primary: ['quadratic equation', 'discriminant', 'roots of equation', 'quadratic formula'],\n        secondary: ['xÂ²', 'x^2', 'factorization', 'completing square']\n      },\n      'Arithmetic Progressions': {\n        primary: ['arithmetic progression', 'common difference', 'nth term', 'sum of ap'],\n        secondary: ['ap', 'arithmetic sequence', 'series']\n      },\n      'Triangles': {\n        primary: ['similar triangle', 'congruent triangle', 'pythagoras theorem', 'triangle theorem'],\n        secondary: ['area of triangle', 'perimeter', 'altitude', 'median']\n      },\n      'Coordinate Geometry': {\n        primary: ['coordinate', 'distance formula', 'section formula', 'midpoint formula'],\n        secondary: ['slope', 'x-axis', 'y-axis', 'cartesian plane']\n      },\n      'Introduction to Trigonometry': {\n        primary: ['trigonometry', 'trigonometric ratio', 'sine', 'cosine', 'tangent'],\n        secondary: ['sin', 'cos', 'tan', 'angle', 'Î¸', 'theta']\n      },\n      'Some Applications of Trigonometry': {\n        primary: ['height and distance', 'angle of elevation', 'angle of depression', 'line of sight'],\n        secondary: ['trigonometric application', 'tower', 'building height']\n      },\n      'Circles': {\n        primary: ['circle', 'tangent to circle', 'chord', 'secant', 'circle theorem'],\n        secondary: ['radius', 'diameter', 'arc', 'segment']\n      },\n      'Areas Related to Circles': {\n        primary: ['area of circle', 'sector', 'segment of circle', 'circumference'],\n        secondary: ['Ï€', 'pi', 'circular region', 'annulus']\n      },\n      'Surface Areas and Volumes': {\n        primary: ['surface area', 'volume', 'total surface area', 'curved surface area'],\n        secondary: ['cube', 'cuboid', 'cylinder', 'cone', 'sphere', 'hemisphere']\n      },\n      'Statistics': {\n        primary: ['mean', 'median', 'mode', 'frequency distribution', 'cumulative frequency'],\n        secondary: ['data', 'class interval', 'grouped data', 'ogive']\n      },\n      'Probability': {\n        primary: ['probability', 'theoretical probability', 'experimental probability', 'random experiment'],\n        secondary: ['event', 'outcome', 'sample space', 'certain', 'impossible']\n      }\n    };\n\n    const chapterData = chapterKeywords[chapter];\n    if (!chapterData) {\n      // Fallback to simple keyword matching\n      const keywords = chapter.toLowerCase().split(' ');\n      return questions.filter(q => {\n        const questionText = q.question_text.toLowerCase();\n        return keywords.some(keyword => questionText.includes(keyword));\n      });\n    }\n\n    // Score-based filtering for more focused results\n    return questions.filter(q => {\n      const questionText = q.question_text.toLowerCase();\n      let score = 0;\n\n      // Primary keywords are worth 3 points\n      chapterData.primary.forEach(keyword => {\n        if (questionText.includes(keyword.toLowerCase())) {\n          score += 3;\n        }\n      });\n\n      // Secondary keywords are worth 1 point\n      chapterData.secondary.forEach(keyword => {\n        if (questionText.includes(keyword.toLowerCase())) {\n          score += 1;\n        }\n      });\n\n      // Require minimum score of 2 for more focused results\n      return score >= 2;\n    });\n  };\n\n  return (\n    <div className=\"chapter-questions\">\n      <div className=\"chapter-header\">\n        <h2>ðŸ“– Answer Chapterwise</h2>\n        <p>Select a question paper, textbook, and chapter to view related questions</p>\n      </div>\n\n      {message.text && (\n        <div className={`message ${message.type}`}>\n          {message.text}\n        </div>\n      )}\n\n      <div className=\"chapter-content\">\n        {/* Side by Side Selection Tables */}\n        <div className=\"selection-grid\">\n          {/* Textbook Selection - Left Side */}\n          <div className=\"selection-section textbook-selection-table\">\n            <h3>ðŸ“š Step 1: Select Textbook</h3>\n            {textbooks.length === 0 ? (\n              <p className=\"no-data\">No textbooks available. Please upload a textbook first.</p>\n            ) : (\n              <div className=\"selection-table-container\">\n                <table className=\"selection-table\">\n                  <thead>\n                    <tr>\n                      <th style={{width: '50px'}}>Select</th>\n                      <th>Textbook Name</th>\n                      <th>Subject</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {textbooks.map((textbook, index) => (\n                      <tr\n                        key={index}\n                        className={`selection-row ${selectedTextbook?.name === textbook.name ? 'selected' : ''} ${!textbook.uploadedId ? 'disabled' : ''}`}\n                        onClick={() => textbook.uploadedId && handleTextbookSelect(textbook)}\n                      >\n                        <td className=\"checkbox-cell\">\n                          <input\n                            type=\"checkbox\"\n                            checked={selectedTextbook?.name === textbook.name}\n                            onChange={() => textbook.uploadedId && handleTextbookSelect(textbook)}\n                            disabled={!textbook.uploadedId}\n                            onClick={(e) => e.stopPropagation()}\n                          />\n                        </td>\n                        <td className=\"name-cell\">\n                          <div className=\"cell-content\">\n                            <span className=\"icon\">{textbook.uploadedId ? 'ðŸ“•' : 'ðŸ“˜'}</span>\n                            <span className=\"text\">{textbook.name}</span>\n                          </div>\n                        </td>\n                        <td className=\"subject-cell\">\n                          <span className=\"subject-badge\">{textbook.subject}</span>\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            )}\n          </div>\n\n          {/* Paper Selection - Right Side */}\n          <div className=\"selection-section paper-selection-table\">\n            <h3>ðŸ“„ Step 2: Select Question Paper</h3>\n            {papers.length === 0 ? (\n              <p className=\"no-data\">No question papers uploaded yet</p>\n            ) : (\n              <div className=\"selection-table-container\">\n                <table className=\"selection-table\">\n                  <thead>\n                    <tr>\n                      <th style={{width: '50px'}}>Select</th>\n                      <th>Paper Title</th>\n                      <th>Subject</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {papers.map(paper => (\n                      <tr\n                        key={paper.id}\n                        className={`selection-row ${selectedPaper?.id === paper.id ? 'selected' : ''}`}\n                        onClick={() => handlePaperSelect(paper)}\n                      >\n                        <td className=\"checkbox-cell\">\n                          <input\n                            type=\"checkbox\"\n                            checked={selectedPaper?.id === paper.id}\n                            onChange={() => handlePaperSelect(paper)}\n                            onClick={(e) => e.stopPropagation()}\n                          />\n                        </td>\n                        <td className=\"name-cell\">\n                          <div className=\"cell-content\">\n                            <span className=\"icon\">ðŸ“</span>\n                            <span className=\"text\">{paper.title}</span>\n                          </div>\n                        </td>\n                        <td className=\"subject-cell\">\n                          <span className=\"subject-badge\">{paper.subject}</span>\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* AI Semantic Search Section */}\n        {selectedPaper && selectedTextbook && (\n          <div className=\"semantic-search-section\">\n            <div className=\"search-buttons\">\n              <button \n                className=\"load-last-btn\"\n                onClick={handleLoadLastMatch}\n                disabled={isSearching || !selectedTextbook.uploadedId}\n                title=\"Load previously saved AI search results (instant)\"\n              >\n                {isSearching ? (\n                  <>\n                    <span className=\"spinner-small\"></span>\n                    Loading...\n                  </>\n                ) : (\n                  <>\n                    ðŸ“‹ Show Last Match\n                  </>\n                )}\n              </button>\n              <button \n                className=\"index-and-match-btn\"\n                onClick={handleIndexAndMatch}\n                disabled={isSearching || !selectedTextbook.uploadedId || !selectedPaper}\n                title=\"Index textbook (if needed) and match questions with AI\"\n              >\n                {isSearching ? (\n                  <>\n                    <span className=\"spinner-small\"></span>\n                    Processing...\n                  </>\n                ) : (\n                  <>\n                    ðŸš€ Index & Match Questions\n                  </>\n                )}\n              </button>\n            </div>\n          </div>\n        )}\n\n        {/* AI Search Results - Chapter List */}\n        {semanticSearchResults && Object.keys(semanticSearchResults).length > 0 && (\n          <div className=\"chapter-table-section ai-results\">\n            <h3>ðŸ¤– AI Search Results - Chapters with Questions</h3>\n            <div className=\"chapter-table-container\">\n              <table className=\"chapter-table\">\n                <thead>\n                  <tr>\n                    <th>#</th>\n                    <th>Chapter Name</th>\n                    <th>Pages</th>\n                    <th>Questions</th>\n                    <th>Action</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {Object.entries(semanticSearchResults).map(([chapterName, data], index) => {\n                    const avgConfidence = data.questions.reduce((sum, q) => {\n                      return sum + (q.chapters && q.chapters[0] ? q.chapters[0].similarity_score : 0);\n                    }, 0) / data.questions.length;\n                    \n                    const isUnmatched = chapterName === 'Unmatched Questions';\n                    \n                    return (\n                    <tr \n                      key={index}\n                      className={`${selectedChapter?.name === chapterName ? 'selected-row' : ''} ${isUnmatched ? 'unmatched-row' : ''}`}\n                    >\n                      <td className=\"chapter-num\">\n                        {isUnmatched ? 'âš ï¸' : (data.chapter.chapter_number || (index + 1))}\n                      </td>\n                      <td className=\"chapter-name-cell\">\n                        <strong>{chapterName}</strong>\n                        {avgConfidence > 0 && !isUnmatched && (\n                          <div className=\"confidence-badge\" title={`Average AI confidence: ${avgConfidence.toFixed(1)}%`}>\n                            ðŸŽ¯ {avgConfidence.toFixed(0)}%\n                          </div>\n                        )}\n                        {isUnmatched && (\n                          <div className=\"unmatched-badge\" title=\"Questions that could not be matched to any chapter\">\n                            âš ï¸ Needs Review\n                          </div>\n                        )}\n                      </td>\n                      <td className=\"pages-cell\">\n                        {isUnmatched ? 'N/A' : `${data.chapter.page_start}-${data.chapter.page_end}`}\n                      </td>\n                      <td className=\"count-cell\">\n                        <span className={`question-count ${isUnmatched ? 'unmatched-count' : 'has-questions'}`}>\n                          {data.questions.length}\n                        </span>\n                      </td>\n                      <td className=\"action-cell\">\n                        <button\n                          className={`view-btn ${isUnmatched ? 'unmatched-btn' : ''}`}\n                          onClick={() => handleChapterSelect({ name: chapterName })}\n                        >\n                          View Questions\n                        </button>\n                      </td>\n                    </tr>\n                    );\n                  })}\n                </tbody>\n              </table>\n            </div>\n            <div className=\"table-summary\">\n              <p>\n                <strong>Total Chapters:</strong> {Object.keys(semanticSearchResults).length} | \n                <strong> Total Questions:</strong> {Object.values(semanticSearchResults).reduce((sum, data) => sum + data.questions.length, 0)}\n              </p>\n            </div>\n          </div>\n        )}\n\n        {/* Questions Display */}\n        {selectedChapter && (\n          <div className=\"questions-display\">\n            <div className=\"questions-header-info\">\n              <h3>â“ Questions from: {selectedChapter.name}</h3>\n              <div className=\"chapter-meta\">\n                <span className=\"meta-item\">ðŸ“– <strong>Textbook:</strong> {selectedTextbook.name}</span>\n                <span className=\"meta-item\">ðŸ“„ <strong>Pages:</strong> {selectedChapter.pages}</span>\n                <span className=\"meta-item\">ðŸ“ <strong>Paper:</strong> {selectedPaper.title}</span>\n              </div>\n            </div>\n            \n            {loading ? (\n              <div className=\"loading\">\n                <div className=\"spinner\"></div>\n                <p>Loading questions...</p>\n              </div>\n            ) : questions.length === 0 ? (\n              <div className=\"no-questions\">\n                <p>No questions found for this chapter</p>\n                <p className=\"hint\">Try selecting a different chapter</p>\n              </div>\n            ) : (\n              <div className=\"questions-list\">\n                {questions.map((q, index) => {\n                  // Use AI chapter data if available, otherwise use selected chapter\n                  let pageInfo = 'N/A';\n                  if (q.chapters && q.chapters.length > 0) {\n                    // AI search result - use first matched chapter\n                    const aiChapter = q.chapters[0];\n                    pageInfo = `${aiChapter.page_start}-${aiChapter.page_end}`;\n                  } else if (selectedChapter && selectedChapter.pages) {\n                    // Regular chapter selection - estimate pages\n                    pageInfo = estimateQuestionPageNumber(q.question_text, selectedChapter);\n                  }\n                  \n                  return (\n                  <div key={q.id} className=\"question-item\">\n                    <div className=\"question-header\">\n                      <span className=\"question-number\">Q{q.question_number}</span>\n                      <span \n                        className=\"chapter-page-badge clickable\"\n                        onClick={() => handlePageClick(pageInfo)}\n                        title=\"Click to view textbook pages\"\n                      >\n                        ðŸ“– Pages: {pageInfo}\n                      </span>\n                      {q.question_type && (\n                        <span className={`question-type ${q.question_type}`}>\n                          {q.question_type.toUpperCase()}\n                        </span>\n                      )}\n                      {q.marks && (\n                        <span className=\"question-marks\">{q.marks} marks</span>\n                      )}\n                      {q.has_math && (\n                        <span className=\"math-badge\">ðŸ“ Math</span>\n                      )}\n                      {(() => {\n                        // Always show debug info for has_diagram\n                        if (q.has_diagram) {\n                          console.log('Question has diagram:', {\n                            questionNumber: q.question_number,\n                            has_diagram: q.has_diagram,\n                            diagram_files: q.diagram_files,\n                            diagram_files_type: typeof q.diagram_files\n                          });\n                        }\n                        \n                        if (!q.has_diagram) return null;\n                        \n                        // Parse diagram_files if it's a string\n                        let diagramFiles = q.diagram_files;\n                        if (typeof diagramFiles === 'string') {\n                          try {\n                            diagramFiles = JSON.parse(diagramFiles);\n                          } catch (e) {\n                            console.error('Failed to parse diagram_files:', e);\n                            diagramFiles = [];\n                          }\n                        }\n                        \n                        // Ensure it's an array\n                        if (!Array.isArray(diagramFiles)) {\n                          diagramFiles = diagramFiles ? [diagramFiles] : [];\n                        }\n                        \n                        console.log('Processed diagram files:', diagramFiles);\n                        \n                        if (diagramFiles && diagramFiles.length > 0) {\n                          console.log('Rendering CLICKABLE diagram badge');\n                          return (\n                            <button \n                              type=\"button\"\n                              className=\"diagram-badge clickable\"\n                              onClick={(e) => {\n                                e.preventDefault();\n                                e.stopPropagation();\n                                console.log('ðŸŽ¯ DIAGRAM BUTTON CLICKED!', diagramFiles);\n                                setSelectedDiagram({\n                                  questionNumber: q.question_number,\n                                  diagrams: diagramFiles\n                                });\n                              }}\n                              title=\"Click to view diagram\"\n                              style={{\n                                cursor: 'pointer',\n                                pointerEvents: 'auto'\n                              }}\n                            >\n                              ðŸ“Š Diagram\n                            </button>\n                          );\n                        } else {\n                          console.log('Rendering STATIC diagram badge (no files)');\n                          return <span className=\"diagram-badge\">ðŸ“Š Diagram</span>;\n                        }\n                      })()}\n                      {(() => {\n                        // Check if question has chapter match reasoning\n                        const hasChapterReasoning = q.chapters && q.chapters.length > 0 && q.chapters[0].llm_reasoning;\n                        \n                        if (hasChapterReasoning) {\n                          return (\n                            <button \n                              className=\"reasoning-btn\"\n                              onClick={() => setSelectedReasoning({\n                                questionNumber: q.question_number,\n                                reasoning: q.chapters[0].llm_reasoning,\n                                chapterTitle: q.chapters[0].chapter_title,\n                                confidence: q.chapters[0].similarity_score,\n                                pageRange: `${q.chapters[0].page_start}-${q.chapters[0].page_end}`\n                              })}\n                              title=\"View AI chapter matching reasoning\"\n                            >\n                              ðŸ§  Why This Chapter?\n                            </button>\n                          );\n                        }\n                        \n                        // Fallback: show parsed data if available\n                        let parsedData = q.parsed_data;\n                        if (typeof parsedData === 'string') {\n                          try {\n                            parsedData = JSON.parse(parsedData);\n                          } catch (e) {\n                            parsedData = {};\n                          }\n                        }\n                        return parsedData && Object.keys(parsedData).length > 0 && (\n                          <button \n                            className=\"reasoning-btn\"\n                            onClick={() => setSelectedReasoning({\n                              questionNumber: q.question_number,\n                              reasoning: 'No chapter matching reasoning available',\n                              llmResponse: JSON.stringify(parsedData, null, 2)\n                            })}\n                            title=\"View AI parsed data\"\n                          >\n                            ðŸ§  AI Data\n                          </button>\n                        );\n                      })()}\n                      <button \n                        className=\"solve-btn\"\n                        onClick={() => handleSolveQuestion(q)}\n                        disabled={solvingQuestion}\n                        title=\"Get detailed step-by-step solution\"\n                      >\n                        {solvingQuestion ? 'â³ Solving...' : 'âœ¨ Solve Question'}\n                      </button>\n                    </div>\n                    <div className=\"question-text\">\n                      {q.question_text}\n                    </div>\n                    {(() => {\n                      // Parse sub_parts if it's a string\n                      let subParts = q.sub_parts;\n                      if (typeof subParts === 'string') {\n                        try {\n                          subParts = JSON.parse(subParts);\n                        } catch (e) {\n                          subParts = [];\n                        }\n                      }\n                      return subParts && Array.isArray(subParts) && subParts.length > 0 && (\n                        <div className=\"sub-parts\">\n                          <strong>Sub-parts:</strong> {subParts.join(', ')}\n                        </div>\n                      );\n                    })()}\n                  </div>\n                  );\n                })}\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n\n      {/* Textbook Page Modal */}\n      {showTextbookModal && textbookPageToShow && (\n        <div className=\"textbook-modal-overlay\" onClick={handleCloseModal}>\n          <div className=\"textbook-modal-content\" onClick={(e) => e.stopPropagation()}>\n            <div className=\"textbook-modal-header\">\n              <div className=\"modal-title-section\">\n                <h2>ðŸ“– {textbookPageToShow.textbook.name}</h2>\n                <p className=\"modal-subtitle\">\n                  Chapter: {textbookPageToShow.chapter} | Pages: {textbookPageToShow.pageRange}\n                </p>\n              </div>\n              <button \n                className=\"modal-close-btn\"\n                onClick={handleCloseModal}\n              >\n                âœ•\n              </button>\n            </div>\n            \n            <div className=\"textbook-modal-body\">\n              <div className=\"textbook-viewer\">\n                <div className=\"page-info\">\n                  <span className=\"current-page-indicator\">\n                    ðŸ“„ Page {currentPage} of {textbookPageToShow.pageRange}\n                  </span>\n                </div>\n                \n                {/* PDF Viewer - Using uploaded textbook */}\n                {textbookPageToShow.textbook.uploadedFile ? (\n                  <div className=\"pdf-embed-container\">\n                    {pdfLoading && (\n                      <div className=\"pdf-loading-overlay\">\n                        <div className=\"spinner\"></div>\n                        <p>Loading page {currentPage}...</p>\n                      </div>\n                    )}\n                    <iframe\n                      key={`pdf-${currentPage}`}\n                      src={`http://localhost:5000/api/textbook-pdf/${textbookPageToShow.textbook.uploadedId}#page=${currentPage}&zoom=page-fit`}\n                      title={`Textbook Page ${currentPage}`}\n                      className=\"textbook-pdf-iframe\"\n                      frameBorder=\"0\"\n                      allow=\"fullscreen\"\n                      onLoad={() => setPdfLoading(false)}\n                    />\n                  </div>\n                ) : (\n                  <div className=\"no-textbook-message\">\n                    <div className=\"external-icon\">ðŸ“š</div>\n                    <h3>No Textbook Uploaded</h3>\n                    <p className=\"viewer-description\">\n                      Please upload a textbook file for {textbookPageToShow.textbook.name} to view pages.\n                    </p>\n                    <div className=\"link-info\">\n                      <p><strong>Textbook:</strong> {textbookPageToShow.textbook.name}</p>\n                      <p><strong>Chapter:</strong> {textbookPageToShow.chapter}</p>\n                      <p><strong>Pages:</strong> {textbookPageToShow.pageRange}</p>\n                      <p className=\"upload-hint\">Go to \"Upload Papers\" menu to upload textbook PDFs</p>\n                    </div>\n                  </div>\n                )}\n\n                {/* Page Navigation */}\n                <div className=\"page-navigation\">\n                  <button \n                    className=\"nav-btn\"\n                    onClick={handlePrevPage}\n                    disabled={currentPage <= textbookPageToShow.startPage}\n                  >\n                    â† Previous\n                  </button>\n                  <span className=\"page-display\">\n                    Page {currentPage}\n                  </span>\n                  <button \n                    className=\"nav-btn\"\n                    onClick={handleNextPage}\n                    disabled={currentPage >= textbookPageToShow.endPage}\n                  >\n                    Next â†’\n                  </button>\n                </div>\n              </div>\n            </div>\n            \n            <div className=\"textbook-modal-footer\">\n              <div className=\"footer-info\">\n                <span className=\"page-count\">\n                  {textbookPageToShow.endPage - textbookPageToShow.startPage + 1} pages in range\n                </span>\n              </div>\n              <button \n                className=\"close-modal-btn\"\n                onClick={handleCloseModal}\n              >\n                Close\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Reasoning Modal */}\n      {selectedReasoning && (\n        <div className=\"reasoning-modal\" onClick={() => setSelectedReasoning(null)}>\n          <div className=\"reasoning-modal-content\" onClick={(e) => e.stopPropagation()}>\n            <div className=\"reasoning-modal-header\">\n              <h3>ðŸ§  Chapter Matching Analysis - Q{selectedReasoning.questionNumber}</h3>\n              <button className=\"close-reasoning-btn\" onClick={() => setSelectedReasoning(null)}>âœ•</button>\n            </div>\n            \n            <div className=\"reasoning-modal-body\">\n              {selectedReasoning.chapterTitle && (\n                <div className=\"chapter-match-info\">\n                  <div className=\"match-detail\">\n                    <span className=\"match-label\">ðŸ“š Matched Chapter:</span>\n                    <span className=\"match-value\">{selectedReasoning.chapterTitle}</span>\n                  </div>\n                  <div className=\"match-detail\">\n                    <span className=\"match-label\">ðŸ“„ Pages:</span>\n                    <span className=\"match-value\">{selectedReasoning.pageRange}</span>\n                  </div>\n                  {selectedReasoning.confidence && (\n                    <div className=\"match-detail\">\n                      <span className=\"match-label\">ðŸŽ¯ Confidence:</span>\n                      <span className=\"match-value\">{selectedReasoning.confidence}%</span>\n                    </div>\n                  )}\n                </div>\n              )}\n              \n              <div className=\"reasoning-section\">\n                <h4>ðŸ’­ AI Reasoning:</h4>\n                <div className=\"reasoning-content\">\n                  {selectedReasoning.reasoning}\n                </div>\n              </div>\n              \n              {selectedReasoning.llmResponse && (\n                <div className=\"llm-response-section\">\n                  <h4>ðŸ¤– Technical Details (JSON):</h4>\n                  <div className=\"llm-response-content\">\n                    <pre>{selectedReasoning.llmResponse}</pre>\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Solution Modal */}\n      {selectedSolution && (\n        <div className=\"solution-modal\" onClick={() => setSelectedSolution(null)}>\n          <div className=\"solution-modal-content\" onClick={(e) => e.stopPropagation()}>\n            <div className=\"solution-modal-header\">\n              <div>\n                <h3>âœ¨ Step-by-Step Solution - Q{selectedSolution.questionNumber}</h3>\n                <span className=\"solution-type-badge\">{selectedSolution.questionType}</span>\n              </div>\n              <button className=\"close-solution-btn\" onClick={() => setSelectedSolution(null)}>âœ•</button>\n            </div>\n            \n            <div className=\"solution-modal-body\">\n              {/* Question Display */}\n              <div className=\"solution-question-box\">\n                <h4>ðŸ“ Question:</h4>\n                <p>{selectedSolution.questionText}</p>\n              </div>\n\n              {/* Full Solution */}\n              <div className=\"solution-content\">\n                {(() => {\n                  const lines = selectedSolution.solution.split('\\n');\n                  let inDiagram = false;\n                  let diagramLines = [];\n                  let lastWasEmpty = false;\n                  let lastWasSection = false;\n                  let currentSection = null;\n                  const elements = [];\n                  \n                  lines.forEach((line, idx) => {\n                    // Detect ASCII art diagram patterns (box drawing characters)\n                    const isAsciiArt = line.match(/^[\\s]*[\\+\\-\\|\\/\\\\<>]+[\\s\\+\\-\\|\\/\\\\<>]*$/) || \n                                      line.match(/^[\\s]*[\\+\\-\\|]{3,}/) ||\n                                      line.match(/[\\+\\-]{5,}/) ||\n                                      (line.includes('|') && line.includes('+'));\n                    \n                    // Detect diagram start/end\n                    if (line.match(/^\\*\\*Diagram/i) || line.includes('```') || (!inDiagram && isAsciiArt)) {\n                      if (!inDiagram) {\n                        // Starting a diagram\n                        inDiagram = true;\n                        if (isAsciiArt) {\n                          diagramLines.push(line);\n                        }\n                      } else {\n                        // Ending a diagram\n                        if (line.includes('```') || line.match(/^\\*\\*Diagram/i)) {\n                          inDiagram = false;\n                        } else if (isAsciiArt) {\n                          diagramLines.push(line);\n                        } else {\n                          // End of ASCII art\n                          inDiagram = false;\n                        }\n                        \n                        if (!inDiagram && diagramLines.length > 0) {\n                          const diagram = diagramLines.join('\\n');\n                          diagramLines = [];\n                          elements.push(<pre key={idx} className=\"solution-diagram\">{diagram}</pre>);\n                          lastWasEmpty = false;\n                          lastWasSection = true;\n                        }\n                      }\n                      return;\n                    }\n                    \n                    // Collect diagram lines\n                    if (inDiagram) {\n                      diagramLines.push(line);\n                      return;\n                    }\n                    \n                    // Highlight section headers (bold text with **)\n                    if (line.match(/^\\*\\*.*\\*\\*:?$/)) {\n                      const sectionName = line.replace(/\\*\\*/g, '').replace(/:/g, '').trim().toLowerCase();\n                      currentSection = sectionName;\n                      elements.push(<h4 key={idx} className=\"solution-section-header\">{line.replace(/\\*\\*/g, '').replace(/:/g, '')}</h4>);\n                      lastWasEmpty = false;\n                      lastWasSection = true;\n                      return;\n                    }\n                    \n                    // Highlight final answer\n                    if (line.match(/FINAL ANSWER:/i)) {\n                      elements.push(\n                        <div key={idx} className=\"final-answer-box\">\n                          <div className=\"final-answer-icon\">ðŸŽ¯</div>\n                          <div className=\"final-answer-text\" dangerouslySetInnerHTML={{\n                            __html: line.replace(/FINAL ANSWER:/i, '').trim()\n                          }}></div>\n                        </div>\n                      );\n                      lastWasEmpty = false;\n                      lastWasSection = true;\n                      return;\n                    }\n                    \n                    // Highlight step numbers\n                    if (line.match(/^(Step \\d+:|^\\d+\\.)/)) {\n                      elements.push(\n                        <div key={idx} className=\"solution-step\" dangerouslySetInnerHTML={{\n                          __html: line\n                        }}></div>\n                      );\n                      lastWasEmpty = false;\n                      lastWasSection = false;\n                      return;\n                    }\n                    \n                    // Handle empty lines - only add one between sections\n                    if (!line.trim()) {\n                      // Don't add spacers within compact sections (given, find, formula)\n                      const compactSections = ['given', 'find', 'formula', 'concept', 'formula/concept'];\n                      const isCompactSection = compactSections.some(s => currentSection && currentSection.includes(s));\n                      \n                      if (!lastWasEmpty && lastWasSection && !isCompactSection) {\n                        elements.push(<div key={idx} className=\"section-spacer\"></div>);\n                        lastWasEmpty = true;\n                      }\n                      return;\n                    }\n                    \n                    // Format mathematical/scientific expressions\n                    const formatExpression = (text) => {\n                      return text\n                        // Preserve existing HTML entities\n                        .replace(/&/g, '&amp;')\n                        .replace(/</g, '&lt;')\n                        .replace(/>/g, '&gt;')\n                        // Keep special characters as-is (they're already Unicode)\n                        .replace(/\\*\\*(.+?)\\*\\*/g, '<strong>$1</strong>') // Bold\n                        .replace(/\\*(.+?)\\*/g, '<em>$1</em>'); // Italic\n                    };\n                    \n                    // Regular text with formatting\n                    const compactSections = ['given', 'find', 'formula', 'concept', 'formula/concept'];\n                    const isCompactSection = compactSections.some(s => currentSection && currentSection.includes(s));\n                    const textClass = isCompactSection ? 'solution-text compact' : 'solution-text';\n                    \n                    elements.push(\n                      <p key={idx} className={textClass} dangerouslySetInnerHTML={{\n                        __html: formatExpression(line)\n                      }}></p>\n                    );\n                    lastWasEmpty = false;\n                    lastWasSection = false;\n                  });\n                  \n                  return elements;\n                })()}\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Diagram Modal */}\n      {selectedDiagram && (\n        <div className=\"diagram-modal-overlay\" onClick={() => setSelectedDiagram(null)}>\n          <div className=\"diagram-modal-content\" onClick={(e) => e.stopPropagation()}>\n            <div className=\"diagram-modal-header\">\n              <h3>ðŸ“Š Diagram - Q{selectedDiagram.questionNumber}</h3>\n              <button className=\"close-diagram-btn\" onClick={() => setSelectedDiagram(null)}>âœ•</button>\n            </div>\n            <div className=\"diagram-modal-body\">\n              {selectedDiagram.diagrams.map((diagram, idx) => (\n                <div key={idx} className=\"diagram-container\">\n                  <img \n                    src={`http://localhost:5000${diagram}`} \n                    alt={`Diagram ${idx + 1}`}\n                    className=\"diagram-image\"\n                    onError={(e) => {\n                      e.target.style.display = 'none';\n                      e.target.nextSibling.style.display = 'block';\n                    }}\n                  />\n                  <div className=\"diagram-error\" style={{display: 'none'}}>\n                    âš ï¸ Failed to load diagram\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ChapterQuestions;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAClD,OAAOC,KAAK,MAAM,OAAO;AACzB,OAAO,wBAAwB;AAAC,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AAEhC,MAAMC,gBAAgB,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAC7B,MAAM,CAACC,MAAM,EAAEC,SAAS,CAAC,GAAGV,QAAQ,CAAC,EAAE,CAAC;EACxC,MAAM,CAACW,SAAS,EAAEC,YAAY,CAAC,GAAGZ,QAAQ,CAAC,EAAE,CAAC;EAC9C,MAAM,CAACa,aAAa,EAAEC,gBAAgB,CAAC,GAAGd,QAAQ,CAAC,IAAI,CAAC;EACxD,MAAM,CAACe,gBAAgB,EAAEC,mBAAmB,CAAC,GAAGhB,QAAQ,CAAC,IAAI,CAAC;EAC9D,MAAM,CAACiB,QAAQ,EAAEC,WAAW,CAAC,GAAGlB,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM,CAACmB,YAAY,EAAEC,eAAe,CAAC,GAAGpB,QAAQ,CAAC,EAAE,CAAC;EACpD,MAAM,CAACqB,eAAe,EAAEC,kBAAkB,CAAC,GAAGtB,QAAQ,CAAC,IAAI,CAAC;EAC5D,MAAM,CAACuB,SAAS,EAAEC,YAAY,CAAC,GAAGxB,QAAQ,CAAC,EAAE,CAAC;EAC9C,MAAM,CAACyB,OAAO,EAAEC,UAAU,CAAC,GAAG1B,QAAQ,CAAC,KAAK,CAAC;EAC7C,MAAM,CAAC2B,OAAO,EAAEC,UAAU,CAAC,GAAG5B,QAAQ,CAAC;IAAE6B,IAAI,EAAE,EAAE;IAAEC,IAAI,EAAE;EAAG,CAAC,CAAC;EAC9D,MAAM,CAACC,iBAAiB,EAAEC,oBAAoB,CAAC,GAAGhC,QAAQ,CAAC,KAAK,CAAC;EACjE,MAAM,CAACiC,kBAAkB,EAAEC,qBAAqB,CAAC,GAAGlC,QAAQ,CAAC,IAAI,CAAC;EAClE,MAAM,CAACmC,WAAW,EAAEC,cAAc,CAAC,GAAGpC,QAAQ,CAAC,CAAC,CAAC;EACjD,MAAM,CAACqC,UAAU,EAAEC,aAAa,CAAC,GAAGtC,QAAQ,CAAC,KAAK,CAAC;EACnD,MAAM,CAACuC,qBAAqB,EAAEC,wBAAwB,CAAC,GAAGxC,QAAQ,CAAC,IAAI,CAAC;EACxE,MAAM,CAACyC,WAAW,EAAEC,cAAc,CAAC,GAAG1C,QAAQ,CAAC,KAAK,CAAC;EACrD,MAAM,CAAC2C,iBAAiB,EAAEC,oBAAoB,CAAC,GAAG5C,QAAQ,CAAC,IAAI,CAAC;EAChE,MAAM,CAAC6C,gBAAgB,EAAEC,mBAAmB,CAAC,GAAG9C,QAAQ,CAAC,IAAI,CAAC;EAC9D,MAAM,CAAC+C,eAAe,EAAEC,kBAAkB,CAAC,GAAGhD,QAAQ,CAAC,KAAK,CAAC;EAC7D,MAAM,CAACiD,eAAe,EAAEC,kBAAkB,CAAC,GAAGlD,QAAQ,CAAC,IAAI,CAAC;;EAE5D;EACA,MAAMmD,gBAAgB,GAAG;IACvB,SAAS,EAAE,CACT;MACEC,IAAI,EAAE,wBAAwB;MAC9BC,MAAM,EAAE,+CAA+C;MACvDC,WAAW,EAAE,6CAA6C;MAC1DC,aAAa,EAAE,mCAAmC;MAClDtC,QAAQ,EAAE,CACR;QAAEmC,IAAI,EAAE,aAAa;QAAEI,KAAK,EAAE;MAAO,CAAC,EACtC;QAAEJ,IAAI,EAAE,6BAA6B;QAAEI,KAAK,EAAE;MAAQ,CAAC,EACvD;QAAEJ,IAAI,EAAE,mCAAmC;QAAEI,KAAK,EAAE;MAAQ,CAAC,EAC7D;QAAEJ,IAAI,EAAE,+BAA+B;QAAEI,KAAK,EAAE;MAAQ,CAAC,EACzD;QAAEJ,IAAI,EAAE,mBAAmB;QAAEI,KAAK,EAAE;MAAS,CAAC;IAElD,CAAC,CACF;IACD,WAAW,EAAE,CACX;MACEJ,IAAI,EAAE,0BAA0B;MAChCC,MAAM,EAAE,+CAA+C;MACvDC,WAAW,EAAE,6CAA6C;MAC1DC,aAAa,EAAE,qCAAqC;MACpDtC,QAAQ,EAAE,CACR;QAAEmC,IAAI,EAAE,kCAAkC;QAAEI,KAAK,EAAE;MAAO,CAAC,EAC3D;QAAEJ,IAAI,EAAE,wBAAwB;QAAEI,KAAK,EAAE;MAAQ,CAAC,EAClD;QAAEJ,IAAI,EAAE,uBAAuB;QAAEI,KAAK,EAAE;MAAQ,CAAC,EACjD;QAAEJ,IAAI,EAAE,0BAA0B;QAAEI,KAAK,EAAE;MAAQ,CAAC,EACpD;QAAEJ,IAAI,EAAE,qCAAqC;QAAEI,KAAK,EAAE;MAAQ,CAAC;IAEnE,CAAC,CACF;IACD,SAAS,EAAE,CACT;MACEJ,IAAI,EAAE,wBAAwB;MAC9BC,MAAM,EAAE,+CAA+C;MACvDC,WAAW,EAAE,6CAA6C;MAC1DC,aAAa,EAAE,mCAAmC;MAClDtC,QAAQ,EAAE,CACR;QAAEmC,IAAI,EAAE,gBAAgB;QAAEI,KAAK,EAAE;MAAO,CAAC,EACzC;QAAEJ,IAAI,EAAE,0BAA0B;QAAEI,KAAK,EAAE;MAAQ,CAAC,EACpD;QAAEJ,IAAI,EAAE,4BAA4B;QAAEI,KAAK,EAAE;MAAQ,CAAC,EACtD;QAAEJ,IAAI,EAAE,wBAAwB;QAAEI,KAAK,EAAE;MAAQ,CAAC,EAClD;QAAEJ,IAAI,EAAE,iBAAiB;QAAEI,KAAK,EAAE;MAAS,CAAC;IAEhD,CAAC,CACF;IACD,aAAa,EAAE,CACb;MACEJ,IAAI,EAAE,4BAA4B;MAClCC,MAAM,EAAE,+CAA+C;MACvDC,WAAW,EAAE,8CAA8C;MAC3DC,aAAa,EAAE,uCAAuC;MACtDtC,QAAQ,EAAE,CACR;QAAEmC,IAAI,EAAE,cAAc;QAAEI,KAAK,EAAE;MAAO,CAAC,EACvC;QAAEJ,IAAI,EAAE,aAAa;QAAEI,KAAK,EAAE;MAAQ,CAAC,EACvC;QAAEJ,IAAI,EAAE,2CAA2C;QAAEI,KAAK,EAAE;MAAQ,CAAC,EACrE;QAAEJ,IAAI,EAAE,qBAAqB;QAAEI,KAAK,EAAE;MAAQ,CAAC,EAC/C;QAAEJ,IAAI,EAAE,yBAAyB;QAAEI,KAAK,EAAE;MAAQ,CAAC,EACnD;QAAEJ,IAAI,EAAE,WAAW;QAAEI,KAAK,EAAE;MAAS,CAAC,EACtC;QAAEJ,IAAI,EAAE,qBAAqB;QAAEI,KAAK,EAAE;MAAU,CAAC,EACjD;QAAEJ,IAAI,EAAE,8BAA8B;QAAEI,KAAK,EAAE;MAAU,CAAC,EAC1D;QAAEJ,IAAI,EAAE,mCAAmC;QAAEI,KAAK,EAAE;MAAU,CAAC,EAC/D;QAAEJ,IAAI,EAAE,SAAS;QAAEI,KAAK,EAAE;MAAU,CAAC,EACrC;QAAEJ,IAAI,EAAE,0BAA0B;QAAEI,KAAK,EAAE;MAAU,CAAC,EACtD;QAAEJ,IAAI,EAAE,2BAA2B;QAAEI,KAAK,EAAE;MAAU,CAAC,EACvD;QAAEJ,IAAI,EAAE,YAAY;QAAEI,KAAK,EAAE;MAAU,CAAC,EACxC;QAAEJ,IAAI,EAAE,aAAa;QAAEI,KAAK,EAAE;MAAU,CAAC;IAE7C,CAAC;EAEL,CAAC;EAEDvD,SAAS,CAAC,MAAM;IACdwD,WAAW,CAAC,CAAC;IACbC,iBAAiB,CAAC,CAAC;EACrB,CAAC,EAAE,EAAE,CAAC;EAENzD,SAAS,CAAC,MAAM;IACd,IAAIY,aAAa,IAAIE,gBAAgB,EAAE;MACrC4C,qBAAqB,CAAC,CAAC;IACzB;EACF,CAAC,EAAE,CAAC9C,aAAa,EAAEE,gBAAgB,CAAC,CAAC;EAErC,MAAM0C,WAAW,GAAG,MAAAA,CAAA,KAAY;IAC9B,IAAI;MACF,MAAMG,QAAQ,GAAG,MAAM1D,KAAK,CAAC2D,GAAG,CAAC,2CAA2C,CAAC;MAC7EnD,SAAS,CAACkD,QAAQ,CAACE,IAAI,CAAC;IAC1B,CAAC,CAAC,OAAOC,GAAG,EAAE;MACZC,OAAO,CAACC,KAAK,CAAC,wBAAwB,EAAEF,GAAG,CAAC;MAC5CnC,UAAU,CAAC;QAAEC,IAAI,EAAE,OAAO;QAAEC,IAAI,EAAE;MAAwB,CAAC,CAAC;IAC9D;EACF,CAAC;EAED,MAAM4B,iBAAiB,GAAG,MAAAA,CAAA,KAAY;IACpC,IAAI;MACF;MACA,MAAME,QAAQ,GAAG,MAAM1D,KAAK,CAAC2D,GAAG,CAAC,qCAAqC,CAAC;MACvE,MAAMK,iBAAiB,GAAGN,QAAQ,CAACE,IAAI,IAAI,EAAE;;MAE7C;MACA,MAAMK,kBAAkB,GAAGD,iBAAiB,CAACE,GAAG,CAACC,QAAQ,IAAI;QAAA,IAAAC,qBAAA;QAC3D;QACA,MAAMC,iBAAiB,IAAAD,qBAAA,GAAGnB,gBAAgB,CAACkB,QAAQ,CAACG,OAAO,CAAC,cAAAF,qBAAA,uBAAlCA,qBAAA,CAAqC,CAAC,CAAC;QAEjE,OAAO;UACLlB,IAAI,EAAEiB,QAAQ,CAACI,KAAK;UAAG;UACvBD,OAAO,EAAEH,QAAQ,CAACG,OAAO;UACzBE,YAAY,EAAEL,QAAQ,CAACM,SAAS;UAChCC,UAAU,EAAEP,QAAQ,CAACQ,EAAE;UACvBC,aAAa,EAAET,QAAQ,CAACI,KAAK;UAC7BxD,QAAQ,EAAE,CAAAsD,iBAAiB,aAAjBA,iBAAiB,uBAAjBA,iBAAiB,CAAEtD,QAAQ,KAAI,EAAE;UAAG;UAC9CoC,MAAM,EAAE,EAAE;UACVC,WAAW,EAAE,EAAE;UACfC,aAAa,EAAE;QACjB,CAAC;MACH,CAAC,CAAC;MAEF3C,YAAY,CAACuD,kBAAkB,CAAC;;MAEhC;MACA,IAAIA,kBAAkB,CAACY,MAAM,KAAK,CAAC,EAAE;QACnCnD,UAAU,CAAC;UACTC,IAAI,EAAE,MAAM;UACZC,IAAI,EAAE;QACR,CAAC,CAAC;MACJ;IACF,CAAC,CAAC,OAAOiC,GAAG,EAAE;MACZC,OAAO,CAACC,KAAK,CAAC,2BAA2B,EAAEF,GAAG,CAAC;MAC/CnC,UAAU,CAAC;QACTC,IAAI,EAAE,OAAO;QACbC,IAAI,EAAE;MACR,CAAC,CAAC;MACFlB,YAAY,CAAC,EAAE,CAAC;IAClB;EACF,CAAC;EAED,MAAMoE,iBAAiB,GAAIC,KAAK,IAAK;IACnCnE,gBAAgB,CAACmE,KAAK,CAAC;IACvBjE,mBAAmB,CAAC,IAAI,CAAC;IACzBM,kBAAkB,CAAC,IAAI,CAAC;IACxBE,YAAY,CAAC,EAAE,CAAC;IAChBN,WAAW,CAAC,EAAE,CAAC;IACfE,eAAe,CAAC,EAAE,CAAC;IACnBoB,wBAAwB,CAAC,IAAI,CAAC,CAAC,CAAE;;IAEjC;IACA;EACF,CAAC;EAED,MAAM0C,oBAAoB,GAAIC,QAAQ,IAAK;IACzCnE,mBAAmB,CAACmE,QAAQ,CAAC;IAC7B7D,kBAAkB,CAAC,IAAI,CAAC;IACxBE,YAAY,CAAC,EAAE,CAAC;IAChBN,WAAW,CAACiE,QAAQ,CAAClE,QAAQ,CAAC;IAC9BuB,wBAAwB,CAAC,IAAI,CAAC,CAAC,CAAE;;IAEjC;IACAwB,OAAO,CAACoB,GAAG,CAAC,oBAAoB,EAAED,QAAQ,CAAC/B,IAAI,CAAC;IAChDY,OAAO,CAACoB,GAAG,CAAC,oBAAoB,EAAE,CAAC,CAACD,QAAQ,CAACP,UAAU,CAAC;;IAExD;EACF,CAAC;EAED,MAAMjB,qBAAqB,GAAG,MAAAA,CAAA,KAAY;IACxC,IAAI,CAAC9C,aAAa,IAAI,CAACE,gBAAgB,EAAE;IAEzC,IAAI;MACF;MACA,MAAM6C,QAAQ,GAAG,MAAM1D,KAAK,CAAC2D,GAAG,CAC9B,uDAAuDhD,aAAa,CAACgE,EAAE,EACzE,CAAC;MAED,MAAMQ,YAAY,GAAGzB,QAAQ,CAACE,IAAI;;MAElC;MACA,MAAMwB,KAAK,GAAGvE,gBAAgB,CAACE,QAAQ,CAACmD,GAAG,CAACmB,OAAO,IAAI;QACrD,MAAMC,gBAAgB,GAAGC,wBAAwB,CAACJ,YAAY,EAAEE,OAAO,CAACnC,IAAI,CAAC;QAC7E,OAAO;UACL,GAAGmC,OAAO;UACVG,aAAa,EAAEF,gBAAgB,CAACT;QAClC,CAAC;MACH,CAAC,CAAC;MAEF3D,eAAe,CAACkE,KAAK,CAAC;IACxB,CAAC,CAAC,OAAOvB,GAAG,EAAE;MACZC,OAAO,CAACC,KAAK,CAAC,kCAAkC,EAAEF,GAAG,CAAC;IACxD;EACF,CAAC;EAED,MAAM4B,kBAAkB,GAAGA,CAAA,KAAM;IAC/BnD,wBAAwB,CAAC,IAAI,CAAC;IAC9BhB,YAAY,CAAC,EAAE,CAAC;IAChBF,kBAAkB,CAAC,IAAI,CAAC;IACxBF,eAAe,CAAC,EAAE,CAAC,CAAC,CAAC;IACrBQ,UAAU,CAAC;MAAEC,IAAI,EAAE,MAAM;MAAEC,IAAI,EAAE;IAAgD,CAAC,CAAC;EACrF,CAAC;EAED,MAAM8D,mBAAmB,GAAG,MAAAA,CAAA,KAAY;IACtC;IACA,IAAI,CAAC/E,aAAa,IAAI,CAACE,gBAAgB,EAAE;MACvCa,UAAU,CAAC;QAAEC,IAAI,EAAE,SAAS;QAAEC,IAAI,EAAE;MAAyD,CAAC,CAAC;MAC/F;IACF;IAEA,IAAI,CAACf,gBAAgB,CAAC6D,UAAU,EAAE;MAChChD,UAAU,CAAC;QAAEC,IAAI,EAAE,SAAS;QAAEC,IAAI,EAAE;MAAmC,CAAC,CAAC;MACzE;IACF;IAEAY,cAAc,CAAC,IAAI,CAAC;IAEpB,IAAI;MACF;MACAsB,OAAO,CAACoB,GAAG,CAAC,uCAAuC,CAAC;MACpDxD,UAAU,CAAC;QAAEC,IAAI,EAAE,MAAM;QAAEC,IAAI,EAAE;MAAwC,CAAC,CAAC;MAE3E,IAAI+D,aAAa,GAAG,KAAK;;MAEzB;MACA,IAAI;QACF,MAAM3F,KAAK,CAAC2D,GAAG,CAAC,+CAA+C9C,gBAAgB,CAAC6D,UAAU,EAAE,CAAC;QAC7FZ,OAAO,CAACoB,GAAG,CAAC,4BAA4B,CAAC;QACzCxD,UAAU,CAAC;UAAEC,IAAI,EAAE,MAAM;UAAEC,IAAI,EAAE;QAAmD,CAAC,CAAC;MACxF,CAAC,CAAC,OAAOiC,GAAG,EAAE;QAAA,IAAA+B,aAAA,EAAAC,cAAA,EAAAC,mBAAA,EAAAC,qBAAA;QACZ,IAAI,EAAAH,aAAA,GAAA/B,GAAG,CAACH,QAAQ,cAAAkC,aAAA,uBAAZA,aAAA,CAAcI,MAAM,MAAK,GAAG,KAAAH,cAAA,GAAIhC,GAAG,CAACH,QAAQ,cAAAmC,cAAA,gBAAAC,mBAAA,GAAZD,cAAA,CAAcjC,IAAI,cAAAkC,mBAAA,gBAAAC,qBAAA,GAAlBD,mBAAA,CAAoB/B,KAAK,cAAAgC,qBAAA,eAAzBA,qBAAA,CAA2BE,QAAQ,CAAC,iBAAiB,CAAC,EAAE;UAC1FN,aAAa,GAAG,IAAI;UACpB7B,OAAO,CAACoB,GAAG,CAAC,wCAAwC,CAAC;QACvD,CAAC,MAAM;UACL,MAAMrB,GAAG;QACX;MACF;;MAEA;MACA,IAAI8B,aAAa,EAAE;QACjBjE,UAAU,CAAC;UAAEC,IAAI,EAAE,MAAM;UAAEC,IAAI,EAAE;QAAuD,CAAC,CAAC;QAE1F,MAAMsE,aAAa,GAAG,MAAMlG,KAAK,CAACmG,IAAI,CACpC,4CAA4CtF,gBAAgB,CAAC6D,UAAU,EACzE,CAAC;QAED,IAAI,CAACwB,aAAa,CAACtC,IAAI,CAACwC,OAAO,EAAE;UAC/B,MAAM,IAAIC,KAAK,CAACH,aAAa,CAACtC,IAAI,CAACG,KAAK,IAAI,iBAAiB,CAAC;QAChE;QAEAD,OAAO,CAACoB,GAAG,CAAC,aAAagB,aAAa,CAACtC,IAAI,CAAC0C,cAAc,WAAW,CAAC;QACtE5E,UAAU,CAAC;UACTC,IAAI,EAAE,MAAM;UACZC,IAAI,EAAE,aAAasE,aAAa,CAACtC,IAAI,CAAC0C,cAAc;QACtD,CAAC,CAAC;MACJ;;MAEA;MACA5E,UAAU,CAAC;QAAEC,IAAI,EAAE,MAAM;QAAEC,IAAI,EAAE;MAA4C,CAAC,CAAC;;MAE/E;MACA,MAAM2E,iBAAiB,GAAG,MAAMvG,KAAK,CAAC2D,GAAG,CACvC,uDAAuDhD,aAAa,CAACgE,EAAE,EACzE,CAAC;MAED,MAAMQ,YAAY,GAAGoB,iBAAiB,CAAC3C,IAAI;;MAE3C;MACA,MAAM4C,eAAe,GAAG,MAAMxG,KAAK,CAACmG,IAAI,CACtC,qDAAqD,EACrD;QACE9E,SAAS,EAAE8D,YAAY;QACvBsB,WAAW,EAAE5F,gBAAgB,CAAC6D;MAChC,CACF,CAAC;MAED,IAAI8B,eAAe,CAAC5C,IAAI,CAACwC,OAAO,EAAE;QAChC,MAAMM,eAAe,GAAGF,eAAe,CAAC5C,IAAI,CAAC+C,gBAAgB;;QAE7D;QACA,MAAMC,aAAa,GAAG,CAAC,CAAC;QACxB,MAAMC,kBAAkB,GAAG,EAAE;QAE7BH,eAAe,CAACI,OAAO,CAACC,CAAC,IAAI;UAC3B,IAAIA,CAAC,CAAChG,QAAQ,IAAIgG,CAAC,CAAChG,QAAQ,CAAC8D,MAAM,GAAG,CAAC,EAAE;YACvC,MAAMmC,UAAU,GAAGD,CAAC,CAAChG,QAAQ,CAAC,CAAC,CAAC;YAChC,MAAMkG,UAAU,GAAGD,UAAU,CAACE,aAAa;YAE3C,IAAI,CAACN,aAAa,CAACK,UAAU,CAAC,EAAE;cAC9BL,aAAa,CAACK,UAAU,CAAC,GAAG;gBAC1B5B,OAAO,EAAE2B,UAAU;gBACnB3F,SAAS,EAAE;cACb,CAAC;YACH;YACAuF,aAAa,CAACK,UAAU,CAAC,CAAC5F,SAAS,CAAC8F,IAAI,CAACJ,CAAC,CAAC;UAC7C,CAAC,MAAM;YACLF,kBAAkB,CAACM,IAAI,CAACJ,CAAC,CAAC;UAC5B;QACF,CAAC,CAAC;;QAEF;QACA,IAAIF,kBAAkB,CAAChC,MAAM,GAAG,CAAC,EAAE;UACjC+B,aAAa,CAAC,qBAAqB,CAAC,GAAG;YACrCvB,OAAO,EAAE;cACP+B,cAAc,EAAE,CAAC;cACjBF,aAAa,EAAE,qBAAqB;cACpCG,UAAU,EAAE,KAAK;cACjBC,QAAQ,EAAE,KAAK;cACfC,gBAAgB,EAAE;YACpB,CAAC;YACDlG,SAAS,EAAEwF;UACb,CAAC;QACH;QAEA,MAAMW,cAAc,GAAGC,MAAM,CAACC,MAAM,CAACd,aAAa,CAAC,CAACe,MAAM,CAAC,CAACC,GAAG,EAAEhE,IAAI,KAAKgE,GAAG,GAAGhE,IAAI,CAACvC,SAAS,CAACwD,MAAM,EAAE,CAAC,CAAC;;QAEzG;QACA3D,eAAe,CAAC,EAAE,CAAC;QAEnBoB,wBAAwB,CAACsE,aAAa,CAAC;QACvClF,UAAU,CAAC;UACTC,IAAI,EAAE,SAAS;UACfC,IAAI,EAAE,sBAAsB6F,MAAM,CAACI,IAAI,CAACjB,aAAa,CAAC,CAAC/B,MAAM,kBAAkB2C,cAAc,eAAeX,kBAAkB,CAAChC,MAAM;QACvI,CAAC,CAAC;;QAEF;QACA,MAAMiD,iBAAiB,CAAClB,aAAa,CAAC;MACxC,CAAC,MAAM;QACL,MAAM,IAAIP,KAAK,CAAC,kBAAkB,CAAC;MACrC;IACF,CAAC,CAAC,OAAOxC,GAAG,EAAE;MAAA,IAAAkE,cAAA,EAAAC,mBAAA;MACZlE,OAAO,CAACC,KAAK,CAAC,kCAAkC,EAAEF,GAAG,CAAC;MACtD,MAAMoE,QAAQ,GAAG,EAAAF,cAAA,GAAAlE,GAAG,CAACH,QAAQ,cAAAqE,cAAA,wBAAAC,mBAAA,GAAZD,cAAA,CAAcnE,IAAI,cAAAoE,mBAAA,uBAAlBA,mBAAA,CAAoBjE,KAAK,KAAIF,GAAG,CAACpC,OAAO;MAEzDC,UAAU,CAAC;QACTC,IAAI,EAAE,OAAO;QACbC,IAAI,EAAE,WAAWqG,QAAQ;MAC3B,CAAC,CAAC;IACJ,CAAC,SAAS;MACRzF,cAAc,CAAC,KAAK,CAAC;IACvB;EACF,CAAC;EAED,MAAM0F,mBAAmB,GAAG,MAAAA,CAAA,KAAY;IACtC;IACA,IAAI,CAACrH,gBAAgB,IAAI,CAACA,gBAAgB,CAAC6D,UAAU,EAAE;MACrDhD,UAAU,CAAC;QAAEC,IAAI,EAAE,SAAS;QAAEC,IAAI,EAAE;MAAiC,CAAC,CAAC;MACvE;IACF;IAEAY,cAAc,CAAC,IAAI,CAAC;IACpBd,UAAU,CAAC;MAAEC,IAAI,EAAE,MAAM;MAAEC,IAAI,EAAE;IAAuD,CAAC,CAAC;IAE1F,IAAI;MACF,MAAM8B,QAAQ,GAAG,MAAM1D,KAAK,CAACmG,IAAI,CAC/B,4CAA4CtF,gBAAgB,CAAC6D,UAAU,EACzE,CAAC;MAED,IAAIhB,QAAQ,CAACE,IAAI,CAACwC,OAAO,EAAE;QACzB1E,UAAU,CAAC;UACTC,IAAI,EAAE,SAAS;UACfC,IAAI,EAAE,oCAAoC8B,QAAQ,CAACE,IAAI,CAAC0C,cAAc;QACxE,CAAC,CAAC;MACJ,CAAC,MAAM;QACL,MAAM,IAAID,KAAK,CAAC3C,QAAQ,CAACE,IAAI,CAACG,KAAK,IAAI,iBAAiB,CAAC;MAC3D;IACF,CAAC,CAAC,OAAOF,GAAG,EAAE;MAAA,IAAAsE,cAAA,EAAAC,mBAAA;MACZtE,OAAO,CAACC,KAAK,CAAC,0BAA0B,EAAEF,GAAG,CAAC;MAC9CnC,UAAU,CAAC;QACTC,IAAI,EAAE,OAAO;QACbC,IAAI,EAAE,6BAA6B,EAAAuG,cAAA,GAAAtE,GAAG,CAACH,QAAQ,cAAAyE,cAAA,wBAAAC,mBAAA,GAAZD,cAAA,CAAcvE,IAAI,cAAAwE,mBAAA,uBAAlBA,mBAAA,CAAoBrE,KAAK,KAAIF,GAAG,CAACpC,OAAO;MAC7E,CAAC,CAAC;IACJ,CAAC,SAAS;MACRe,cAAc,CAAC,KAAK,CAAC;IACvB;EACF,CAAC;EAED,MAAM6F,uBAAuB,GAAG,MAAAA,CAAA,KAAY;IAC1C,IAAI,CAAC1H,aAAa,IAAI,CAACE,gBAAgB,EAAE;MACvCa,UAAU,CAAC;QAAEC,IAAI,EAAE,SAAS;QAAEC,IAAI,EAAE;MAAyD,CAAC,CAAC;MAC/F;IACF;IAEA,IAAI,CAACf,gBAAgB,CAAC6D,UAAU,EAAE;MAChChD,UAAU,CAAC;QAAEC,IAAI,EAAE,SAAS;QAAEC,IAAI,EAAE;MAAuD,CAAC,CAAC;MAC7F;IACF;IAEAY,cAAc,CAAC,IAAI,CAAC;IACpBd,UAAU,CAAC;MAAEC,IAAI,EAAE,MAAM;MAAEC,IAAI,EAAE;IAA4C,CAAC,CAAC;IAE/E,IAAI;MACF;MACA,MAAM8B,QAAQ,GAAG,MAAM1D,KAAK,CAAC2D,GAAG,CAC9B,uDAAuDhD,aAAa,CAACgE,EAAE,EACzE,CAAC;MAED,MAAMQ,YAAY,GAAGzB,QAAQ,CAACE,IAAI;;MAElC;MACA,MAAM4C,eAAe,GAAG,MAAMxG,KAAK,CAACmG,IAAI,CACtC,qDAAqD,EACrD;QACE9E,SAAS,EAAE8D,YAAY;QACvBsB,WAAW,EAAE5F,gBAAgB,CAAC6D;MAChC,CACF,CAAC;MAED,IAAI8B,eAAe,CAAC5C,IAAI,CAACwC,OAAO,EAAE;QAChC,MAAMM,eAAe,GAAGF,eAAe,CAAC5C,IAAI,CAAC+C,gBAAgB;;QAE7D;QACA,MAAMC,aAAa,GAAG,CAAC,CAAC;QACxB,MAAMC,kBAAkB,GAAG,EAAE;QAE7BH,eAAe,CAACI,OAAO,CAACC,CAAC,IAAI;UAC3B,IAAIA,CAAC,CAAChG,QAAQ,IAAIgG,CAAC,CAAChG,QAAQ,CAAC8D,MAAM,GAAG,CAAC,EAAE;YACvC,MAAMmC,UAAU,GAAGD,CAAC,CAAChG,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;YAClC,MAAMkG,UAAU,GAAGD,UAAU,CAACE,aAAa;YAE3C,IAAI,CAACN,aAAa,CAACK,UAAU,CAAC,EAAE;cAC9BL,aAAa,CAACK,UAAU,CAAC,GAAG;gBAC1B5B,OAAO,EAAE2B,UAAU;gBACnB3F,SAAS,EAAE;cACb,CAAC;YACH;YACAuF,aAAa,CAACK,UAAU,CAAC,CAAC5F,SAAS,CAAC8F,IAAI,CAACJ,CAAC,CAAC;UAC7C,CAAC,MAAM;YACL;YACAF,kBAAkB,CAACM,IAAI,CAACJ,CAAC,CAAC;UAC5B;QACF,CAAC,CAAC;;QAEF;QACA,IAAIF,kBAAkB,CAAChC,MAAM,GAAG,CAAC,EAAE;UACjC+B,aAAa,CAAC,qBAAqB,CAAC,GAAG;YACrCvB,OAAO,EAAE;cACP+B,cAAc,EAAE,CAAC;cACjBF,aAAa,EAAE,qBAAqB;cACpCG,UAAU,EAAE,KAAK;cACjBC,QAAQ,EAAE,KAAK;cACfC,gBAAgB,EAAE;YACpB,CAAC;YACDlG,SAAS,EAAEwF;UACb,CAAC;QACH;QAEA,MAAMW,cAAc,GAAGC,MAAM,CAACC,MAAM,CAACd,aAAa,CAAC,CAACe,MAAM,CAAC,CAACC,GAAG,EAAEhE,IAAI,KAAKgE,GAAG,GAAGhE,IAAI,CAACvC,SAAS,CAACwD,MAAM,EAAE,CAAC,CAAC;QAEzGf,OAAO,CAACoB,GAAG,CAAC,yBAAyB,EAAEuC,MAAM,CAACI,IAAI,CAACjB,aAAa,CAAC,CAAC;QAClE9C,OAAO,CAACoB,GAAG,CAAC,sBAAsB,EAAE0B,aAAa,CAAC;;QAElD;QACA1F,eAAe,CAAC,EAAE,CAAC;QAEnBoB,wBAAwB,CAACsE,aAAa,CAAC;QACvClF,UAAU,CAAC;UACTC,IAAI,EAAE,SAAS;UACfC,IAAI,EAAE,gCAAgC6F,MAAM,CAACI,IAAI,CAACjB,aAAa,CAAC,CAAC/B,MAAM,kBAAkB2C,cAAc,eAAeX,kBAAkB,CAAChC,MAAM;QACjJ,CAAC,CAAC;;QAEF;QACA,MAAMiD,iBAAiB,CAAClB,aAAa,CAAC;MACxC,CAAC,MAAM;QACL,MAAM,IAAIP,KAAK,CAAC,wBAAwB,CAAC;MAC3C;IACF,CAAC,CAAC,OAAOxC,GAAG,EAAE;MAAA,IAAAyE,cAAA,EAAAC,mBAAA;MACZzE,OAAO,CAACC,KAAK,CAAC,2BAA2B,EAAEF,GAAG,CAAC;MAC/C,MAAMoE,QAAQ,GAAG,EAAAK,cAAA,GAAAzE,GAAG,CAACH,QAAQ,cAAA4E,cAAA,wBAAAC,mBAAA,GAAZD,cAAA,CAAc1E,IAAI,cAAA2E,mBAAA,uBAAlBA,mBAAA,CAAoBxE,KAAK,KAAIF,GAAG,CAACpC,OAAO;;MAEzD;MACA,IAAIwG,QAAQ,CAAChC,QAAQ,CAAC,uBAAuB,CAAC,IAAIgC,QAAQ,CAAChC,QAAQ,CAAC,OAAO,CAAC,EAAE;QAC5EvE,UAAU,CAAC;UACTC,IAAI,EAAE,OAAO;UACbC,IAAI,EAAE;QACR,CAAC,CAAC;MACJ,CAAC,MAAM;QACLF,UAAU,CAAC;UACTC,IAAI,EAAE,OAAO;UACbC,IAAI,EAAE,8BAA8BqG,QAAQ;QAC9C,CAAC,CAAC;MACJ;IACF,CAAC,SAAS;MACRzF,cAAc,CAAC,KAAK,CAAC;IACvB;EACF,CAAC;EAED,MAAMsF,iBAAiB,GAAG,MAAOlB,aAAa,IAAK;IACjD,IAAI;MACF9C,OAAO,CAACoB,GAAG,CAAC,yCAAyC,CAAC;MACtDpB,OAAO,CAACoB,GAAG,CAAC,aAAa,EAAEvE,aAAa,CAACgE,EAAE,CAAC;MAC5Cb,OAAO,CAACoB,GAAG,CAAC,gBAAgB,EAAErE,gBAAgB,CAAC6D,UAAU,CAAC;MAC1DZ,OAAO,CAACoB,GAAG,CAAC,aAAa,EAAEuC,MAAM,CAACI,IAAI,CAACjB,aAAa,CAAC,CAAC/B,MAAM,CAAC;MAE7D,MAAMnB,QAAQ,GAAG,MAAM1D,KAAK,CAACmG,IAAI,CAAC,kDAAkD,EAAE;QACpFqC,QAAQ,EAAE7H,aAAa,CAACgE,EAAE;QAC1B8B,WAAW,EAAE5F,gBAAgB,CAAC6D,UAAU;QACxC+D,cAAc,EAAE7B;MAClB,CAAC,CAAC;MAEF9C,OAAO,CAACoB,GAAG,CAAC,qCAAqC,EAAExB,QAAQ,CAACE,IAAI,CAAC;IACnE,CAAC,CAAC,OAAOG,KAAK,EAAE;MAAA,IAAA2E,eAAA;MACd5E,OAAO,CAACC,KAAK,CAAC,kCAAkC,EAAEA,KAAK,CAAC;MACxDD,OAAO,CAACC,KAAK,CAAC,kBAAkB,GAAA2E,eAAA,GAAE3E,KAAK,CAACL,QAAQ,cAAAgF,eAAA,uBAAdA,eAAA,CAAgB9E,IAAI,CAAC;MACvD;IACF;EACF,CAAC;EAED,MAAM+E,mBAAmB,GAAG,MAAAA,CAAA,KAAY;IACtC,IAAI,CAAChI,aAAa,IAAI,CAACE,gBAAgB,IAAI,CAACA,gBAAgB,CAAC6D,UAAU,EAAE;MACvEhD,UAAU,CAAC;QAAEC,IAAI,EAAE,SAAS;QAAEC,IAAI,EAAE;MAAyD,CAAC,CAAC;MAC/F;IACF;IAEAY,cAAc,CAAC,IAAI,CAAC;IACpBd,UAAU,CAAC;MAAEC,IAAI,EAAE,MAAM;MAAEC,IAAI,EAAE;IAAuC,CAAC,CAAC;IAE1EkC,OAAO,CAACoB,GAAG,CAAC,0BAA0B,CAAC;IACvCpB,OAAO,CAACoB,GAAG,CAAC,aAAa,EAAEvE,aAAa,CAACgE,EAAE,CAAC;IAC5Cb,OAAO,CAACoB,GAAG,CAAC,gBAAgB,EAAErE,gBAAgB,CAAC6D,UAAU,CAAC;IAE1D,IAAI;MACF,MAAMhB,QAAQ,GAAG,MAAM1D,KAAK,CAAC2D,GAAG,CAC9B,yDAAyDhD,aAAa,CAACgE,EAAE,gBAAgB9D,gBAAgB,CAAC6D,UAAU,EACtH,CAAC;MAEDZ,OAAO,CAACoB,GAAG,CAAC,aAAa,EAAExB,QAAQ,CAACE,IAAI,CAAC;MAEzC,IAAIF,QAAQ,CAACE,IAAI,CAACwC,OAAO,EAAE;QACzB,MAAM;UAAEqC,cAAc;UAAEG,cAAc;UAAEC,eAAe;UAAEC,eAAe;UAAEC;QAAW,CAAC,GAAGrF,QAAQ,CAACE,IAAI;;QAEtG;QACA1C,eAAe,CAAC,EAAE,CAAC;QAEnBoB,wBAAwB,CAACmG,cAAc,CAAC;;QAExC;QACA,MAAMO,IAAI,GAAG,IAAIC,IAAI,CAACF,UAAU,CAAC;QACjC,MAAMG,OAAO,GAAGC,UAAU,CAACH,IAAI,CAAC;QAEhCtH,UAAU,CAAC;UACTC,IAAI,EAAE,SAAS;UACfC,IAAI,EAAE,+BAA+BsH,OAAO,MAAMN,cAAc,kBAAkBC,eAAe,eAAeC,eAAe;QACjI,CAAC,CAAC;MACJ;IACF,CAAC,CAAC,OAAOjF,GAAG,EAAE;MAAA,IAAAuF,cAAA;MACZtF,OAAO,CAACC,KAAK,CAAC,2BAA2B,EAAEF,GAAG,CAAC;MAC/C,IAAI,EAAAuF,cAAA,GAAAvF,GAAG,CAACH,QAAQ,cAAA0F,cAAA,uBAAZA,cAAA,CAAcpD,MAAM,MAAK,GAAG,EAAE;QAChC;QACA1D,wBAAwB,CAAC,IAAI,CAAC;QAC9BpB,eAAe,CAAC,EAAE,CAAC;QAEnBQ,UAAU,CAAC;UACTC,IAAI,EAAE,MAAM;UACZC,IAAI,EAAE,kCAAkCjB,aAAa,CAAC4D,KAAK,WAAW1D,gBAAgB,CAACqC,IAAI;QAC7F,CAAC,CAAC;MACJ,CAAC,MAAM;QAAA,IAAAmG,cAAA,EAAAC,mBAAA;QACL5H,UAAU,CAAC;UACTC,IAAI,EAAE,OAAO;UACbC,IAAI,EAAE,oCAAoC,EAAAyH,cAAA,GAAAxF,GAAG,CAACH,QAAQ,cAAA2F,cAAA,wBAAAC,mBAAA,GAAZD,cAAA,CAAczF,IAAI,cAAA0F,mBAAA,uBAAlBA,mBAAA,CAAoBvF,KAAK,KAAIF,GAAG,CAACpC,OAAO;QACpF,CAAC,CAAC;MACJ;IACF,CAAC,SAAS;MACRe,cAAc,CAAC,KAAK,CAAC;IACvB;EACF,CAAC;EAED,MAAM2G,UAAU,GAAIH,IAAI,IAAK;IAC3B,MAAMO,OAAO,GAAGC,IAAI,CAACC,KAAK,CAAC,CAAC,IAAIR,IAAI,CAAC,CAAC,GAAGD,IAAI,IAAI,IAAI,CAAC;IAEtD,IAAIO,OAAO,GAAG,EAAE,EAAE,OAAO,UAAU;IACnC,IAAIA,OAAO,GAAG,IAAI,EAAE,OAAO,GAAGC,IAAI,CAACC,KAAK,CAACF,OAAO,GAAG,EAAE,CAAC,cAAc;IACpE,IAAIA,OAAO,GAAG,KAAK,EAAE,OAAO,GAAGC,IAAI,CAACC,KAAK,CAACF,OAAO,GAAG,IAAI,CAAC,YAAY;IACrE,IAAIA,OAAO,GAAG,MAAM,EAAE,OAAO,GAAGC,IAAI,CAACC,KAAK,CAACF,OAAO,GAAG,KAAK,CAAC,WAAW;IACtE,OAAOP,IAAI,CAACU,kBAAkB,CAAC,CAAC;EAClC,CAAC;EAED,MAAMC,mBAAmB,GAAIC,WAAW,IAAK;IAC3C9F,OAAO,CAACoB,GAAG,CAAC,mBAAmB,EAAE0E,WAAW,CAAC;IAC7C9F,OAAO,CAACoB,GAAG,CAAC,8CAA8C,EAAE7C,qBAAqB,GAAGoF,MAAM,CAACI,IAAI,CAACxF,qBAAqB,CAAC,GAAG,MAAM,CAAC;IAEhIjB,kBAAkB,CAACwI,WAAW,CAAC;IAE/B,IAAIvH,qBAAqB,IAAIA,qBAAqB,CAACuH,WAAW,CAAC1G,IAAI,CAAC,EAAE;MACpE;MACA,MAAMoC,gBAAgB,GAAGjD,qBAAqB,CAACuH,WAAW,CAAC1G,IAAI,CAAC,CAAC7B,SAAS;MAC1E,MAAMwI,WAAW,GAAGxH,qBAAqB,CAACuH,WAAW,CAAC1G,IAAI,CAAC,CAACmC,OAAO;MAEnEvB,OAAO,CAACoB,GAAG,CAAC,0BAA0B,EAAEI,gBAAgB,CAACT,MAAM,CAAC;MAChEf,OAAO,CAACoB,GAAG,CAAC,eAAe,EAAE2E,WAAW,CAAC;MAEzCvI,YAAY,CAACgE,gBAAgB,CAAC;MAC9B5D,UAAU,CAAC;QACTC,IAAI,EAAE,SAAS;QACfC,IAAI,EAAE,WAAW0D,gBAAgB,CAACT,MAAM,mBAAmB+E,WAAW,CAAC1G,IAAI;MAC7E,CAAC,CAAC;IACJ,CAAC,MAAM;MACLY,OAAO,CAACgG,IAAI,CAAC,+CAA+C,EAAEF,WAAW,CAAC1G,IAAI,CAAC;MAC/ExB,UAAU,CAAC;QACTC,IAAI,EAAE,MAAM;QACZC,IAAI,EAAE;MACR,CAAC,CAAC;MACFN,YAAY,CAAC,EAAE,CAAC;IAClB;EACF,CAAC;EAED,MAAMyI,mBAAmB,GAAG,MAAOC,QAAQ,IAAK;IAC9ClH,kBAAkB,CAAC,IAAI,CAAC;IACxB,IAAI;MACF,MAAMmH,cAAc,GAAGD,QAAQ,CAACjJ,QAAQ,IAAIiJ,QAAQ,CAACjJ,QAAQ,CAAC8D,MAAM,GAAG,CAAC,GACpEmF,QAAQ,CAACjJ,QAAQ,CAAC,CAAC,CAAC,CAACmG,aAAa,GAClC/F,eAAe,aAAfA,eAAe,uBAAfA,eAAe,CAAE+B,IAAI;MAEzB,MAAMQ,QAAQ,GAAG,MAAM1D,KAAK,CAACmG,IAAI,CAAC,0CAA0C,EAAE;QAC5E+D,aAAa,EAAEF,QAAQ,CAACE,aAAa;QACrCC,aAAa,EAAEH,QAAQ,CAACG,aAAa;QACrC7F,OAAO,EAAE3D,aAAa,aAAbA,aAAa,uBAAbA,aAAa,CAAE2D,OAAO;QAC/B8F,eAAe,EAAEH;MACnB,CAAC,CAAC;MAEF,IAAIvG,QAAQ,CAACE,IAAI,CAACwC,OAAO,EAAE;QACzBxD,mBAAmB,CAAC;UAClByH,cAAc,EAAEL,QAAQ,CAACM,eAAe;UACxCC,YAAY,EAAEP,QAAQ,CAACE,aAAa;UACpCM,YAAY,EAAER,QAAQ,CAACG,aAAa;UACpCM,QAAQ,EAAE/G,QAAQ,CAACE,IAAI,CAAC6G,QAAQ;UAChCC,cAAc,EAAEhH,QAAQ,CAACE,IAAI,CAAC+G;QAChC,CAAC,CAAC;;QAEF;QACA,IAAI;UACF,MAAM3K,KAAK,CAACmG,IAAI,CAAC,gDAAgD,EAAE;YACjE+D,aAAa,EAAEF,QAAQ,CAACE,aAAa;YACrCO,QAAQ,EAAE/G,QAAQ,CAACE,IAAI,CAAC6G,QAAQ;YAChCG,MAAM,EAAE,oBAAoB;YAC5BpC,QAAQ,EAAE7H,aAAa,aAAbA,aAAa,uBAAbA,aAAa,CAAEgE,EAAE;YAC3B8B,WAAW,EAAE,CAAA5F,gBAAgB,aAAhBA,gBAAgB,uBAAhBA,gBAAgB,CAAE6D,UAAU,MAAI7D,gBAAgB,aAAhBA,gBAAgB,uBAAhBA,gBAAgB,CAAE8D,EAAE;YACjEkG,YAAY,EAAEZ,cAAc;YAC5Ba,SAAS,EAAE,IAAI7B,IAAI,CAAC,CAAC,CAAC8B,WAAW,CAAC;UACpC,CAAC,CAAC;UACFjH,OAAO,CAACoB,GAAG,CAAC,mCAAmC,CAAC;QAClD,CAAC,CAAC,OAAO8F,OAAO,EAAE;UAChBlH,OAAO,CAACC,KAAK,CAAC,kCAAkC,EAAEiH,OAAO,CAAC;UAC1D;QACF;MACF,CAAC,MAAM;QACLC,KAAK,CAAC,4BAA4B,IAAIvH,QAAQ,CAACE,IAAI,CAACG,KAAK,IAAI,eAAe,CAAC,CAAC;MAChF;IACF,CAAC,CAAC,OAAOA,KAAK,EAAE;MAAA,IAAAmH,gBAAA,EAAAC,qBAAA;MACdrH,OAAO,CAACC,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;MAC/CkH,KAAK,CAAC,0BAA0B,IAAI,EAAAC,gBAAA,GAAAnH,KAAK,CAACL,QAAQ,cAAAwH,gBAAA,wBAAAC,qBAAA,GAAdD,gBAAA,CAAgBtH,IAAI,cAAAuH,qBAAA,uBAApBA,qBAAA,CAAsBpH,KAAK,KAAIA,KAAK,CAACtC,OAAO,CAAC,CAAC;IACpF,CAAC,SAAS;MACRqB,kBAAkB,CAAC,KAAK,CAAC;IAC3B;EACF,CAAC;EAED,MAAMsI,0BAA0B,GAAGA,CAACb,YAAY,EAAEX,WAAW,KAAK;IAChE;IACA,IAAI,CAACA,WAAW,IAAI,CAACA,WAAW,CAACtG,KAAK,EAAE;MACtC,OAAO,KAAK,CAAC,CAAC;IAChB;IAEA,MAAM;MAAEA;IAAM,CAAC,GAAGsG,WAAW;IAC7B,MAAM,CAACyB,SAAS,EAAEC,OAAO,CAAC,GAAGhI,KAAK,CAACiI,KAAK,CAAC,GAAG,CAAC,CAACrH,GAAG,CAACsH,CAAC,IAAIC,QAAQ,CAACD,CAAC,CAACE,IAAI,CAAC,CAAC,CAAC,CAAC;IAC1E,MAAMC,UAAU,GAAGL,OAAO,GAAGD,SAAS,GAAG,CAAC;;IAE1C;IACA,MAAMO,iBAAiB,GAAG;MACxB;MACA,kBAAkB,EAAE,GAAG;MACvB,sBAAsB,EAAE,GAAG;MAC3B,SAAS,EAAE,GAAG;MACd,YAAY,EAAE,GAAG;MACjB,gBAAgB,EAAE,GAAG;MACrB,kBAAkB,EAAE,GAAG;MACvB,gBAAgB,EAAE,GAAG;MACrB,gBAAgB,EAAE,GAAG;MACrB,WAAW,EAAE,GAAG;MAEhB;MACA,gBAAgB,EAAE,GAAG;MACrB,iBAAiB,EAAE,GAAG;MACtB,eAAe,EAAE,GAAG;MACpB,UAAU,EAAE,GAAG;MACf,oBAAoB,EAAE,GAAG;MACzB,gBAAgB,EAAE,GAAG;MACrB,2BAA2B,EAAE,GAAG;MAChC,WAAW,EAAE,GAAG;MAChB,SAAS,EAAE,GAAG;MAEd;MACA,mBAAmB,EAAE,GAAG;MACxB,cAAc,EAAE,IAAI;MACpB,kBAAkB,EAAE,GAAG;MACvB,gBAAgB,EAAE,GAAG;MACrB,eAAe,EAAE,GAAG;MACpB,gBAAgB,EAAE,IAAI;MACtB,YAAY,EAAE,GAAG;MACjB,kBAAkB,EAAE,IAAI;MACxB,WAAW,EAAE,GAAG;MAChB,MAAM,EAAE,IAAI;MACZ,cAAc,EAAE,GAAG;MACnB,aAAa,EAAE,IAAI;MACnB,cAAc,EAAE,GAAG;MACnB,eAAe,EAAE,GAAG;MAEpB;MACA,eAAe,EAAE,GAAG;MACpB,eAAe,EAAE,GAAG;MACpB,mBAAmB,EAAE,GAAG;MACxB,mBAAmB,EAAE,GAAG;MACxB,cAAc,EAAE,GAAG;MACnB,iBAAiB,EAAE,GAAG;MACtB,cAAc,EAAE,GAAG;MAEnB;MACA,kBAAkB,EAAE,GAAG;MACvB,uBAAuB,EAAE,GAAG;MAC5B,yBAAyB,EAAE,GAAG;MAC9B,iBAAiB,EAAE,GAAG;MACtB,oBAAoB,EAAE,GAAG;MACzB,wBAAwB,EAAE,GAAG;MAC7B,qBAAqB,EAAE,GAAG;MAE1B;MACA,kBAAkB,EAAE,GAAG;MACvB,iBAAiB,EAAE,GAAG;MACtB,UAAU,EAAE,GAAG;MACf,kBAAkB,EAAE,GAAG;MACvB,WAAW,EAAE,GAAG;MAChB,OAAO,EAAE,GAAG;MAEZ;MACA,qBAAqB,EAAE,GAAG;MAC1B,MAAM,EAAE,GAAG;MACX,QAAQ,EAAE,GAAG;MACb,SAAS,EAAE,GAAG;MACd,qBAAqB,EAAE,GAAG;MAC1B,wBAAwB,EAAE,GAAG;MAC7B,oBAAoB,EAAE,GAAG;MACzB,qBAAqB,EAAE,GAAG;MAC1B,qBAAqB,EAAE,GAAG;MAE1B;MACA,MAAM,EAAE,GAAG;MACX,QAAQ,EAAE,GAAG;MACb,MAAM,EAAE,GAAG;MACX,sBAAsB,EAAE,GAAG;MAC3B,OAAO,EAAE,GAAG;MAEZ;MACA,yBAAyB,EAAE,GAAG;MAC9B,0BAA0B,EAAE,GAAG;MAC/B,cAAc,EAAE,GAAG;MACnB,oBAAoB,EAAE,GAAG;MAEzB;MACA,MAAM,EAAE,GAAG;MACX,MAAM,EAAE,GAAG;MACX,WAAW,EAAE,GAAG;MAChB,UAAU,EAAE,GAAG;MACf,gBAAgB,EAAE,GAAG;MACrB,MAAM,EAAE,GAAG;MACX,0BAA0B,EAAE,GAAG;MAE/B;MACA,WAAW,EAAE,GAAG;MAChB,aAAa,EAAE,IAAI;MACnB,eAAe,EAAE,GAAG;MACpB,gBAAgB,EAAE,IAAI;MACtB,WAAW,EAAE,GAAG;MAChB,aAAa,EAAE,GAAG;MAClB,SAAS,EAAE,IAAI;MACf,WAAW,EAAE,GAAG;MAChB,gBAAgB,EAAE,GAAG;MACrB,WAAW,EAAE;IACf,CAAC;IAED,MAAMC,SAAS,GAAGtB,YAAY,CAACuB,WAAW,CAAC,CAAC;IAC5C,IAAIC,iBAAiB,GAAG,GAAG,CAAC,CAAC;IAC7B,IAAIC,UAAU,GAAG,KAAK;;IAEtB;IACA,KAAK,MAAM,CAACC,QAAQ,EAAEC,QAAQ,CAAC,IAAIzE,MAAM,CAAC0E,OAAO,CAACP,iBAAiB,CAAC,EAAE;MACpE,IAAIC,SAAS,CAAC5F,QAAQ,CAACgG,QAAQ,CAAC,EAAE;QAChCF,iBAAiB,GAAGG,QAAQ;QAC5BF,UAAU,GAAG,IAAI;QACjB,MAAM,CAAC;MACT;IACF;;IAEA;IACA,MAAMI,aAAa,GAAG5C,IAAI,CAAC6C,KAAK,CAAChB,SAAS,GAAIM,UAAU,GAAGI,iBAAkB,CAAC;IAC9E,MAAMO,UAAU,GAAG9C,IAAI,CAAC+C,GAAG,CAAClB,SAAS,EAAEe,aAAa,GAAG,CAAC,CAAC;IACzD,MAAMI,QAAQ,GAAGhD,IAAI,CAACiD,GAAG,CAACnB,OAAO,EAAEc,aAAa,GAAG,CAAC,CAAC;IAErD,OAAOJ,UAAU,GAAG,GAAGM,UAAU,IAAIE,QAAQ,EAAE,GAAGlJ,KAAK;EACzD,CAAC;EAED,MAAMoJ,eAAe,GAAIC,SAAS,IAAK;IACrC,MAAM,CAACtB,SAAS,EAAEC,OAAO,CAAC,GAAGqB,SAAS,CAACpB,KAAK,CAAC,GAAG,CAAC,CAACrH,GAAG,CAACsH,CAAC,IAAIC,QAAQ,CAACD,CAAC,CAACE,IAAI,CAAC,CAAC,CAAC,CAAC;IAC9ExJ,cAAc,CAACmJ,SAAS,CAAC;IACzBrJ,qBAAqB,CAAC;MACpBiD,QAAQ,EAAEpE,gBAAgB;MAC1BwE,OAAO,EAAElE,eAAe,CAAC+B,IAAI;MAC7ByJ,SAAS,EAAEA,SAAS;MACpBtB,SAAS,EAAEA,SAAS;MACpBC,OAAO,EAAEA,OAAO,IAAID;IACtB,CAAC,CAAC;IACFvJ,oBAAoB,CAAC,IAAI,CAAC;EAC5B,CAAC;EAED,MAAM8K,cAAc,GAAGA,CAAA,KAAM;IAC3B,IAAI3K,WAAW,GAAGF,kBAAkB,CAACuJ,OAAO,EAAE;MAC5C,MAAMuB,QAAQ,GAAG5K,WAAW,GAAG,CAAC;MAChC6B,OAAO,CAACoB,GAAG,CAAC,YAAY,EAAE2H,QAAQ,CAAC;MACnCzK,aAAa,CAAC,IAAI,CAAC;MACnBF,cAAc,CAAC2K,QAAQ,CAAC;MACxBC,UAAU,CAAC,MAAM1K,aAAa,CAAC,KAAK,CAAC,EAAE,IAAI,CAAC;IAC9C;EACF,CAAC;EAED,MAAM2K,cAAc,GAAGA,CAAA,KAAM;IAC3B,IAAI9K,WAAW,GAAGF,kBAAkB,CAACsJ,SAAS,EAAE;MAC9C,MAAM2B,QAAQ,GAAG/K,WAAW,GAAG,CAAC;MAChC6B,OAAO,CAACoB,GAAG,CAAC,gBAAgB,EAAE8H,QAAQ,CAAC;MACvC5K,aAAa,CAAC,IAAI,CAAC;MACnBF,cAAc,CAAC8K,QAAQ,CAAC;MACxBF,UAAU,CAAC,MAAM1K,aAAa,CAAC,KAAK,CAAC,EAAE,IAAI,CAAC;IAC9C;EACF,CAAC;EAED,MAAM6K,gBAAgB,GAAGA,CAAA,KAAM;IAC7BnL,oBAAoB,CAAC,KAAK,CAAC;IAC3BE,qBAAqB,CAAC,IAAI,CAAC;IAC3BE,cAAc,CAAC,CAAC,CAAC;EACnB,CAAC;EAED,MAAMqD,wBAAwB,GAAGA,CAAClE,SAAS,EAAEgE,OAAO,KAAK;IACvD;IACA,MAAM6H,eAAe,GAAG;MACtB,aAAa,EAAE;QACbC,OAAO,EAAE,CAAC,SAAS,EAAE,SAAS,EAAE,YAAY,EAAE,KAAK,EAAE,SAAS,EAAE,gBAAgB,EAAE,mBAAmB,CAAC;QACtGC,SAAS,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,QAAQ,EAAE,MAAM,EAAE,UAAU,EAAE,WAAW,EAAE,WAAW;MACrF,CAAC;MACD,6BAA6B,EAAE;QAC7BD,OAAO,EAAE,CAAC,gBAAgB,EAAE,eAAe,EAAE,UAAU,EAAE,OAAO,EAAE,WAAW,EAAE,SAAS,CAAC;QACzFC,SAAS,EAAE,CAAC,QAAQ,EAAE,2BAA2B,EAAE,UAAU,EAAE,YAAY;MAC7E,CAAC;MACD,mCAAmC,EAAE;QACnCD,OAAO,EAAE,CAAC,YAAY,EAAE,YAAY,EAAE,QAAQ,EAAE,MAAM,EAAE,cAAc,EAAE,iBAAiB,CAAC;QAC1FC,SAAS,EAAE,CAAC,SAAS,EAAE,QAAQ,EAAE,aAAa,EAAE,SAAS,EAAE,kBAAkB;MAC/E,CAAC;MACD,+BAA+B,EAAE;QAC/BD,OAAO,EAAE,CAAC,KAAK,EAAE,QAAQ,EAAE,QAAQ,EAAE,UAAU,EAAE,YAAY,EAAE,SAAS,EAAE,OAAO,CAAC;QAClFC,SAAS,EAAE,CAAC,QAAQ,EAAE,QAAQ,EAAE,eAAe,EAAE,YAAY,EAAE,UAAU;MAC3E,CAAC;MACD,mBAAmB,EAAE;QACnBD,OAAO,EAAE,CAAC,kBAAkB,EAAE,cAAc,EAAE,aAAa,EAAE,aAAa,EAAE,gBAAgB,CAAC;QAC7FC,SAAS,EAAE,CAAC,QAAQ,EAAE,eAAe,EAAE,YAAY,EAAE,cAAc;MACrE,CAAC;MACD,kCAAkC,EAAE;QAClCD,OAAO,EAAE,CAAC,mBAAmB,EAAE,mBAAmB,EAAE,UAAU,EAAE,SAAS,EAAE,mBAAmB,CAAC;QAC/FC,SAAS,EAAE,CAAC,WAAW,EAAE,WAAW,EAAE,eAAe,EAAE,aAAa,EAAE,cAAc;MACtF,CAAC;MACD,wBAAwB,EAAE;QACxBD,OAAO,EAAE,CAAC,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,UAAU,EAAE,gBAAgB,CAAC;QAC/DC,SAAS,EAAE,CAAC,QAAQ,EAAE,WAAW,EAAE,QAAQ,EAAE,QAAQ,EAAE,OAAO;MAChE,CAAC;MACD,uBAAuB,EAAE;QACvBD,OAAO,EAAE,CAAC,OAAO,EAAE,WAAW,EAAE,WAAW,EAAE,mBAAmB,EAAE,WAAW,CAAC;QAC9EC,SAAS,EAAE,CAAC,OAAO,EAAE,KAAK,EAAE,YAAY,EAAE,UAAU,EAAE,YAAY;MACpE,CAAC;MACD,0BAA0B,EAAE;QAC1BD,OAAO,EAAE,CAAC,iBAAiB,EAAE,kBAAkB,EAAE,aAAa,EAAE,kBAAkB,CAAC;QACnFC,SAAS,EAAE,CAAC,QAAQ,EAAE,QAAQ,EAAE,QAAQ,EAAE,SAAS,EAAE,iBAAiB,EAAE,OAAO;MACjF,CAAC;MACD,gBAAgB,EAAE;QAChBD,OAAO,EAAE,CAAC,WAAW,EAAE,aAAa,EAAE,gBAAgB,EAAE,WAAW,EAAE,gBAAgB,CAAC;QACtFC,SAAS,EAAE,CAAC,WAAW,EAAE,sBAAsB,EAAE,eAAe,EAAE,QAAQ;MAC5E,CAAC;MACD,0BAA0B,EAAE;QAC1BD,OAAO,EAAE,CAAC,gBAAgB,EAAE,SAAS,EAAE,WAAW,EAAE,eAAe,EAAE,QAAQ,CAAC;QAC9EC,SAAS,EAAE,CAAC,OAAO,EAAE,aAAa,EAAE,SAAS,EAAE,UAAU,EAAE,UAAU;MACvE,CAAC;MACD,4BAA4B,EAAE;QAC5BD,OAAO,EAAE,CAAC,cAAc,EAAE,qBAAqB,EAAE,sBAAsB,EAAE,eAAe,CAAC;QACzFC,SAAS,EAAE,CAAC,QAAQ,EAAE,QAAQ,EAAE,SAAS,EAAE,SAAS,EAAE,wBAAwB;MAChF,CAAC;MACD,wBAAwB,EAAE;QACxBD,OAAO,EAAE,CAAC,UAAU,EAAE,aAAa,EAAE,MAAM,EAAE,YAAY,EAAE,WAAW,EAAE,mBAAmB,CAAC;QAC5FC,SAAS,EAAE,CAAC,KAAK,EAAE,QAAQ,EAAE,WAAW,EAAE,YAAY,EAAE,QAAQ;MAClE,CAAC;MACD,iBAAiB,EAAE;QACjBD,OAAO,EAAE,CAAC,WAAW,EAAE,YAAY,EAAE,UAAU,EAAE,eAAe,EAAE,aAAa,CAAC;QAChFC,SAAS,EAAE,CAAC,aAAa,EAAE,WAAW,EAAE,mBAAmB,EAAE,YAAY;MAC3E,CAAC;MACD,cAAc,EAAE;QACdD,OAAO,EAAE,CAAC,aAAa,EAAE,iBAAiB,EAAE,mBAAmB,EAAE,QAAQ,EAAE,KAAK,EAAE,KAAK,CAAC;QACxFC,SAAS,EAAE,CAAC,OAAO,EAAE,WAAW,EAAE,qBAAqB;MACzD,CAAC;MACD,aAAa,EAAE;QACbD,OAAO,EAAE,CAAC,YAAY,EAAE,sBAAsB,EAAE,oBAAoB,EAAE,aAAa,CAAC;QACpFC,SAAS,EAAE,CAAC,sBAAsB,EAAE,kBAAkB,EAAE,eAAe;MACzE,CAAC;MACD,2CAA2C,EAAE;QAC3CD,OAAO,EAAE,CAAC,iBAAiB,EAAE,uBAAuB,EAAE,qBAAqB,EAAE,oBAAoB,CAAC;QAClGC,SAAS,EAAE,CAAC,sBAAsB,EAAE,kBAAkB,EAAE,YAAY,EAAE,cAAc;MACtF,CAAC;MACD,qBAAqB,EAAE;QACrBD,OAAO,EAAE,CAAC,oBAAoB,EAAE,cAAc,EAAE,mBAAmB,EAAE,mBAAmB,CAAC;QACzFC,SAAS,EAAE,CAAC,IAAI,EAAE,KAAK,EAAE,eAAe,EAAE,mBAAmB;MAC/D,CAAC;MACD,yBAAyB,EAAE;QACzBD,OAAO,EAAE,CAAC,wBAAwB,EAAE,mBAAmB,EAAE,UAAU,EAAE,WAAW,CAAC;QACjFC,SAAS,EAAE,CAAC,IAAI,EAAE,qBAAqB,EAAE,QAAQ;MACnD,CAAC;MACD,WAAW,EAAE;QACXD,OAAO,EAAE,CAAC,kBAAkB,EAAE,oBAAoB,EAAE,oBAAoB,EAAE,kBAAkB,CAAC;QAC7FC,SAAS,EAAE,CAAC,kBAAkB,EAAE,WAAW,EAAE,UAAU,EAAE,QAAQ;MACnE,CAAC;MACD,qBAAqB,EAAE;QACrBD,OAAO,EAAE,CAAC,YAAY,EAAE,kBAAkB,EAAE,iBAAiB,EAAE,kBAAkB,CAAC;QAClFC,SAAS,EAAE,CAAC,OAAO,EAAE,QAAQ,EAAE,QAAQ,EAAE,iBAAiB;MAC5D,CAAC;MACD,8BAA8B,EAAE;QAC9BD,OAAO,EAAE,CAAC,cAAc,EAAE,qBAAqB,EAAE,MAAM,EAAE,QAAQ,EAAE,SAAS,CAAC;QAC7EC,SAAS,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,OAAO,EAAE,GAAG,EAAE,OAAO;MACxD,CAAC;MACD,mCAAmC,EAAE;QACnCD,OAAO,EAAE,CAAC,qBAAqB,EAAE,oBAAoB,EAAE,qBAAqB,EAAE,eAAe,CAAC;QAC9FC,SAAS,EAAE,CAAC,2BAA2B,EAAE,OAAO,EAAE,iBAAiB;MACrE,CAAC;MACD,SAAS,EAAE;QACTD,OAAO,EAAE,CAAC,QAAQ,EAAE,mBAAmB,EAAE,OAAO,EAAE,QAAQ,EAAE,gBAAgB,CAAC;QAC7EC,SAAS,EAAE,CAAC,QAAQ,EAAE,UAAU,EAAE,KAAK,EAAE,SAAS;MACpD,CAAC;MACD,0BAA0B,EAAE;QAC1BD,OAAO,EAAE,CAAC,gBAAgB,EAAE,QAAQ,EAAE,mBAAmB,EAAE,eAAe,CAAC;QAC3EC,SAAS,EAAE,CAAC,GAAG,EAAE,IAAI,EAAE,iBAAiB,EAAE,SAAS;MACrD,CAAC;MACD,2BAA2B,EAAE;QAC3BD,OAAO,EAAE,CAAC,cAAc,EAAE,QAAQ,EAAE,oBAAoB,EAAE,qBAAqB,CAAC;QAChFC,SAAS,EAAE,CAAC,MAAM,EAAE,QAAQ,EAAE,UAAU,EAAE,MAAM,EAAE,QAAQ,EAAE,YAAY;MAC1E,CAAC;MACD,YAAY,EAAE;QACZD,OAAO,EAAE,CAAC,MAAM,EAAE,QAAQ,EAAE,MAAM,EAAE,wBAAwB,EAAE,sBAAsB,CAAC;QACrFC,SAAS,EAAE,CAAC,MAAM,EAAE,gBAAgB,EAAE,cAAc,EAAE,OAAO;MAC/D,CAAC;MACD,aAAa,EAAE;QACbD,OAAO,EAAE,CAAC,aAAa,EAAE,yBAAyB,EAAE,0BAA0B,EAAE,mBAAmB,CAAC;QACpGC,SAAS,EAAE,CAAC,OAAO,EAAE,SAAS,EAAE,cAAc,EAAE,SAAS,EAAE,YAAY;MACzE;IACF,CAAC;IAED,MAAMxD,WAAW,GAAGsD,eAAe,CAAC7H,OAAO,CAAC;IAC5C,IAAI,CAACuE,WAAW,EAAE;MAChB;MACA,MAAMyD,QAAQ,GAAGhI,OAAO,CAACyG,WAAW,CAAC,CAAC,CAACP,KAAK,CAAC,GAAG,CAAC;MACjD,OAAOlK,SAAS,CAACiM,MAAM,CAACvG,CAAC,IAAI;QAC3B,MAAMwD,YAAY,GAAGxD,CAAC,CAACmD,aAAa,CAAC4B,WAAW,CAAC,CAAC;QAClD,OAAOuB,QAAQ,CAACE,IAAI,CAACC,OAAO,IAAIjD,YAAY,CAACtE,QAAQ,CAACuH,OAAO,CAAC,CAAC;MACjE,CAAC,CAAC;IACJ;;IAEA;IACA,OAAOnM,SAAS,CAACiM,MAAM,CAACvG,CAAC,IAAI;MAC3B,MAAMwD,YAAY,GAAGxD,CAAC,CAACmD,aAAa,CAAC4B,WAAW,CAAC,CAAC;MAClD,IAAI2B,KAAK,GAAG,CAAC;;MAEb;MACA7D,WAAW,CAACuD,OAAO,CAACrG,OAAO,CAAC0G,OAAO,IAAI;QACrC,IAAIjD,YAAY,CAACtE,QAAQ,CAACuH,OAAO,CAAC1B,WAAW,CAAC,CAAC,CAAC,EAAE;UAChD2B,KAAK,IAAI,CAAC;QACZ;MACF,CAAC,CAAC;;MAEF;MACA7D,WAAW,CAACwD,SAAS,CAACtG,OAAO,CAAC0G,OAAO,IAAI;QACvC,IAAIjD,YAAY,CAACtE,QAAQ,CAACuH,OAAO,CAAC1B,WAAW,CAAC,CAAC,CAAC,EAAE;UAChD2B,KAAK,IAAI,CAAC;QACZ;MACF,CAAC,CAAC;;MAEF;MACA,OAAOA,KAAK,IAAI,CAAC;IACnB,CAAC,CAAC;EACJ,CAAC;EAED,oBACEvN,OAAA;IAAKwN,SAAS,EAAC,mBAAmB;IAAAC,QAAA,gBAChCzN,OAAA;MAAKwN,SAAS,EAAC,gBAAgB;MAAAC,QAAA,gBAC7BzN,OAAA;QAAAyN,QAAA,EAAI;MAAqB;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eAC9B7N,OAAA;QAAAyN,QAAA,EAAG;MAAwE;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAC5E,CAAC,EAELtM,OAAO,CAACG,IAAI,iBACX1B,OAAA;MAAKwN,SAAS,EAAE,WAAWjM,OAAO,CAACE,IAAI,EAAG;MAAAgM,QAAA,EACvClM,OAAO,CAACG;IAAI;MAAAgM,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACV,CACN,eAED7N,OAAA;MAAKwN,SAAS,EAAC,iBAAiB;MAAAC,QAAA,gBAE9BzN,OAAA;QAAKwN,SAAS,EAAC,gBAAgB;QAAAC,QAAA,gBAE7BzN,OAAA;UAAKwN,SAAS,EAAC,4CAA4C;UAAAC,QAAA,gBACzDzN,OAAA;YAAAyN,QAAA,EAAI;UAA0B;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,EAClCtN,SAAS,CAACoE,MAAM,KAAK,CAAC,gBACrB3E,OAAA;YAAGwN,SAAS,EAAC,SAAS;YAAAC,QAAA,EAAC;UAAuD;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAG,CAAC,gBAElF7N,OAAA;YAAKwN,SAAS,EAAC,2BAA2B;YAAAC,QAAA,eACxCzN,OAAA;cAAOwN,SAAS,EAAC,iBAAiB;cAAAC,QAAA,gBAChCzN,OAAA;gBAAAyN,QAAA,eACEzN,OAAA;kBAAAyN,QAAA,gBACEzN,OAAA;oBAAI8N,KAAK,EAAE;sBAACC,KAAK,EAAE;oBAAM,CAAE;oBAAAN,QAAA,EAAC;kBAAM;oBAAAC,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAI,CAAC,eACvC7N,OAAA;oBAAAyN,QAAA,EAAI;kBAAa;oBAAAC,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAI,CAAC,eACtB7N,OAAA;oBAAAyN,QAAA,EAAI;kBAAO;oBAAAC,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAI,CAAC;gBAAA;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACd;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACA,CAAC,eACR7N,OAAA;gBAAAyN,QAAA,EACGlN,SAAS,CAACyD,GAAG,CAAC,CAACe,QAAQ,EAAEiJ,KAAK,kBAC7BhO,OAAA;kBAEEwN,SAAS,EAAE,iBAAiB,CAAA7M,gBAAgB,aAAhBA,gBAAgB,uBAAhBA,gBAAgB,CAAEqC,IAAI,MAAK+B,QAAQ,CAAC/B,IAAI,GAAG,UAAU,GAAG,EAAE,IAAI,CAAC+B,QAAQ,CAACP,UAAU,GAAG,UAAU,GAAG,EAAE,EAAG;kBACnIyJ,OAAO,EAAEA,CAAA,KAAMlJ,QAAQ,CAACP,UAAU,IAAIM,oBAAoB,CAACC,QAAQ,CAAE;kBAAA0I,QAAA,gBAErEzN,OAAA;oBAAIwN,SAAS,EAAC,eAAe;oBAAAC,QAAA,eAC3BzN,OAAA;sBACEyB,IAAI,EAAC,UAAU;sBACfyM,OAAO,EAAE,CAAAvN,gBAAgB,aAAhBA,gBAAgB,uBAAhBA,gBAAgB,CAAEqC,IAAI,MAAK+B,QAAQ,CAAC/B,IAAK;sBAClDmL,QAAQ,EAAEA,CAAA,KAAMpJ,QAAQ,CAACP,UAAU,IAAIM,oBAAoB,CAACC,QAAQ,CAAE;sBACtEqJ,QAAQ,EAAE,CAACrJ,QAAQ,CAACP,UAAW;sBAC/ByJ,OAAO,EAAGI,CAAC,IAAKA,CAAC,CAACC,eAAe,CAAC;oBAAE;sBAAAZ,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OACrC;kBAAC;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACA,CAAC,eACL7N,OAAA;oBAAIwN,SAAS,EAAC,WAAW;oBAAAC,QAAA,eACvBzN,OAAA;sBAAKwN,SAAS,EAAC,cAAc;sBAAAC,QAAA,gBAC3BzN,OAAA;wBAAMwN,SAAS,EAAC,MAAM;wBAAAC,QAAA,EAAE1I,QAAQ,CAACP,UAAU,GAAG,IAAI,GAAG;sBAAI;wBAAAkJ,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OAAO,CAAC,eACjE7N,OAAA;wBAAMwN,SAAS,EAAC,MAAM;wBAAAC,QAAA,EAAE1I,QAAQ,CAAC/B;sBAAI;wBAAA0K,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OAAO,CAAC;oBAAA;sBAAAH,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAC1C;kBAAC;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACJ,CAAC,eACL7N,OAAA;oBAAIwN,SAAS,EAAC,cAAc;oBAAAC,QAAA,eAC1BzN,OAAA;sBAAMwN,SAAS,EAAC,eAAe;sBAAAC,QAAA,EAAE1I,QAAQ,CAACX;oBAAO;sBAAAsJ,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAO;kBAAC;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACvD,CAAC;gBAAA,GArBAG,KAAK;kBAAAN,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAsBR,CACL;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACG,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACL,CACN;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACE,CAAC,eAGN7N,OAAA;UAAKwN,SAAS,EAAC,yCAAyC;UAAAC,QAAA,gBACtDzN,OAAA;YAAAyN,QAAA,EAAI;UAAgC;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,EACxCxN,MAAM,CAACsE,MAAM,KAAK,CAAC,gBAClB3E,OAAA;YAAGwN,SAAS,EAAC,SAAS;YAAAC,QAAA,EAAC;UAA+B;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAG,CAAC,gBAE1D7N,OAAA;YAAKwN,SAAS,EAAC,2BAA2B;YAAAC,QAAA,eACxCzN,OAAA;cAAOwN,SAAS,EAAC,iBAAiB;cAAAC,QAAA,gBAChCzN,OAAA;gBAAAyN,QAAA,eACEzN,OAAA;kBAAAyN,QAAA,gBACEzN,OAAA;oBAAI8N,KAAK,EAAE;sBAACC,KAAK,EAAE;oBAAM,CAAE;oBAAAN,QAAA,EAAC;kBAAM;oBAAAC,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAI,CAAC,eACvC7N,OAAA;oBAAAyN,QAAA,EAAI;kBAAW;oBAAAC,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAI,CAAC,eACpB7N,OAAA;oBAAAyN,QAAA,EAAI;kBAAO;oBAAAC,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAI,CAAC;gBAAA;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACd;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACA,CAAC,eACR7N,OAAA;gBAAAyN,QAAA,EACGpN,MAAM,CAAC2D,GAAG,CAACa,KAAK,iBACf7E,OAAA;kBAEEwN,SAAS,EAAE,iBAAiB,CAAA/M,aAAa,aAAbA,aAAa,uBAAbA,aAAa,CAAEgE,EAAE,MAAKI,KAAK,CAACJ,EAAE,GAAG,UAAU,GAAG,EAAE,EAAG;kBAC/EwJ,OAAO,EAAEA,CAAA,KAAMrJ,iBAAiB,CAACC,KAAK,CAAE;kBAAA4I,QAAA,gBAExCzN,OAAA;oBAAIwN,SAAS,EAAC,eAAe;oBAAAC,QAAA,eAC3BzN,OAAA;sBACEyB,IAAI,EAAC,UAAU;sBACfyM,OAAO,EAAE,CAAAzN,aAAa,aAAbA,aAAa,uBAAbA,aAAa,CAAEgE,EAAE,MAAKI,KAAK,CAACJ,EAAG;sBACxC0J,QAAQ,EAAEA,CAAA,KAAMvJ,iBAAiB,CAACC,KAAK,CAAE;sBACzCoJ,OAAO,EAAGI,CAAC,IAAKA,CAAC,CAACC,eAAe,CAAC;oBAAE;sBAAAZ,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OACrC;kBAAC;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACA,CAAC,eACL7N,OAAA;oBAAIwN,SAAS,EAAC,WAAW;oBAAAC,QAAA,eACvBzN,OAAA;sBAAKwN,SAAS,EAAC,cAAc;sBAAAC,QAAA,gBAC3BzN,OAAA;wBAAMwN,SAAS,EAAC,MAAM;wBAAAC,QAAA,EAAC;sBAAE;wBAAAC,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OAAM,CAAC,eAChC7N,OAAA;wBAAMwN,SAAS,EAAC,MAAM;wBAAAC,QAAA,EAAE5I,KAAK,CAACR;sBAAK;wBAAAqJ,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OAAO,CAAC;oBAAA;sBAAAH,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OACxC;kBAAC;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACJ,CAAC,eACL7N,OAAA;oBAAIwN,SAAS,EAAC,cAAc;oBAAAC,QAAA,eAC1BzN,OAAA;sBAAMwN,SAAS,EAAC,eAAe;sBAAAC,QAAA,EAAE5I,KAAK,CAACT;oBAAO;sBAAAsJ,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAO;kBAAC;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACpD,CAAC;gBAAA,GApBAhJ,KAAK,CAACJ,EAAE;kBAAAiJ,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAqBX,CACL;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACG,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACL,CACN;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACE,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC,EAGLpN,aAAa,IAAIE,gBAAgB,iBAChCX,OAAA;QAAKwN,SAAS,EAAC,yBAAyB;QAAAC,QAAA,eACtCzN,OAAA;UAAKwN,SAAS,EAAC,gBAAgB;UAAAC,QAAA,gBAC7BzN,OAAA;YACEwN,SAAS,EAAC,eAAe;YACzBS,OAAO,EAAExF,mBAAoB;YAC7B2F,QAAQ,EAAE/L,WAAW,IAAI,CAAC1B,gBAAgB,CAAC6D,UAAW;YACtDH,KAAK,EAAC,mDAAmD;YAAAoJ,QAAA,EAExDpL,WAAW,gBACVrC,OAAA,CAAAE,SAAA;cAAAuN,QAAA,gBACEzN,OAAA;gBAAMwN,SAAS,EAAC;cAAe;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAO,CAAC,cAEzC;YAAA,eAAE,CAAC,gBAEH7N,OAAA,CAAAE,SAAA;cAAAuN,QAAA,EAAE;YAEF,gBAAE;UACH;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACK,CAAC,eACT7N,OAAA;YACEwN,SAAS,EAAC,qBAAqB;YAC/BS,OAAO,EAAEzI,mBAAoB;YAC7B4I,QAAQ,EAAE/L,WAAW,IAAI,CAAC1B,gBAAgB,CAAC6D,UAAU,IAAI,CAAC/D,aAAc;YACxE4D,KAAK,EAAC,wDAAwD;YAAAoJ,QAAA,EAE7DpL,WAAW,gBACVrC,OAAA,CAAAE,SAAA;cAAAuN,QAAA,gBACEzN,OAAA;gBAAMwN,SAAS,EAAC;cAAe;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAO,CAAC,iBAEzC;YAAA,eAAE,CAAC,gBAEH7N,OAAA,CAAAE,SAAA;cAAAuN,QAAA,EAAE;YAEF,gBAAE;UACH;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACK,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACN;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CACN,EAGA1L,qBAAqB,IAAIoF,MAAM,CAACI,IAAI,CAACxF,qBAAqB,CAAC,CAACwC,MAAM,GAAG,CAAC,iBACrE3E,OAAA;QAAKwN,SAAS,EAAC,kCAAkC;QAAAC,QAAA,gBAC/CzN,OAAA;UAAAyN,QAAA,EAAI;QAA8C;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eACvD7N,OAAA;UAAKwN,SAAS,EAAC,yBAAyB;UAAAC,QAAA,eACtCzN,OAAA;YAAOwN,SAAS,EAAC,eAAe;YAAAC,QAAA,gBAC9BzN,OAAA;cAAAyN,QAAA,eACEzN,OAAA;gBAAAyN,QAAA,gBACEzN,OAAA;kBAAAyN,QAAA,EAAI;gBAAC;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,eACV7N,OAAA;kBAAAyN,QAAA,EAAI;gBAAY;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,eACrB7N,OAAA;kBAAAyN,QAAA,EAAI;gBAAK;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,eACd7N,OAAA;kBAAAyN,QAAA,EAAI;gBAAS;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,eAClB7N,OAAA;kBAAAyN,QAAA,EAAI;gBAAM;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACb;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACA,CAAC,eACR7N,OAAA;cAAAyN,QAAA,EACGlG,MAAM,CAAC0E,OAAO,CAAC9J,qBAAqB,CAAC,CAAC6B,GAAG,CAAC,CAAC,CAACuK,WAAW,EAAE7K,IAAI,CAAC,EAAEsK,KAAK,KAAK;gBACzE,MAAMQ,aAAa,GAAG9K,IAAI,CAACvC,SAAS,CAACsG,MAAM,CAAC,CAACC,GAAG,EAAEb,CAAC,KAAK;kBACtD,OAAOa,GAAG,IAAIb,CAAC,CAAChG,QAAQ,IAAIgG,CAAC,CAAChG,QAAQ,CAAC,CAAC,CAAC,GAAGgG,CAAC,CAAChG,QAAQ,CAAC,CAAC,CAAC,CAACwG,gBAAgB,GAAG,CAAC,CAAC;gBACjF,CAAC,EAAE,CAAC,CAAC,GAAG3D,IAAI,CAACvC,SAAS,CAACwD,MAAM;gBAE7B,MAAM8J,WAAW,GAAGF,WAAW,KAAK,qBAAqB;gBAEzD,oBACAvO,OAAA;kBAEEwN,SAAS,EAAE,GAAG,CAAAvM,eAAe,aAAfA,eAAe,uBAAfA,eAAe,CAAE+B,IAAI,MAAKuL,WAAW,GAAG,cAAc,GAAG,EAAE,IAAIE,WAAW,GAAG,eAAe,GAAG,EAAE,EAAG;kBAAAhB,QAAA,gBAElHzN,OAAA;oBAAIwN,SAAS,EAAC,aAAa;oBAAAC,QAAA,EACxBgB,WAAW,GAAG,IAAI,GAAI/K,IAAI,CAACyB,OAAO,CAAC+B,cAAc,IAAK8G,KAAK,GAAG;kBAAG;oBAAAN,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAChE,CAAC,eACL7N,OAAA;oBAAIwN,SAAS,EAAC,mBAAmB;oBAAAC,QAAA,gBAC/BzN,OAAA;sBAAAyN,QAAA,EAASc;oBAAW;sBAAAb,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAS,CAAC,EAC7BW,aAAa,GAAG,CAAC,IAAI,CAACC,WAAW,iBAChCzO,OAAA;sBAAKwN,SAAS,EAAC,kBAAkB;sBAACnJ,KAAK,EAAE,0BAA0BmK,aAAa,CAACE,OAAO,CAAC,CAAC,CAAC,GAAI;sBAAAjB,QAAA,GAAC,eAC3F,EAACe,aAAa,CAACE,OAAO,CAAC,CAAC,CAAC,EAAC,GAC/B;oBAAA;sBAAAhB,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAK,CACN,EACAY,WAAW,iBACVzO,OAAA;sBAAKwN,SAAS,EAAC,iBAAiB;sBAACnJ,KAAK,EAAC,oDAAoD;sBAAAoJ,QAAA,EAAC;oBAE5F;sBAAAC,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAK,CACN;kBAAA;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACC,CAAC,eACL7N,OAAA;oBAAIwN,SAAS,EAAC,YAAY;oBAAAC,QAAA,EACvBgB,WAAW,GAAG,KAAK,GAAG,GAAG/K,IAAI,CAACyB,OAAO,CAACgC,UAAU,IAAIzD,IAAI,CAACyB,OAAO,CAACiC,QAAQ;kBAAE;oBAAAsG,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAC1E,CAAC,eACL7N,OAAA;oBAAIwN,SAAS,EAAC,YAAY;oBAAAC,QAAA,eACxBzN,OAAA;sBAAMwN,SAAS,EAAE,kBAAkBiB,WAAW,GAAG,iBAAiB,GAAG,eAAe,EAAG;sBAAAhB,QAAA,EACpF/J,IAAI,CAACvC,SAAS,CAACwD;oBAAM;sBAAA+I,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAClB;kBAAC;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACL,CAAC,eACL7N,OAAA;oBAAIwN,SAAS,EAAC,aAAa;oBAAAC,QAAA,eACzBzN,OAAA;sBACEwN,SAAS,EAAE,YAAYiB,WAAW,GAAG,eAAe,GAAG,EAAE,EAAG;sBAC5DR,OAAO,EAAEA,CAAA,KAAMxE,mBAAmB,CAAC;wBAAEzG,IAAI,EAAEuL;sBAAY,CAAC,CAAE;sBAAAd,QAAA,EAC3D;oBAED;sBAAAC,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAQ;kBAAC;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACP,CAAC;gBAAA,GAlCAG,KAAK;kBAAAN,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAmCR,CAAC;cAEP,CAAC;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACG,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACL,CAAC,eACN7N,OAAA;UAAKwN,SAAS,EAAC,eAAe;UAAAC,QAAA,eAC5BzN,OAAA;YAAAyN,QAAA,gBACEzN,OAAA;cAAAyN,QAAA,EAAQ;YAAe;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC,KAAC,EAACtG,MAAM,CAACI,IAAI,CAACxF,qBAAqB,CAAC,CAACwC,MAAM,EAAC,IAC5E,eAAA3E,OAAA;cAAAyN,QAAA,EAAQ;YAAiB;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC,KAAC,EAACtG,MAAM,CAACC,MAAM,CAACrF,qBAAqB,CAAC,CAACsF,MAAM,CAAC,CAACC,GAAG,EAAEhE,IAAI,KAAKgE,GAAG,GAAGhE,IAAI,CAACvC,SAAS,CAACwD,MAAM,EAAE,CAAC,CAAC;UAAA;YAAA+I,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC7H;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACD,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CACN,EAGA5M,eAAe,iBACdjB,OAAA;QAAKwN,SAAS,EAAC,mBAAmB;QAAAC,QAAA,gBAChCzN,OAAA;UAAKwN,SAAS,EAAC,uBAAuB;UAAAC,QAAA,gBACpCzN,OAAA;YAAAyN,QAAA,GAAI,yBAAkB,EAACxM,eAAe,CAAC+B,IAAI;UAAA;YAAA0K,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAK,CAAC,eACjD7N,OAAA;YAAKwN,SAAS,EAAC,cAAc;YAAAC,QAAA,gBAC3BzN,OAAA;cAAMwN,SAAS,EAAC,WAAW;cAAAC,QAAA,GAAC,eAAG,eAAAzN,OAAA;gBAAAyN,QAAA,EAAQ;cAAS;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,KAAC,EAAClN,gBAAgB,CAACqC,IAAI;YAAA;cAAA0K,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eACxF7N,OAAA;cAAMwN,SAAS,EAAC,WAAW;cAAAC,QAAA,GAAC,eAAG,eAAAzN,OAAA;gBAAAyN,QAAA,EAAQ;cAAM;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,KAAC,EAAC5M,eAAe,CAACmC,KAAK;YAAA;cAAAsK,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eACrF7N,OAAA;cAAMwN,SAAS,EAAC,WAAW;cAAAC,QAAA,GAAC,eAAG,eAAAzN,OAAA;gBAAAyN,QAAA,EAAQ;cAAM;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,KAAC,EAACpN,aAAa,CAAC4D,KAAK;YAAA;cAAAqJ,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAChF,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC,EAELxM,OAAO,gBACNrB,OAAA;UAAKwN,SAAS,EAAC,SAAS;UAAAC,QAAA,gBACtBzN,OAAA;YAAKwN,SAAS,EAAC;UAAS;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eAC/B7N,OAAA;YAAAyN,QAAA,EAAG;UAAoB;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAG,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACxB,CAAC,GACJ1M,SAAS,CAACwD,MAAM,KAAK,CAAC,gBACxB3E,OAAA;UAAKwN,SAAS,EAAC,cAAc;UAAAC,QAAA,gBAC3BzN,OAAA;YAAAyN,QAAA,EAAG;UAAmC;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAG,CAAC,eAC1C7N,OAAA;YAAGwN,SAAS,EAAC,MAAM;YAAAC,QAAA,EAAC;UAAiC;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAG,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACtD,CAAC,gBAEN7N,OAAA;UAAKwN,SAAS,EAAC,gBAAgB;UAAAC,QAAA,EAC5BtM,SAAS,CAAC6C,GAAG,CAAC,CAAC6C,CAAC,EAAEmH,KAAK,KAAK;YAC3B;YACA,IAAIW,QAAQ,GAAG,KAAK;YACpB,IAAI9H,CAAC,CAAChG,QAAQ,IAAIgG,CAAC,CAAChG,QAAQ,CAAC8D,MAAM,GAAG,CAAC,EAAE;cACvC;cACA,MAAMiK,SAAS,GAAG/H,CAAC,CAAChG,QAAQ,CAAC,CAAC,CAAC;cAC/B8N,QAAQ,GAAG,GAAGC,SAAS,CAACzH,UAAU,IAAIyH,SAAS,CAACxH,QAAQ,EAAE;YAC5D,CAAC,MAAM,IAAInG,eAAe,IAAIA,eAAe,CAACmC,KAAK,EAAE;cACnD;cACAuL,QAAQ,GAAGzD,0BAA0B,CAACrE,CAAC,CAACmD,aAAa,EAAE/I,eAAe,CAAC;YACzE;YAEA,oBACAjB,OAAA;cAAgBwN,SAAS,EAAC,eAAe;cAAAC,QAAA,gBACvCzN,OAAA;gBAAKwN,SAAS,EAAC,iBAAiB;gBAAAC,QAAA,gBAC9BzN,OAAA;kBAAMwN,SAAS,EAAC,iBAAiB;kBAAAC,QAAA,GAAC,GAAC,EAAC5G,CAAC,CAACuD,eAAe;gBAAA;kBAAAsD,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAO,CAAC,eAC7D7N,OAAA;kBACEwN,SAAS,EAAC,8BAA8B;kBACxCS,OAAO,EAAEA,CAAA,KAAMzB,eAAe,CAACmC,QAAQ,CAAE;kBACzCtK,KAAK,EAAC,8BAA8B;kBAAAoJ,QAAA,GACrC,sBACW,EAACkB,QAAQ;gBAAA;kBAAAjB,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACf,CAAC,EACNhH,CAAC,CAACoD,aAAa,iBACdjK,OAAA;kBAAMwN,SAAS,EAAE,iBAAiB3G,CAAC,CAACoD,aAAa,EAAG;kBAAAwD,QAAA,EACjD5G,CAAC,CAACoD,aAAa,CAAC4E,WAAW,CAAC;gBAAC;kBAAAnB,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAC1B,CACP,EACAhH,CAAC,CAACiI,KAAK,iBACN9O,OAAA;kBAAMwN,SAAS,EAAC,gBAAgB;kBAAAC,QAAA,GAAE5G,CAAC,CAACiI,KAAK,EAAC,QAAM;gBAAA;kBAAApB,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CACvD,EACAhH,CAAC,CAACkI,QAAQ,iBACT/O,OAAA;kBAAMwN,SAAS,EAAC,YAAY;kBAAAC,QAAA,EAAC;gBAAO;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAC3C,EACA,CAAC,MAAM;kBACN;kBACA,IAAIhH,CAAC,CAACmI,WAAW,EAAE;oBACjBpL,OAAO,CAACoB,GAAG,CAAC,uBAAuB,EAAE;sBACnCmF,cAAc,EAAEtD,CAAC,CAACuD,eAAe;sBACjC4E,WAAW,EAAEnI,CAAC,CAACmI,WAAW;sBAC1BC,aAAa,EAAEpI,CAAC,CAACoI,aAAa;sBAC9BC,kBAAkB,EAAE,OAAOrI,CAAC,CAACoI;oBAC/B,CAAC,CAAC;kBACJ;kBAEA,IAAI,CAACpI,CAAC,CAACmI,WAAW,EAAE,OAAO,IAAI;;kBAE/B;kBACA,IAAIG,YAAY,GAAGtI,CAAC,CAACoI,aAAa;kBAClC,IAAI,OAAOE,YAAY,KAAK,QAAQ,EAAE;oBACpC,IAAI;sBACFA,YAAY,GAAGC,IAAI,CAACC,KAAK,CAACF,YAAY,CAAC;oBACzC,CAAC,CAAC,OAAOd,CAAC,EAAE;sBACVzK,OAAO,CAACC,KAAK,CAAC,gCAAgC,EAAEwK,CAAC,CAAC;sBAClDc,YAAY,GAAG,EAAE;oBACnB;kBACF;;kBAEA;kBACA,IAAI,CAACG,KAAK,CAACC,OAAO,CAACJ,YAAY,CAAC,EAAE;oBAChCA,YAAY,GAAGA,YAAY,GAAG,CAACA,YAAY,CAAC,GAAG,EAAE;kBACnD;kBAEAvL,OAAO,CAACoB,GAAG,CAAC,0BAA0B,EAAEmK,YAAY,CAAC;kBAErD,IAAIA,YAAY,IAAIA,YAAY,CAACxK,MAAM,GAAG,CAAC,EAAE;oBAC3Cf,OAAO,CAACoB,GAAG,CAAC,mCAAmC,CAAC;oBAChD,oBACEhF,OAAA;sBACEyB,IAAI,EAAC,QAAQ;sBACb+L,SAAS,EAAC,yBAAyB;sBACnCS,OAAO,EAAGI,CAAC,IAAK;wBACdA,CAAC,CAACmB,cAAc,CAAC,CAAC;wBAClBnB,CAAC,CAACC,eAAe,CAAC,CAAC;wBACnB1K,OAAO,CAACoB,GAAG,CAAC,4BAA4B,EAAEmK,YAAY,CAAC;wBACvDrM,kBAAkB,CAAC;0BACjBqH,cAAc,EAAEtD,CAAC,CAACuD,eAAe;0BACjCqF,QAAQ,EAAEN;wBACZ,CAAC,CAAC;sBACJ,CAAE;sBACF9K,KAAK,EAAC,uBAAuB;sBAC7ByJ,KAAK,EAAE;wBACL4B,MAAM,EAAE,SAAS;wBACjBC,aAAa,EAAE;sBACjB,CAAE;sBAAAlC,QAAA,EACH;oBAED;sBAAAC,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAQ,CAAC;kBAEb,CAAC,MAAM;oBACLjK,OAAO,CAACoB,GAAG,CAAC,2CAA2C,CAAC;oBACxD,oBAAOhF,OAAA;sBAAMwN,SAAS,EAAC,eAAe;sBAAAC,QAAA,EAAC;oBAAU;sBAAAC,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAM,CAAC;kBAC1D;gBACF,CAAC,EAAE,CAAC,EACH,CAAC,MAAM;kBACN;kBACA,MAAM+B,mBAAmB,GAAG/I,CAAC,CAAChG,QAAQ,IAAIgG,CAAC,CAAChG,QAAQ,CAAC8D,MAAM,GAAG,CAAC,IAAIkC,CAAC,CAAChG,QAAQ,CAAC,CAAC,CAAC,CAACgP,aAAa;kBAE9F,IAAID,mBAAmB,EAAE;oBACvB,oBACE5P,OAAA;sBACEwN,SAAS,EAAC,eAAe;sBACzBS,OAAO,EAAEA,CAAA,KAAMzL,oBAAoB,CAAC;wBAClC2H,cAAc,EAAEtD,CAAC,CAACuD,eAAe;wBACjC0F,SAAS,EAAEjJ,CAAC,CAAChG,QAAQ,CAAC,CAAC,CAAC,CAACgP,aAAa;wBACtCE,YAAY,EAAElJ,CAAC,CAAChG,QAAQ,CAAC,CAAC,CAAC,CAACmG,aAAa;wBACzCgJ,UAAU,EAAEnJ,CAAC,CAAChG,QAAQ,CAAC,CAAC,CAAC,CAACwG,gBAAgB;wBAC1CoF,SAAS,EAAE,GAAG5F,CAAC,CAAChG,QAAQ,CAAC,CAAC,CAAC,CAACsG,UAAU,IAAIN,CAAC,CAAChG,QAAQ,CAAC,CAAC,CAAC,CAACuG,QAAQ;sBAClE,CAAC,CAAE;sBACH/C,KAAK,EAAC,oCAAoC;sBAAAoJ,QAAA,EAC3C;oBAED;sBAAAC,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAQ,CAAC;kBAEb;;kBAEA;kBACA,IAAIoC,UAAU,GAAGpJ,CAAC,CAACqJ,WAAW;kBAC9B,IAAI,OAAOD,UAAU,KAAK,QAAQ,EAAE;oBAClC,IAAI;sBACFA,UAAU,GAAGb,IAAI,CAACC,KAAK,CAACY,UAAU,CAAC;oBACrC,CAAC,CAAC,OAAO5B,CAAC,EAAE;sBACV4B,UAAU,GAAG,CAAC,CAAC;oBACjB;kBACF;kBACA,OAAOA,UAAU,IAAI1I,MAAM,CAACI,IAAI,CAACsI,UAAU,CAAC,CAACtL,MAAM,GAAG,CAAC,iBACrD3E,OAAA;oBACEwN,SAAS,EAAC,eAAe;oBACzBS,OAAO,EAAEA,CAAA,KAAMzL,oBAAoB,CAAC;sBAClC2H,cAAc,EAAEtD,CAAC,CAACuD,eAAe;sBACjC0F,SAAS,EAAE,yCAAyC;sBACpDK,WAAW,EAAEf,IAAI,CAACgB,SAAS,CAACH,UAAU,EAAE,IAAI,EAAE,CAAC;oBACjD,CAAC,CAAE;oBACH5L,KAAK,EAAC,qBAAqB;oBAAAoJ,QAAA,EAC5B;kBAED;oBAAAC,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAQ,CACT;gBACH,CAAC,EAAE,CAAC,eACJ7N,OAAA;kBACEwN,SAAS,EAAC,WAAW;kBACrBS,OAAO,EAAEA,CAAA,KAAMpE,mBAAmB,CAAChD,CAAC,CAAE;kBACtCuH,QAAQ,EAAEzL,eAAgB;kBAC1B0B,KAAK,EAAC,oCAAoC;kBAAAoJ,QAAA,EAEzC9K,eAAe,GAAG,cAAc,GAAG;gBAAkB;kBAAA+K,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAChD,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACN,CAAC,eACN7N,OAAA;gBAAKwN,SAAS,EAAC,eAAe;gBAAAC,QAAA,EAC3B5G,CAAC,CAACmD;cAAa;gBAAA0D,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACb,CAAC,EACL,CAAC,MAAM;gBACN;gBACA,IAAIwC,QAAQ,GAAGxJ,CAAC,CAACyJ,SAAS;gBAC1B,IAAI,OAAOD,QAAQ,KAAK,QAAQ,EAAE;kBAChC,IAAI;oBACFA,QAAQ,GAAGjB,IAAI,CAACC,KAAK,CAACgB,QAAQ,CAAC;kBACjC,CAAC,CAAC,OAAOhC,CAAC,EAAE;oBACVgC,QAAQ,GAAG,EAAE;kBACf;gBACF;gBACA,OAAOA,QAAQ,IAAIf,KAAK,CAACC,OAAO,CAACc,QAAQ,CAAC,IAAIA,QAAQ,CAAC1L,MAAM,GAAG,CAAC,iBAC/D3E,OAAA;kBAAKwN,SAAS,EAAC,WAAW;kBAAAC,QAAA,gBACxBzN,OAAA;oBAAAyN,QAAA,EAAQ;kBAAU;oBAAAC,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAQ,CAAC,KAAC,EAACwC,QAAQ,CAACE,IAAI,CAAC,IAAI,CAAC;gBAAA;kBAAA7C,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAC7C,CACN;cACH,CAAC,EAAE,CAAC;YAAA,GAzJIhH,CAAC,CAACpC,EAAE;cAAAiJ,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OA0JT,CAAC;UAER,CAAC;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACC,CACN;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACE,CACN;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACE,CAAC,EAGLlM,iBAAiB,IAAIE,kBAAkB,iBACtC7B,OAAA;MAAKwN,SAAS,EAAC,wBAAwB;MAACS,OAAO,EAAElB,gBAAiB;MAAAU,QAAA,eAChEzN,OAAA;QAAKwN,SAAS,EAAC,wBAAwB;QAACS,OAAO,EAAGI,CAAC,IAAKA,CAAC,CAACC,eAAe,CAAC,CAAE;QAAAb,QAAA,gBAC1EzN,OAAA;UAAKwN,SAAS,EAAC,uBAAuB;UAAAC,QAAA,gBACpCzN,OAAA;YAAKwN,SAAS,EAAC,qBAAqB;YAAAC,QAAA,gBAClCzN,OAAA;cAAAyN,QAAA,GAAI,eAAG,EAAC5L,kBAAkB,CAACkD,QAAQ,CAAC/B,IAAI;YAAA;cAAA0K,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAK,CAAC,eAC9C7N,OAAA;cAAGwN,SAAS,EAAC,gBAAgB;cAAAC,QAAA,GAAC,WACnB,EAAC5L,kBAAkB,CAACsD,OAAO,EAAC,YAAU,EAACtD,kBAAkB,CAAC4K,SAAS;YAAA;cAAAiB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAC3E,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACD,CAAC,eACN7N,OAAA;YACEwN,SAAS,EAAC,iBAAiB;YAC3BS,OAAO,EAAElB,gBAAiB;YAAAU,QAAA,EAC3B;UAED;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACN,CAAC,eAEN7N,OAAA;UAAKwN,SAAS,EAAC,qBAAqB;UAAAC,QAAA,eAClCzN,OAAA;YAAKwN,SAAS,EAAC,iBAAiB;YAAAC,QAAA,gBAC9BzN,OAAA;cAAKwN,SAAS,EAAC,WAAW;cAAAC,QAAA,eACxBzN,OAAA;gBAAMwN,SAAS,EAAC,wBAAwB;gBAAAC,QAAA,GAAC,oBAC/B,EAAC1L,WAAW,EAAC,MAAI,EAACF,kBAAkB,CAAC4K,SAAS;cAAA;gBAAAiB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAClD;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACJ,CAAC,EAGLhM,kBAAkB,CAACkD,QAAQ,CAACT,YAAY,gBACvCtE,OAAA;cAAKwN,SAAS,EAAC,qBAAqB;cAAAC,QAAA,GACjCxL,UAAU,iBACTjC,OAAA;gBAAKwN,SAAS,EAAC,qBAAqB;gBAAAC,QAAA,gBAClCzN,OAAA;kBAAKwN,SAAS,EAAC;gBAAS;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC,eAC/B7N,OAAA;kBAAAyN,QAAA,GAAG,eAAa,EAAC1L,WAAW,EAAC,KAAG;gBAAA;kBAAA2L,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAG,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACjC,CACN,eACD7N,OAAA;gBAEEwQ,GAAG,EAAE,0CAA0C3O,kBAAkB,CAACkD,QAAQ,CAACP,UAAU,SAASzC,WAAW,gBAAiB;gBAC1HsC,KAAK,EAAE,iBAAiBtC,WAAW,EAAG;gBACtCyL,SAAS,EAAC,qBAAqB;gBAC/BiD,WAAW,EAAC,GAAG;gBACfC,KAAK,EAAC,YAAY;gBAClBC,MAAM,EAAEA,CAAA,KAAMzO,aAAa,CAAC,KAAK;cAAE,GAN9B,OAAOH,WAAW,EAAE;gBAAA2L,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAO1B,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACC,CAAC,gBAEN7N,OAAA;cAAKwN,SAAS,EAAC,qBAAqB;cAAAC,QAAA,gBAClCzN,OAAA;gBAAKwN,SAAS,EAAC,eAAe;gBAAAC,QAAA,EAAC;cAAE;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAK,CAAC,eACvC7N,OAAA;gBAAAyN,QAAA,EAAI;cAAoB;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI,CAAC,eAC7B7N,OAAA;gBAAGwN,SAAS,EAAC,oBAAoB;gBAAAC,QAAA,GAAC,oCACE,EAAC5L,kBAAkB,CAACkD,QAAQ,CAAC/B,IAAI,EAAC,iBACtE;cAAA;gBAAA0K,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAG,CAAC,eACJ7N,OAAA;gBAAKwN,SAAS,EAAC,WAAW;gBAAAC,QAAA,gBACxBzN,OAAA;kBAAAyN,QAAA,gBAAGzN,OAAA;oBAAAyN,QAAA,EAAQ;kBAAS;oBAAAC,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAQ,CAAC,KAAC,EAAChM,kBAAkB,CAACkD,QAAQ,CAAC/B,IAAI;gBAAA;kBAAA0K,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,eACpE7N,OAAA;kBAAAyN,QAAA,gBAAGzN,OAAA;oBAAAyN,QAAA,EAAQ;kBAAQ;oBAAAC,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAQ,CAAC,KAAC,EAAChM,kBAAkB,CAACsD,OAAO;gBAAA;kBAAAuI,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,eAC7D7N,OAAA;kBAAAyN,QAAA,gBAAGzN,OAAA;oBAAAyN,QAAA,EAAQ;kBAAM;oBAAAC,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAQ,CAAC,KAAC,EAAChM,kBAAkB,CAAC4K,SAAS;gBAAA;kBAAAiB,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,eAC7D7N,OAAA;kBAAGwN,SAAS,EAAC,aAAa;kBAAAC,QAAA,EAAC;gBAAkD;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAG,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC9E,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH,CACN,eAGD7N,OAAA;cAAKwN,SAAS,EAAC,iBAAiB;cAAAC,QAAA,gBAC9BzN,OAAA;gBACEwN,SAAS,EAAC,SAAS;gBACnBS,OAAO,EAAEpB,cAAe;gBACxBuB,QAAQ,EAAErM,WAAW,IAAIF,kBAAkB,CAACsJ,SAAU;gBAAAsC,QAAA,EACvD;cAED;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,eACT7N,OAAA;gBAAMwN,SAAS,EAAC,cAAc;gBAAAC,QAAA,GAAC,OACxB,EAAC1L,WAAW;cAAA;gBAAA2L,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACb,CAAC,eACP7N,OAAA;gBACEwN,SAAS,EAAC,SAAS;gBACnBS,OAAO,EAAEvB,cAAe;gBACxB0B,QAAQ,EAAErM,WAAW,IAAIF,kBAAkB,CAACuJ,OAAQ;gBAAAqC,QAAA,EACrD;cAED;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACN,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC,eAEN7N,OAAA;UAAKwN,SAAS,EAAC,uBAAuB;UAAAC,QAAA,gBACpCzN,OAAA;YAAKwN,SAAS,EAAC,aAAa;YAAAC,QAAA,eAC1BzN,OAAA;cAAMwN,SAAS,EAAC,YAAY;cAAAC,QAAA,GACzB5L,kBAAkB,CAACuJ,OAAO,GAAGvJ,kBAAkB,CAACsJ,SAAS,GAAG,CAAC,EAAC,iBACjE;YAAA;cAAAuC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACJ,CAAC,eACN7N,OAAA;YACEwN,SAAS,EAAC,iBAAiB;YAC3BS,OAAO,EAAElB,gBAAiB;YAAAU,QAAA,EAC3B;UAED;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACN,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CACN,EAGAtL,iBAAiB,iBAChBvC,OAAA;MAAKwN,SAAS,EAAC,iBAAiB;MAACS,OAAO,EAAEA,CAAA,KAAMzL,oBAAoB,CAAC,IAAI,CAAE;MAAAiL,QAAA,eACzEzN,OAAA;QAAKwN,SAAS,EAAC,yBAAyB;QAACS,OAAO,EAAGI,CAAC,IAAKA,CAAC,CAACC,eAAe,CAAC,CAAE;QAAAb,QAAA,gBAC3EzN,OAAA;UAAKwN,SAAS,EAAC,wBAAwB;UAAAC,QAAA,gBACrCzN,OAAA;YAAAyN,QAAA,GAAI,4CAAgC,EAAClL,iBAAiB,CAAC4H,cAAc;UAAA;YAAAuD,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAK,CAAC,eAC3E7N,OAAA;YAAQwN,SAAS,EAAC,qBAAqB;YAACS,OAAO,EAAEA,CAAA,KAAMzL,oBAAoB,CAAC,IAAI,CAAE;YAAAiL,QAAA,EAAC;UAAC;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC1F,CAAC,eAEN7N,OAAA;UAAKwN,SAAS,EAAC,sBAAsB;UAAAC,QAAA,GAClClL,iBAAiB,CAACwN,YAAY,iBAC7B/P,OAAA;YAAKwN,SAAS,EAAC,oBAAoB;YAAAC,QAAA,gBACjCzN,OAAA;cAAKwN,SAAS,EAAC,cAAc;cAAAC,QAAA,gBAC3BzN,OAAA;gBAAMwN,SAAS,EAAC,aAAa;gBAAAC,QAAA,EAAC;cAAmB;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC,eACxD7N,OAAA;gBAAMwN,SAAS,EAAC,aAAa;gBAAAC,QAAA,EAAElL,iBAAiB,CAACwN;cAAY;gBAAArC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAO,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAClE,CAAC,eACN7N,OAAA;cAAKwN,SAAS,EAAC,cAAc;cAAAC,QAAA,gBAC3BzN,OAAA;gBAAMwN,SAAS,EAAC,aAAa;gBAAAC,QAAA,EAAC;cAAS;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC,eAC9C7N,OAAA;gBAAMwN,SAAS,EAAC,aAAa;gBAAAC,QAAA,EAAElL,iBAAiB,CAACkK;cAAS;gBAAAiB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAO,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAC/D,CAAC,EACLtL,iBAAiB,CAACyN,UAAU,iBAC3BhQ,OAAA;cAAKwN,SAAS,EAAC,cAAc;cAAAC,QAAA,gBAC3BzN,OAAA;gBAAMwN,SAAS,EAAC,aAAa;gBAAAC,QAAA,EAAC;cAAc;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC,eACnD7N,OAAA;gBAAMwN,SAAS,EAAC,aAAa;gBAAAC,QAAA,GAAElL,iBAAiB,CAACyN,UAAU,EAAC,GAAC;cAAA;gBAAAtC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACjE,CACN;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACE,CACN,eAED7N,OAAA;YAAKwN,SAAS,EAAC,mBAAmB;YAAAC,QAAA,gBAChCzN,OAAA;cAAAyN,QAAA,EAAI;YAAgB;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eACzB7N,OAAA;cAAKwN,SAAS,EAAC,mBAAmB;cAAAC,QAAA,EAC/BlL,iBAAiB,CAACuN;YAAS;cAAApC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACzB,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC,EAELtL,iBAAiB,CAAC4N,WAAW,iBAC5BnQ,OAAA;YAAKwN,SAAS,EAAC,sBAAsB;YAAAC,QAAA,gBACnCzN,OAAA;cAAAyN,QAAA,EAAI;YAA4B;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eACrC7N,OAAA;cAAKwN,SAAS,EAAC,sBAAsB;cAAAC,QAAA,eACnCzN,OAAA;gBAAAyN,QAAA,EAAMlL,iBAAiB,CAAC4N;cAAW;gBAAAzC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACvC,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CACN;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACE,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CACN,EAGApL,gBAAgB,iBACfzC,OAAA;MAAKwN,SAAS,EAAC,gBAAgB;MAACS,OAAO,EAAEA,CAAA,KAAMvL,mBAAmB,CAAC,IAAI,CAAE;MAAA+K,QAAA,eACvEzN,OAAA;QAAKwN,SAAS,EAAC,wBAAwB;QAACS,OAAO,EAAGI,CAAC,IAAKA,CAAC,CAACC,eAAe,CAAC,CAAE;QAAAb,QAAA,gBAC1EzN,OAAA;UAAKwN,SAAS,EAAC,uBAAuB;UAAAC,QAAA,gBACpCzN,OAAA;YAAAyN,QAAA,gBACEzN,OAAA;cAAAyN,QAAA,GAAI,kCAA2B,EAAChL,gBAAgB,CAAC0H,cAAc;YAAA;cAAAuD,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAK,CAAC,eACrE7N,OAAA;cAAMwN,SAAS,EAAC,qBAAqB;cAAAC,QAAA,EAAEhL,gBAAgB,CAAC6H;YAAY;cAAAoD,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACzE,CAAC,eACN7N,OAAA;YAAQwN,SAAS,EAAC,oBAAoB;YAACS,OAAO,EAAEA,CAAA,KAAMvL,mBAAmB,CAAC,IAAI,CAAE;YAAA+K,QAAA,EAAC;UAAC;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACxF,CAAC,eAEN7N,OAAA;UAAKwN,SAAS,EAAC,qBAAqB;UAAAC,QAAA,gBAElCzN,OAAA;YAAKwN,SAAS,EAAC,uBAAuB;YAAAC,QAAA,gBACpCzN,OAAA;cAAAyN,QAAA,EAAI;YAAY;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eACrB7N,OAAA;cAAAyN,QAAA,EAAIhL,gBAAgB,CAAC4H;YAAY;cAAAqD,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACnC,CAAC,eAGN7N,OAAA;YAAKwN,SAAS,EAAC,kBAAkB;YAAAC,QAAA,EAC9B,CAAC,MAAM;cACN,MAAMmD,KAAK,GAAGnO,gBAAgB,CAAC8H,QAAQ,CAACc,KAAK,CAAC,IAAI,CAAC;cACnD,IAAIwF,SAAS,GAAG,KAAK;cACrB,IAAIC,YAAY,GAAG,EAAE;cACrB,IAAIC,YAAY,GAAG,KAAK;cACxB,IAAIC,cAAc,GAAG,KAAK;cAC1B,IAAIC,cAAc,GAAG,IAAI;cACzB,MAAMC,QAAQ,GAAG,EAAE;cAEnBN,KAAK,CAAChK,OAAO,CAAC,CAACuK,IAAI,EAAEC,GAAG,KAAK;gBAC3B;gBACA,MAAMC,UAAU,GAAGF,IAAI,CAACG,KAAK,CAAC,yCAAyC,CAAC,IACtDH,IAAI,CAACG,KAAK,CAAC,oBAAoB,CAAC,IAChCH,IAAI,CAACG,KAAK,CAAC,YAAY,CAAC,IACvBH,IAAI,CAACpL,QAAQ,CAAC,GAAG,CAAC,IAAIoL,IAAI,CAACpL,QAAQ,CAAC,GAAG,CAAE;;gBAE5D;gBACA,IAAIoL,IAAI,CAACG,KAAK,CAAC,eAAe,CAAC,IAAIH,IAAI,CAACpL,QAAQ,CAAC,KAAK,CAAC,IAAK,CAAC8K,SAAS,IAAIQ,UAAW,EAAE;kBACrF,IAAI,CAACR,SAAS,EAAE;oBACd;oBACAA,SAAS,GAAG,IAAI;oBAChB,IAAIQ,UAAU,EAAE;sBACdP,YAAY,CAAC7J,IAAI,CAACkK,IAAI,CAAC;oBACzB;kBACF,CAAC,MAAM;oBACL;oBACA,IAAIA,IAAI,CAACpL,QAAQ,CAAC,KAAK,CAAC,IAAIoL,IAAI,CAACG,KAAK,CAAC,eAAe,CAAC,EAAE;sBACvDT,SAAS,GAAG,KAAK;oBACnB,CAAC,MAAM,IAAIQ,UAAU,EAAE;sBACrBP,YAAY,CAAC7J,IAAI,CAACkK,IAAI,CAAC;oBACzB,CAAC,MAAM;sBACL;sBACAN,SAAS,GAAG,KAAK;oBACnB;oBAEA,IAAI,CAACA,SAAS,IAAIC,YAAY,CAACnM,MAAM,GAAG,CAAC,EAAE;sBACzC,MAAM4M,OAAO,GAAGT,YAAY,CAACP,IAAI,CAAC,IAAI,CAAC;sBACvCO,YAAY,GAAG,EAAE;sBACjBI,QAAQ,CAACjK,IAAI,cAACjH,OAAA;wBAAewN,SAAS,EAAC,kBAAkB;wBAAAC,QAAA,EAAE8D;sBAAO,GAA1CH,GAAG;wBAAA1D,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OAA6C,CAAC,CAAC;sBAC1EkD,YAAY,GAAG,KAAK;sBACpBC,cAAc,GAAG,IAAI;oBACvB;kBACF;kBACA;gBACF;;gBAEA;gBACA,IAAIH,SAAS,EAAE;kBACbC,YAAY,CAAC7J,IAAI,CAACkK,IAAI,CAAC;kBACvB;gBACF;;gBAEA;gBACA,IAAIA,IAAI,CAACG,KAAK,CAAC,gBAAgB,CAAC,EAAE;kBAChC,MAAME,WAAW,GAAGL,IAAI,CAACM,OAAO,CAAC,OAAO,EAAE,EAAE,CAAC,CAACA,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC,CAACjG,IAAI,CAAC,CAAC,CAACI,WAAW,CAAC,CAAC;kBACpFqF,cAAc,GAAGO,WAAW;kBAC5BN,QAAQ,CAACjK,IAAI,cAACjH,OAAA;oBAAcwN,SAAS,EAAC,yBAAyB;oBAAAC,QAAA,EAAE0D,IAAI,CAACM,OAAO,CAAC,OAAO,EAAE,EAAE,CAAC,CAACA,OAAO,CAAC,IAAI,EAAE,EAAE;kBAAC,GAArFL,GAAG;oBAAA1D,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAuF,CAAC,CAAC;kBACnHkD,YAAY,GAAG,KAAK;kBACpBC,cAAc,GAAG,IAAI;kBACrB;gBACF;;gBAEA;gBACA,IAAIG,IAAI,CAACG,KAAK,CAAC,gBAAgB,CAAC,EAAE;kBAChCJ,QAAQ,CAACjK,IAAI,cACXjH,OAAA;oBAAewN,SAAS,EAAC,kBAAkB;oBAAAC,QAAA,gBACzCzN,OAAA;sBAAKwN,SAAS,EAAC,mBAAmB;sBAAAC,QAAA,EAAC;oBAAE;sBAAAC,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAK,CAAC,eAC3C7N,OAAA;sBAAKwN,SAAS,EAAC,mBAAmB;sBAACkE,uBAAuB,EAAE;wBAC1DC,MAAM,EAAER,IAAI,CAACM,OAAO,CAAC,gBAAgB,EAAE,EAAE,CAAC,CAACjG,IAAI,CAAC;sBAClD;oBAAE;sBAAAkC,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAM,CAAC;kBAAA,GAJDuD,GAAG;oBAAA1D,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAKR,CACP,CAAC;kBACDkD,YAAY,GAAG,KAAK;kBACpBC,cAAc,GAAG,IAAI;kBACrB;gBACF;;gBAEA;gBACA,IAAIG,IAAI,CAACG,KAAK,CAAC,qBAAqB,CAAC,EAAE;kBACrCJ,QAAQ,CAACjK,IAAI,cACXjH,OAAA;oBAAewN,SAAS,EAAC,eAAe;oBAACkE,uBAAuB,EAAE;sBAChEC,MAAM,EAAER;oBACV;kBAAE,GAFQC,GAAG;oBAAA1D,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAEL,CACV,CAAC;kBACDkD,YAAY,GAAG,KAAK;kBACpBC,cAAc,GAAG,KAAK;kBACtB;gBACF;;gBAEA;gBACA,IAAI,CAACG,IAAI,CAAC3F,IAAI,CAAC,CAAC,EAAE;kBAChB;kBACA,MAAMoG,eAAe,GAAG,CAAC,OAAO,EAAE,MAAM,EAAE,SAAS,EAAE,SAAS,EAAE,iBAAiB,CAAC;kBAClF,MAAMC,gBAAgB,GAAGD,eAAe,CAACvE,IAAI,CAACyE,CAAC,IAAIb,cAAc,IAAIA,cAAc,CAAClL,QAAQ,CAAC+L,CAAC,CAAC,CAAC;kBAEhG,IAAI,CAACf,YAAY,IAAIC,cAAc,IAAI,CAACa,gBAAgB,EAAE;oBACxDX,QAAQ,CAACjK,IAAI,cAACjH,OAAA;sBAAewN,SAAS,EAAC;oBAAgB,GAA/B4D,GAAG;sBAAA1D,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAkC,CAAC,CAAC;oBAC/DkD,YAAY,GAAG,IAAI;kBACrB;kBACA;gBACF;;gBAEA;gBACA,MAAMgB,gBAAgB,GAAIrQ,IAAI,IAAK;kBACjC,OAAOA;kBACL;kBAAA,CACC+P,OAAO,CAAC,IAAI,EAAE,OAAO,CAAC,CACtBA,OAAO,CAAC,IAAI,EAAE,MAAM,CAAC,CACrBA,OAAO,CAAC,IAAI,EAAE,MAAM;kBACrB;kBAAA,CACCA,OAAO,CAAC,gBAAgB,EAAE,qBAAqB,CAAC,CAAC;kBAAA,CACjDA,OAAO,CAAC,YAAY,EAAE,aAAa,CAAC,CAAC,CAAC;gBAC3C,CAAC;;gBAED;gBACA,MAAMG,eAAe,GAAG,CAAC,OAAO,EAAE,MAAM,EAAE,SAAS,EAAE,SAAS,EAAE,iBAAiB,CAAC;gBAClF,MAAMC,gBAAgB,GAAGD,eAAe,CAACvE,IAAI,CAACyE,CAAC,IAAIb,cAAc,IAAIA,cAAc,CAAClL,QAAQ,CAAC+L,CAAC,CAAC,CAAC;gBAChG,MAAME,SAAS,GAAGH,gBAAgB,GAAG,uBAAuB,GAAG,eAAe;gBAE9EX,QAAQ,CAACjK,IAAI,cACXjH,OAAA;kBAAawN,SAAS,EAAEwE,SAAU;kBAACN,uBAAuB,EAAE;oBAC1DC,MAAM,EAAEI,gBAAgB,CAACZ,IAAI;kBAC/B;gBAAE,GAFMC,GAAG;kBAAA1D,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAEL,CACR,CAAC;gBACDkD,YAAY,GAAG,KAAK;gBACpBC,cAAc,GAAG,KAAK;cACxB,CAAC,CAAC;cAEF,OAAOE,QAAQ;YACjB,CAAC,EAAE;UAAC;YAAAxD,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACD,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CACN,EAGAhL,eAAe,iBACd7C,OAAA;MAAKwN,SAAS,EAAC,uBAAuB;MAACS,OAAO,EAAEA,CAAA,KAAMnL,kBAAkB,CAAC,IAAI,CAAE;MAAA2K,QAAA,eAC7EzN,OAAA;QAAKwN,SAAS,EAAC,uBAAuB;QAACS,OAAO,EAAGI,CAAC,IAAKA,CAAC,CAACC,eAAe,CAAC,CAAE;QAAAb,QAAA,gBACzEzN,OAAA;UAAKwN,SAAS,EAAC,sBAAsB;UAAAC,QAAA,gBACnCzN,OAAA;YAAAyN,QAAA,GAAI,0BAAc,EAAC5K,eAAe,CAACsH,cAAc;UAAA;YAAAuD,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAK,CAAC,eACvD7N,OAAA;YAAQwN,SAAS,EAAC,mBAAmB;YAACS,OAAO,EAAEA,CAAA,KAAMnL,kBAAkB,CAAC,IAAI,CAAE;YAAA2K,QAAA,EAAC;UAAC;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACtF,CAAC,eACN7N,OAAA;UAAKwN,SAAS,EAAC,oBAAoB;UAAAC,QAAA,EAChC5K,eAAe,CAAC4M,QAAQ,CAACzL,GAAG,CAAC,CAACuN,OAAO,EAAEH,GAAG,kBACzCpR,OAAA;YAAewN,SAAS,EAAC,mBAAmB;YAAAC,QAAA,gBAC1CzN,OAAA;cACEwQ,GAAG,EAAE,wBAAwBe,OAAO,EAAG;cACvCU,GAAG,EAAE,WAAWb,GAAG,GAAG,CAAC,EAAG;cAC1B5D,SAAS,EAAC,eAAe;cACzB0E,OAAO,EAAG7D,CAAC,IAAK;gBACdA,CAAC,CAAC8D,MAAM,CAACrE,KAAK,CAACsE,OAAO,GAAG,MAAM;gBAC/B/D,CAAC,CAAC8D,MAAM,CAACE,WAAW,CAACvE,KAAK,CAACsE,OAAO,GAAG,OAAO;cAC9C;YAAE;cAAA1E,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH,CAAC,eACF7N,OAAA;cAAKwN,SAAS,EAAC,eAAe;cAACM,KAAK,EAAE;gBAACsE,OAAO,EAAE;cAAM,CAAE;cAAA3E,QAAA,EAAC;YAEzD;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAK,CAAC;UAAA,GAZEuD,GAAG;YAAA1D,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAaR,CACN;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACC,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CACN;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACE,CAAC;AAEV,CAAC;AAACzN,EAAA,CA9uDID,gBAAgB;AAAAmS,EAAA,GAAhBnS,gBAAgB;AAgvDtB,eAAeA,gBAAgB;AAAC,IAAAmS,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}